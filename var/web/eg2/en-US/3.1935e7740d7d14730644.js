(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+hKF":function(e,c,t){"use strict";t.d(c,"a",(function(){return C}));var n=t("Osig"),i=t("EQDH"),s=t("YRS1"),a=t("8PDw"),o=t("rRT/"),r=t("tNQm"),b=t("fXoL"),l=t("1kSV"),d=t("ofXK"),u=function(e,c,t,n){return new(t||(t=Promise))((function(i,s){function a(e){try{r(n.next(e))}catch(c){s(c)}}function o(e){try{r(n.throw(e))}catch(c){s(c)}}function r(e){var c;e.done?i(e.value):(c=e.value,c instanceof t?c:new t((function(e){e(c)}))).then(a,o)}r((n=n.apply(e,c||[])).next())}))};const f=["successMsg"],h=["errorMsg"],g=["text",$localize`:␟0159062fd0f96063ba6469c838b6658dfe3db560␟8065679224749516361:Successfully Marked Item Missing`],p=["text",$localize`:␟6a47531cad781b684a884cf806ecfb3695c4f838␟4815295099803226267:Failed To Mark Item Missing`];var m;m=$localize`:␟6461cdc419feca98e82e8443773f921adf49e5f7␟5007030082081715697:Mark Item Missing`;const R=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var v,y,Q;function M(e,c){if(1&e&&(b.Rb(0,"div",13),b.Rb(1,"div",14),b.Vb(2,v),b.Qb(),b.Qb()),2&e){const e=b.hc(2);b.xb(2),b.Zb(e.numSucceeded),b.Wb(2)}}function I(e,c){if(1&e&&(b.Rb(0,"div",13),b.Rb(1,"div",14),b.Rb(2,"div",15),b.Mc(3),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc(2);b.xb(3),b.Oc(" ",e.numFailed," Items(s) Failed to be Marked Missing ")}}function k(e,c){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",16),b.fc("click",(function(){return b.Bc(e),b.hc(2).close()})),b.Vb(2,y),b.Qb(),b.Rb(3,"button",17),b.fc("click",(function(){return b.Bc(e),b.hc(2).markItemsMissing()})),b.Vb(4,Q),b.Qb(),b.Ob()}}function w(e,c){if(1&e){const e=b.Sb();b.Rb(0,"div",4),b.Rb(1,"h4",5),b.Rb(2,"span"),b.Vb(3,m),b.Qb(),b.Qb(),b.Rb(4,"button",6),b.Xb(5,R),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Rb(6,"span",7),b.Mc(7,"\xd7"),b.Qb(),b.Qb(),b.Qb(),b.Rb(8,"div",8),b.Rb(9,"div",9),b.Rb(10,"h5"),b.Mc(11),b.Qb(),b.Qb(),b.Kc(12,M,3,1,"div",10),b.Kc(13,I,4,1,"div",10),b.Qb(),b.Rb(14,"div",11),b.Kc(15,k,5,0,"ng-container",12),b.Qb()}if(2&e){const e=b.hc();b.xb(11),b.Oc("Mark ",e.copyIds.length," Item(s) Missing?"),b.xb(1),b.oc("ngIf",e.numSucceeded>0),b.xb(1),b.oc("ngIf",e.numFailed>0),b.xb(2),b.oc("ngIf",!e.chargeResponse)}}v=$localize`:␟5c34f99e359681e5ca2074715fffa3263eb7fce0␟6958126370763843442: ${"\ufffd0\ufffd"}:INTERPOLATION: Items(s) Successfully Marked Missing `,y=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,Q=$localize`:␟d6b324c8f3733a0824dd2455d3f41d5212ccfc0d␟1818613769646355578:Mark Missing`;let C=(()=>{class e extends o.a{constructor(e,c,t,n,i){super(e),this.modal=e,this.toast=c,this.net=t,this.evt=n,this.auth=i}ngOnInit(){}open(e){return this.numSucceeded=0,this.numFailed=0,super.open(e)}markOneItemMissing(e){return u(this,void 0,void 0,(function*(){if(0===e.length)return Promise.resolve();const c=e.pop();return this.net.request("open-ils.circ","open-ils.circ.mark_item_missing",this.auth.token(),c).toPromise().then(c=>u(this,void 0,void 0,(function*(){return 1===Number(c)?(this.numSucceeded++,this.toast.success(yield this.successMsg.current())):(this.numFailed++,console.error("Mark missing failed ",this.evt.parse(c)),this.toast.warning(yield this.errorMsg.current())),this.markOneItemMissing(e)})))}))}markItemsMissing(){return u(this,void 0,void 0,(function*(){this.numSucceeded=0,this.numFailed=0;const e=[].concat(this.copyIds);yield this.markOneItemMissing(e),this.close(this.numSucceeded>0)}))}}return e.\u0275fac=function(c){return new(c||e)(b.Lb(l.s),b.Lb(s.a),b.Lb(n.b),b.Lb(i.a),b.Lb(a.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-mark-missing-dialog"]],viewQuery:function(e,c){var t;1&e&&(b.Ic(f,!0),b.Ic(h,!0)),2&e&&(b.yc(t=b.gc())&&(c.successMsg=t.first),b.yc(t=b.gc())&&(c.errorMsg=t.first))},inputs:{copyIds:"copyIds"},features:[b.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row","d-flex","justify-content-center"],["class","row",4,"ngIf"],[1,"modal-footer"],[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[1,"alert","alert-warning"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(e,c){1&e&&(b.Rb(0,"eg-string",0,1),b.Xb(2,g),b.Qb(),b.Rb(3,"eg-string",0,2),b.Xb(5,p),b.Qb(),b.Kc(6,w,16,4,"ng-template",null,3,b.Lc))},directives:[r.a,d.v],encapsulation:2}),e})()},ItyU:function(e,c,t){"use strict";t.d(c,"a",(function(){return X}));var n=t("z6cu"),i=t("Cfvw"),s=t("eIep"),a=t("Osig"),o=t("EQDH"),r=t("YRS1"),b=t("8PDw"),l=t("iA0r"),d=t("cm5s"),u=t("tNQm"),f=t("rRT/"),h=t("XKii"),g=t("fXoL"),p=t("1kSV"),m=t("ofXK"),R=t("9rfo"),v=t("3Pt+"),y=t("ZvpF");const Q=["successMsg"],M=["errorMsg"],I=["text",$localize`:␟1076e34d95045985dc3b469c3a4b5c5546c5fbfc␟8090504835357979338:Successfully Marked Item Damaged`],k=["text",$localize`:␟a1ba62017a44fd2f5f0a9796ebd02b7b765e70b8␟92218301785983050:Failed To Mark Item Damaged`];var w;w=$localize`:␟f5f12a4e25ce9e9a43b92bd508b3c47abdecc1a1␟2673254818468878353:Mark Item Damaged`;const C=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var T,x,O,$;T=$localize`:␟8ccde81c491df8550f0893f4d59ae07ddcd6bbe1␟2980098087875154794: Item was previously checked out `,x=$localize`:␟03c5e20422046fe9e6f28318c07126a2d1981245␟6067256309136371647: Item was last checked out by patron ${"\ufffd#7\ufffd"}:START_LINK: ${"\ufffd0\ufffd"}:INTERPOLATION:, ${"\ufffd1\ufffd"}:INTERPOLATION_1: (${"\ufffd2\ufffd"}:INTERPOLATION_2:) ${"\ufffd/#7\ufffd"}:CLOSE_LINK:. `,O=$localize`:␟3955fd828fb1bfa103a03de89efb50e96799c759␟1360779131419187967: Item was due ${"\ufffd0\ufffd"}:INTERPOLATION: and returned ${"\ufffd1\ufffd"}:INTERPOLATION_1:. `,$=$localize`:␟e75472f7d356b9be46440ef5dea56ab5f843378b␟3623830635283351872: Calucated fine amount is ${"\ufffd#15\ufffd"}:START_TAG_SPAN: ${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#15\ufffd"}:CLOSE_TAG_SPAN:`;const _=["placeholder",$localize`:␟e3767d5972514732dee1c5301af509bc9585b590␟2558174311687621439:Billing Type...`];function N(e,c){if(1&e){const e=g.Sb();g.Pb(0),g.Rb(1,"li",20),g.Rb(2,"div",9),g.Rb(3,"div",23),g.Mc(4,"Billing Type"),g.Qb(),g.Rb(5,"div",24),g.Rb(6,"eg-combobox",25),g.Xb(7,_),g.fc("onChange",(function(c){return g.Bc(e),g.hc(3).newBtype=c.id})),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Rb(8,"li",20),g.Rb(9,"div",9),g.Rb(10,"div",23),g.Mc(11,"Charge Amount"),g.Qb(),g.Rb(12,"div",24),g.Rb(13,"input",26),g.fc("ngModelChange",(function(c){return g.Bc(e),g.hc(3).newCharge=c})),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Rb(14,"li",20),g.Rb(15,"div",9),g.Rb(16,"div",23),g.Mc(17,"Note"),g.Qb(),g.Rb(18,"div",24),g.Rb(19,"textarea",27),g.fc("ngModelChange",(function(c){return g.Bc(e),g.hc(3).newNote=c})),g.Qb(),g.Qb(),g.Qb(),g.Qb(),g.Ob()}if(2&e){const e=g.hc(3);g.xb(6),g.oc("entries",e.billingTypes),g.xb(7),g.oc("ngModel",e.newCharge),g.xb(6),g.oc("ngModel",e.newNote)}}function L(e,c){if(1&e&&(g.Rb(0,"div",16),g.Rb(1,"div",17),g.Vb(2,T),g.Qb(),g.Rb(3,"div",18),g.Rb(4,"ul",19),g.Rb(5,"li",20),g.bc(6,x),g.Mb(7,"a",21),g.Yb(),g.Qb(),g.Rb(8,"li",20),g.Vb(9,O),g.ic(10,"formatValue"),g.ic(11,"date"),g.Qb(),g.Rb(12,"li",20),g.Rb(13,"span"),g.bc(14,$),g.Mb(15,"span",22),g.ic(16,"currency"),g.Yb(),g.Qb(),g.Qb(),g.Kc(17,N,20,3,"ng-container",15),g.Qb(),g.Qb(),g.Qb()),2&e){const e=g.hc(2);g.xb(7),g.qc("href","/eg/staff/circ/patron/",e.chargeResponse.circ.usr().id(),"/checkout",g.Ec),g.Zb(e.chargeResponse.circ.usr().family_name())(e.chargeResponse.circ.usr().first_given_name())(e.chargeResponse.circ.usr().usrname()),g.Wb(6),g.xb(4),g.Zb(g.kc(10,8,e.chargeResponse.circ.due_date(),"timestamp"))(g.kc(11,11,e.chargeResponse.circ.checkin_time(),"MM/dd/yy H:mm a")),g.Wb(9),g.xb(5),g.Zb(g.jc(16,14,e.chargeResponse.charge)),g.Wb(14),g.xb(1),g.oc("ngIf",e.amountChangeRequested)}}var S,P,z,B,A,D;function E(e,c){if(1&e){const e=g.Sb();g.Pb(0),g.Rb(1,"button",28),g.fc("click",(function(){return g.Bc(e),g.hc(2).close(!1)})),g.Vb(2,S),g.Qb(),g.Rb(3,"button",29),g.fc("click",(function(){return g.Bc(e),g.hc(2).markDamaged()})),g.Vb(4,P),g.Qb(),g.Ob()}}function V(e,c){if(1&e){const e=g.Sb();g.Pb(0),g.Rb(1,"button",28),g.fc("click",(function(){return g.Bc(e),g.hc(2).close(!1)})),g.Vb(2,z),g.Qb(),g.Rb(3,"button",30),g.fc("click",(function(){return g.Bc(e),g.hc(2).amountChangeRequested=!0})),g.Vb(4,B),g.Qb(),g.Rb(5,"button",31),g.fc("click",(function(){return g.Bc(e),g.hc(2).markDamaged({apply_fines:"noapply"})})),g.Vb(6,A),g.Qb(),g.Rb(7,"button",32),g.fc("click",(function(){return g.Bc(e),g.hc(2).markDamaged({apply_fines:"apply"})})),g.Vb(8,D),g.Qb(),g.Ob()}}function K(e,c){if(1&e){const e=g.Sb();g.Rb(0,"div",4),g.Rb(1,"h4",5),g.Rb(2,"span"),g.Vb(3,w),g.Qb(),g.Qb(),g.Rb(4,"button",6),g.Xb(5,C),g.fc("click",(function(){return g.Bc(e),g.hc().close(!1)})),g.Rb(6,"span",7),g.Mc(7,"\xd7"),g.Qb(),g.Qb(),g.Qb(),g.Rb(8,"div",8),g.Rb(9,"div",9),g.Rb(10,"div",10),g.Mc(11,"Barcode:"),g.Qb(),g.Rb(12,"div",11),g.Mc(13),g.Qb(),g.Qb(),g.Rb(14,"div",9),g.Rb(15,"div",10),g.Mc(16,"Title:"),g.Qb(),g.Rb(17,"div",12),g.Mc(18),g.Qb(),g.Qb(),g.Rb(19,"div",9),g.Rb(20,"div",10),g.Mc(21,"Author:"),g.Qb(),g.Rb(22,"div",12),g.Mc(23),g.Qb(),g.Qb(),g.Kc(24,L,18,16,"div",13),g.Qb(),g.Rb(25,"div",14),g.Kc(26,E,5,0,"ng-container",15),g.Kc(27,V,9,0,"ng-container",15),g.Qb()}if(2&e){const e=g.hc();g.xb(13),g.Nc(e.copy.barcode()),g.xb(5),g.Nc(e.bibSummary.display.title),g.xb(5),g.Nc(e.bibSummary.display.author),g.xb(1),g.oc("ngIf",e.chargeResponse),g.xb(2),g.oc("ngIf",!e.chargeResponse),g.xb(1),g.oc("ngIf",e.chargeResponse)}}S=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,P=$localize`:␟409f579cf1cbc438e2733001a63f6f0807eb5101␟3948552872055355542:Mark Damaged`,z=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,B=$localize`:␟6fceab614cf9134e20dd361314467be9df32b7b2␟3291705519537739327:Change Amount`,A=$localize`:␟2e77d95bffec2bfedfdcf1f095938090bbe2da03␟2580686114144503824:No Charge`,D=$localize`:␟7e6c975ebea8b5f8b120905ca7acf9f8edf59d8e␟8998179362936748717:OK`;let X=(()=>{class e extends f.a{constructor(e,c,t,n,i,s,a,o){super(e),this.modal=e,this.toast=c,this.net=t,this.evt=n,this.pcrud=i,this.org=s,this.bib=a,this.auth=o,this.billingTypes=[]}ngOnInit(){}open(e){return this.reset(),this.copyId?Object(i.a)(this.getBillingTypes().then(e=>this.getData())).pipe(Object(s.a)(c=>super.open(e))):Object(n.a)("copy ID required")}getBillingTypes(){return this.billingTypes.length>1?Promise.resolve():this.pcrud.search("cbt",{owner:this.org.fullPath(this.auth.user().ws_ou(),!0)},{},{atomic:!0}).toPromise().then(e=>{this.billingTypes=e.sort((e,c)=>e.name()<c.name()?-1:1).map(e=>({id:e.id(),label:e.name()}))})}getData(){return this.pcrud.retrieve("acp",this.copyId,{flesh:1,flesh_fields:{acp:["call_number"]}}).toPromise().then(e=>(this.copy=e,this.bib.getBibSummary(e.call_number().record()).toPromise())).then(e=>{this.bibSummary=e})}reset(){this.copy=null,this.bibSummary=null,this.chargeResponse=null,this.newCharge=null,this.newNote=null,this.amountChangeRequested=!1}bTypeChange(e){this.newBtype=e.id}markDamaged(e){this.chargeResponse=null,e&&"apply"===e.apply_fines&&(e.override_amount=this.newCharge,e.override_btype=this.newBtype,e.override_note=this.newNote),this.net.request("open-ils.circ","open-ils.circ.mark_item_damaged",this.auth.token(),this.copyId,e).subscribe(e=>{if(console.debug("Mark damaged returned",e),1===Number(e))return this.successMsg.current().then(e=>this.toast.success(e)),void this.close(!0);const c=this.evt.parse(e);"DAMAGE_CHARGE"===c.textcode&&(this.chargeResponse=c.payload,this.newCharge=this.chargeResponse.charge)},e=>{this.errorMsg.current().then(e=>this.toast.danger(e)),console.error(e)})}}return e.\u0275fac=function(c){return new(c||e)(g.Lb(p.s),g.Lb(r.a),g.Lb(a.b),g.Lb(o.a),g.Lb(l.a),g.Lb(d.a),g.Lb(h.a),g.Lb(b.a))},e.\u0275cmp=g.Fb({type:e,selectors:[["eg-mark-damaged-dialog"]],viewQuery:function(e,c){var t;1&e&&(g.Ic(Q,!0),g.Ic(M,!0)),2&e&&(g.yc(t=g.gc())&&(c.successMsg=t.first),g.yc(t=g.gc())&&(c.errorMsg=t.first))},inputs:{copyId:"copyId"},features:[g.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-lg-1"],[1,"col-lg-11","font-weight-bold"],[1,"col-lg-11"],["class","card mt-3",4,"ngIf"],[1,"modal-footer"],[4,"ngIf"],[1,"card","mt-3"],[1,"card-header"],[1,"card-body"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[3,"href"],[1,"font-weight-bold","text-danger"],["i8n","",1,"col-lg-3"],[1,"col-lg-6"],[3,"entries","onChange",6,"placeholder"],["type","number","step","0.01","min","0",1,"form-control",3,"ngModel","ngModelChange"],["rows","3",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"btn","btn-info","mr-2",3,"click"],[1,"btn","btn-secondary","mr-2",3,"click"],[1,"btn","btn-success","mr-2",3,"click"]],template:function(e,c){1&e&&(g.Rb(0,"eg-string",0,1),g.Xb(2,I),g.Qb(),g.Rb(3,"eg-string",0,2),g.Xb(5,k),g.Qb(),g.Kc(6,K,28,6,"ng-template",null,3,g.Lc))},directives:[u.a,m.v,R.a,v.z,v.c,v.t,v.w],pipes:[y.b,m.f,m.d],encapsulation:2}),e})()},"WC/f":function(e,c,t){"use strict";t.d(c,"a",(function(){return r}));var n=t("Osig"),i=t("EQoe"),s=t("8PDw"),a=t("EQDH"),o=t("fXoL");let r=(()=>{class e{constructor(e,c,t,n){this.net=e,this.auth=c,this.evt=t,this.anonCache=n}spawnAddHoldingsUi(e,c,t,n,i,s){const a=[];c?c.forEach(e=>a.push({callnumber:e})):t&&t.forEach(e=>a.push(e)),this.anonCache.setItem(null,"edit-these-copies",{record_id:e,raw:a,copies:n,hide_vols:!0===s,hide_copies:!0===i}).then(e=>{e?setTimeout(()=>{window.open("/eg/staff/cat/volcopy/"+e,"_blank")}):console.error("Could not create holds cache key!")})}}return e.\u0275fac=function(c){return new(c||e)(o.cc(n.b),o.cc(s.a),o.cc(a.a),o.cc(i.a))},e.\u0275prov=o.Hb({token:e,factory:e.\u0275fac}),e})()},fkVb:function(e,c,t){"use strict";t.d(c,"a",(function(){return a}));var n=t("MZHd"),i=t("WC/f"),s=t("fXoL");let a=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(c){return new(c||e)},providers:[i.a],imports:[[n.a]]}),e})()}}]);