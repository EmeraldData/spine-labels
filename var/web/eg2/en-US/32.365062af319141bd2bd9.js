(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{Dmj5:function(e,t,c){"use strict";c.r(t),c.d(t,"CatalogModule",(function(){return Oh}));var a=c("zF8d"),o=c("MZHd"),r=c("tyNb"),i=c("cm5s"),n=c("mW9/"),s=c("avZ9"),l=c("W4aW"),b=c("fXoL");let d=(()=>{class e{constructor(e,t,c,a,o,r){this.router=e,this.route=t,this.org=c,this.cat=a,this.patron=o,this.catUrl=r,this.routeIndex=0,this.showExcludeElectronic=!1,this.enableBookplates=!1}createContext(){this.searchContext=this.catUrl.fromUrlParams(this.route.snapshot.queryParamMap),this.holdForBarcode=this.route.snapshot.queryParams.holdForBarcode,this.holdForBarcode&&this.patron.getByBarcode(this.holdForBarcode).then(e=>this.holdForUser=e),this.searchContext.org=this.org,this.searchContext.isStaff=!0,this.applySearchDefaults()}cloneContext(e){const t=this.catUrl.toUrlParams(e);return this.catUrl.fromUrlHash(t)}applySearchDefaults(){this.searchContext.searchOrg||(this.searchContext.searchOrg=this.defaultSearchOrg||this.org.root()),this.searchContext.pager.limit||(this.searchContext.pager.limit=this.defaultSearchLimit||10)}search(){if(!this.searchContext.isSearchable())return;const e=this.catUrl.toUrlParams(this.searchContext);e.ridx=""+this.routeIndex++,this.router.navigate(["/staff/catalog/search"],{queryParams:e})}browse(){if(!this.searchContext.browseSearch.isSearchable())return;const e=this.catUrl.toUrlParams(this.searchContext);e.ridx=""+this.routeIndex++,this.router.navigate(["/staff/catalog/browse"],{queryParams:e})}cnBrowse(){if(!this.searchContext.cnBrowseSearch.isSearchable())return;const e=this.catUrl.toUrlParams(this.searchContext);e.ridx=""+this.routeIndex++,this.router.navigate(["/staff/catalog/cnbrowse"],{queryParams:e})}getAuthorSearchParams(e){const t=this.cloneContext(this.searchContext);return t.reset(),t.termSearch.fieldClass=["author"],t.termSearch.query=[e.display.author],this.catUrl.toUrlParams(t)}}return e.\u0275fac=function(t){return new(t||e)(b.cc(r.c),b.cc(r.a),b.cc(i.a),b.cc(n.a),b.cc(l.a),b.cc(s.a))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac}),e})();var h=c("LMfH"),f=c("ufrD"),u=c("ofXK"),g=c("XN9O"),p=c("3Pt+"),m=c("1kSV"),R=c("wVJ/"),y=c("OXuP"),x=c("OsfI"),v=c("rRT/"),C=c("36iw"),Q=c("G8BM"),I=c("EQoe"),_=c("tNQm");const S=["confirmDelete"],T=["confirmDeleteAll"],k=["confirmDeleteSearches"],$=["dialogTitle",$localize`:␟a6ecf76f074e2098ee024b6c2586a0475a2d6dd3␟6208564441860154239:Confirm Delete`,"dialogBody",$localize`:␟2776d40dec1cffa32f33ba6617f17609c4aac54a␟3350073712470262570:Delete saved search template '${"\ufffd0\ufffd"}:INTERPOLATION:'?`],w=["dialogTitle",$localize`:␟348e571f009ebd114fa915d31cf5e21c347069b5␟4229975594546660291:Confirm Delete All`,"dialogBody",$localize`:␟086c0e67119b553d4bb4f7f75f447b81cbd522b2␟2589672350783676854:Delete all saved templates?`],M=["dialogTitle",$localize`:␟5fe037afff41cdd1d5e1f76b20d02eae7c66380c␟8964998104618969725:Confirm clear searches`,"dialogBody",$localize`:␟28e23b611ff8e53d53f0bc5d37819b70cf5c6aab␟7141643886553166303:Clear all recent searches?`];var N,O,z,P,L,A,B,E,D;function F(e,t){1&e&&(b.bc(0,L,1),b.Mb(1,"span"),b.Yb())}function V(e,t){1&e&&(b.bc(0,L,2),b.Mb(1,"span"),b.Yb())}function K(e,t){1&e&&(b.bc(0,L,3),b.Mb(1,"span"),b.Yb())}function X(e,t){1&e&&(b.bc(0,L,4),b.Mb(1,"span"),b.Yb())}function G(e,t){if(1&e&&(b.bc(0,L),b.Pb(1,16),b.Kc(2,F,2,0,"span",17),b.Kc(3,V,2,0,"span",17),b.Kc(4,K,2,0,"span",17),b.Kc(5,X,2,0,"span",17),b.Ob(),b.Yb()),2&e){const e=t.tab,c=t.query;b.xb(1),b.oc("ngSwitch",e),b.xb(1),b.oc("ngSwitchCase","term"),b.xb(1),b.oc("ngSwitchCase","ident"),b.xb(1),b.oc("ngSwitchCase","marc"),b.xb(1),b.oc("ngSwitchCase","browse"),b.Zb(c),b.Wb(0)}}function H(e,t){1&e&&(b.Rb(0,"button",21),b.Vb(1,E),b.Qb()),2&e&&b.oc("disabled",!0)}function q(e,t){if(1&e){const e=b.Sb();b.Rb(0,"button",22),b.fc("click",(function(){b.Bc(e);const c=t.$implicit;return b.hc(2).searchSelected(c)})),b.Mc(1),b.Qb()}if(2&e){const e=t.$implicit,c=b.hc(2);b.oc("routerLink",c.getSearchPath(e))("queryParams",e.params),b.xb(1),b.Nc(e.name)}}function U(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",8),b.Rb(2,"button",18),b.Vb(3,A),b.Qb(),b.Rb(4,"div",19),b.Rb(5,"button",11),b.fc("click",(function(){return b.Bc(e),b.hc().deleteSearches()})),b.Vb(6,B),b.Qb(),b.Mb(7,"div",12),b.Kc(8,H,2,1,"button",13),b.Kc(9,q,2,3,"button",20),b.Qb(),b.Qb(),b.Ob()}if(2&e){const e=b.hc();b.xb(5),b.oc("disabled",0===e.searches.length),b.xb(3),b.oc("ngIf",0===e.searches.length),b.xb(1),b.oc("ngForOf",e.sortSearches())}}function j(e,t){1&e&&(b.Rb(0,"button",21),b.Vb(1,D),b.Qb()),2&e&&b.oc("disabled",!0)}N=$localize`:␟df48d9e25bc544980ca0bec327b19e96858befc0␟3582744692531337520:Search Templates`,O=$localize`:␟b68a0f8d84a0ab8aacdcd8682dc209e221fece50␟1036586810617210056:Save Template`,z=$localize`:␟96e678d5f4bfe1a041ecfcd34804efa5e100d5e8␟5167284364083276913:Delete Selected`,P=$localize`:␟49310e3bd9393c39f971039a25ac892170e8959b␟6568770950014127079:Delete All Templates`,L=$localize`:␟91f26bb0794f242b9faa46828ed4ab24f0f3bd2b␟3674458241245898981:${"\ufffd#1\ufffd"}:START_TAG_NG_CONTAINER:${"\ufffd*2:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN:Search:${"[\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*3:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*4:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*5:4\ufffd]"}:CLOSE_TAG_SPAN:${"\ufffd*3:2\ufffd\ufffd#1:2\ufffd"}:START_TAG_SPAN_1:Identifier:${"[\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*3:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*4:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*5:4\ufffd]"}:CLOSE_TAG_SPAN:${"\ufffd*4:3\ufffd\ufffd#1:3\ufffd"}:START_TAG_SPAN_2:MARC:${"[\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*3:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*4:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*5:4\ufffd]"}:CLOSE_TAG_SPAN:${"\ufffd*5:4\ufffd\ufffd#1:4\ufffd"}:START_TAG_SPAN_3:Browse:${"[\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*3:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*4:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*5:4\ufffd]"}:CLOSE_TAG_SPAN:${"\ufffd/#1\ufffd"}:CLOSE_TAG_NG_CONTAINER: ${"\ufffd0\ufffd"}:INTERPOLATION:
`,L=b.ac(L),A=$localize`:␟db058ec7ac1929327d079b3c56394c68e7a3686e␟6589762315111712130:Recent Searches`,B=$localize`:␟6689828ab3a0d4dd0a5521c21a1fcc7b81aeee25␟1649755253223706336:Clear Recent Searches`,E=$localize`:␟9c8c8e019b205876856aebab44df69aa6c45a021␟8034357036299411879:No Recent Searches`,D=$localize`:␟2605c3e0f1213435ac4fd71d9413144cdec9cb9a␟3680187766502370295:No Saved Templates`;const Y=function(e){return{"font-weight-bold":e}};function W(e,t){if(1&e){const e=b.Sb();b.Rb(0,"button",23),b.fc("click",(function(){b.Bc(e);const c=t.$implicit;return b.hc().templateSelected(c)})),b.Mc(1),b.Qb()}if(2&e){const e=t.$implicit,c=b.hc();b.oc("ngClass",b.uc(4,Y,e.name===c.selectedTemplate()))("routerLink",c.getSearchPath(e))("queryParams",e.params),b.xb(1),b.Nc(e.name)}}var Z;Z=$localize`:␟b68a0f8d84a0ab8aacdcd8682dc209e221fece50␟1036586810617210056:Save Template`;const J=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var ee,te,ce;function ae(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",24),b.Rb(1,"h4",25),b.Vb(2,Z),b.Qb(),b.Rb(3,"button",26),b.Xb(4,J),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Rb(5,"span",27),b.Mc(6,"\xd7"),b.Qb(),b.Qb(),b.Qb(),b.Rb(7,"div",28),b.Rb(8,"div",29),b.Rb(9,"div",30),b.Vb(10,ee),b.Qb(),b.Rb(11,"div",31),b.Rb(12,"input",32),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc().templateName=t})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(13,"div",33),b.Rb(14,"button",34),b.fc("click",(function(){return b.Bc(e),b.hc().saveTemplate()})),b.Vb(15,te),b.Qb(),b.Rb(16,"button",35),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Vb(17,ce),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(12),b.oc("ngModel",e.templateName)}}ee=$localize`:␟4b1b2852edd0702220b3a33093f0f9d8eb304436␟36038288712703305:Template Name:`,te=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`,ce=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`;class oe{constructor(e,t){this.params={},this.name=e,this.params=t}}let re=(()=>{class e extends v.a{constructor(e,t,c,a,o,r,i,n,s){super(s),this.org=e,this.store=t,this.serverStore=c,this.cache=a,this.strings=o,this.cat=r,this.catUrl=i,this.staffCat=n,this.modal=s,this.recentSearchesCount=0,this.templates=[],this.searches=[],this.store.addLoginSessionKey("eg.catalog.recent_searches")}ngOnInit(){this.context=this.staffCat.searchContext,this.serverStore.getItem("opac.staff_saved_search.size").then(e=>{e&&(this.recentSearchesCount=Number(e),this.getSearches().then(e=>{this.searches.forEach(e=>e.params.ridx=++this.staffCat.routeIndex),this.saveSearch(this.context),this.cat.onSearchComplete.subscribe(e=>this.saveSearch(e))}))}),this.getTemplates()}selectedTemplate(){return this.staffCat.selectedTemplate}getSearches(){if(this.searches=[],this.searchesCacheKey)return this.cache.getItem(this.searchesCacheKey,"searches").then(e=>this.searches=e||[]);const e=this.store.getLoginSessionItem("eg.catalog.recent_searches");return e?(this.searchesCacheKey=e,this.cache.getItem(this.searchesCacheKey,"searches").then(e=>this.searches=e||[])):this.cache.setItem(null,"searches",[]).then(e=>{this.searchesCacheKey=e,this.store.setLoginSessionItem("eg.catalog.recent_searches",e)})}searchSelected(e){e.params.ridx=++this.staffCat.routeIndex}sortSearches(){return this.searches.sort((e,t)=>e.addTime>t.addTime?-1:1)}deleteSearches(){this.confirmDeleteSearches.open().subscribe(e=>{e&&(this.searches=[],this.cache.setItem(this.searchesCacheKey,"searches",[]))})}getSearchPath(e){return"browse"===e.params.searchTab?"/staff/catalog/browse":"/staff/catalog/search"}saveSearch(e){let t,c=!1;if(this.searches.forEach(t=>{this.catUrl.fromUrlHash(t.params).equals(e)&&(c=!0)}),!c){switch(this.searchTab){case"term":t=e.termSearch.query[0];break;case"marc":t=e.marcSearch.values[0];break;case"ident":t=e.identSearch.value;break;case"browse":t=e.browseSearch.value;break;case"cnbrowse":t=e.cnBrowseSearch.value}t&&this.strings.interpolate("eg.catalog.recent_search.label",{query:t,tab:this.searchTab}).then(t=>{const c=this.prepareSearch(e),a=new oe(t,c);a.addTime=(new Date).getTime(),this.searches.unshift(a),this.searches.length>this.recentSearchesCount&&(this.searches.length=this.recentSearchesCount),this.cache.setItem(this.searchesCacheKey,"searches",this.searches).then(e=>a.params.ridx=++this.staffCat.routeIndex)})}}getTemplates(){return this.templates=[],this.serverStore.getItem("eg.catalog.search_templates").then(e=>{e&&e.length&&(this.templates=e,this.templates.forEach(e=>e.params.ridx=++this.staffCat.routeIndex))})}sortTemplates(){return this.templates.sort((e,t)=>e.name.toLowerCase()<t.name.toLowerCase()?-1:1)}templateSelected(e){this.staffCat.selectedTemplate=e.name,e.params.ridx=++this.staffCat.routeIndex,console.log("selected template = ",this.staffCat.selectedTemplate)}addDummyQueries(e){e.termSearch.query=e.termSearch.query.map(e=>"x"),e.marcSearch.values=e.marcSearch.values.map(e=>"x"),e.browseSearch.value="x",e.identSearch.value="x"}removeDummyQueries(e){e.query=Array.isArray(e.query)?e.query.map(e=>""):"",e.marcValue=Array.isArray(e.marcValue)?e.marcValue.map(e=>""):"",e.identQuery="",e.browseTerm=""}prepareSearch(e,t){const c=e.clone();t&&this.addDummyQueries(c),c.scrub(this.searchTab);const a=this.catUrl.toUrlParams(c);return t&&this.removeDummyQueries(a),delete a.org,delete a.ridx,a.searchTab=this.searchTab,a}saveTemplate(){if(!this.templateName)return Promise.resolve();this.staffCat.selectedTemplate=this.templateName;const e=this.prepareSearch(this.context,!0);return this.templates.push(new oe(this.templateName,e)),this.applyTemplateChanges().then(e=>this.close())}applyTemplateChanges(){return this.serverStore.setItem("eg.catalog.search_templates",this.templates)}deleteTemplate(){this.confirmDelete.open().subscribe(e=>{if(!e)return;const t=[];this.templates.forEach(e=>{e.name!==this.staffCat.selectedTemplate&&t.push(e)}),this.templates=t,this.staffCat.selectedTemplate="",this.applyTemplateChanges()})}deleteAllTemplates(){this.confirmDeleteAll.open().subscribe(e=>{e&&(this.templates=[],this.staffCat.selectedTemplate="",this.applyTemplateChanges())})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(i.a),b.Lb(y.a),b.Lb(x.a),b.Lb(I.a),b.Lb(Q.a),b.Lb(n.a),b.Lb(s.a),b.Lb(d),b.Lb(m.s))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-search-templates"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(S,!0),b.Ic(T,!0),b.Ic(k,!0)),2&e&&(b.yc(c=b.gc())&&(t.confirmDelete=c.first),b.yc(c=b.gc())&&(t.confirmDeleteAll=c.first),b.yc(c=b.gc())&&(t.confirmDeleteSearches=c.first))},inputs:{searchTab:"searchTab"},features:[b.ub],decls:29,vars:8,consts:[[6,"dialogTitle","dialogBody"],["confirmDelete",""],["confirmDeleteAll",""],["confirmDeleteSearches",""],["searchName",""],["key","eg.catalog.recent_search.label",3,"template"],[1,"d-flex","justify-content-end"],[4,"ngIf"],["ngbDropdown","","placement","bottom-right"],["id","searchTemplates","ngbDropdownToggle","",1,"btn","btn-light"],["ngbDropdownMenu","","aria-labelledby","searchTemplates"],[1,"dropdown-item",3,"disabled","click"],[1,"dropdown-divider"],["class","dropdown-item font-italic",3,"disabled",4,"ngIf"],["class","dropdown-item",3,"ngClass","routerLink","queryParams","click",4,"ngFor","ngForOf"],["dialogContent",""],[3,"ngSwitch"],[4,"ngSwitchCase"],["id","recentSearches","ngbDropdownToggle","",1,"btn","btn-light"],["ngbDropdownMenu","","aria-labelledby","recentSearches"],["class","dropdown-item",3,"routerLink","queryParams","click",4,"ngFor","ngForOf"],[1,"dropdown-item","font-italic",3,"disabled"],[1,"dropdown-item",3,"routerLink","queryParams","click"],[1,"dropdown-item",3,"ngClass","routerLink","queryParams","click"],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],["id","templateNameLabel",1,"col-lg-4"],[1,"col-lg-6"],["aria-labelledby","templateNameLabel",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-warning",3,"click"]],template:function(e,t){if(1&e&&(b.Rb(0,"eg-confirm-dialog",0,1),b.Xb(2,$),b.Qb(),b.Rb(3,"eg-confirm-dialog",0,2),b.Xb(5,w),b.Qb(),b.Rb(6,"eg-confirm-dialog",0,3),b.Xb(8,M),b.Qb(),b.Kc(9,G,6,6,"ng-template",null,4,b.Lc),b.Mb(11,"eg-string",5),b.Rb(12,"div",6),b.Kc(13,U,10,3,"ng-container",7),b.Rb(14,"div",8),b.Rb(15,"button",9),b.Vb(16,N),b.Qb(),b.Rb(17,"div",10),b.Rb(18,"button",11),b.fc("click",(function(){return t.open()})),b.Vb(19,O),b.Qb(),b.Rb(20,"button",11),b.fc("click",(function(){return t.deleteTemplate()})),b.Vb(21,z),b.Qb(),b.Rb(22,"button",11),b.fc("click",(function(){return t.deleteAllTemplates()})),b.Vb(23,P),b.Qb(),b.Mb(24,"div",12),b.Kc(25,j,2,1,"button",13),b.Kc(26,W,2,6,"button",14),b.Qb(),b.Qb(),b.Qb(),b.Kc(27,ae,18,1,"ng-template",null,15,b.Lc)),2&e){const e=b.zc(10);b.Zb(t.selectedTemplate()),b.Wb(2),b.xb(11),b.oc("template",e),b.xb(2),b.oc("ngIf",t.recentSearchesCount>0),b.xb(5),b.oc("disabled","cnbrowse"===t.searchTab),b.xb(2),b.oc("disabled",!t.selectedTemplate()),b.xb(2),b.oc("disabled",0===t.templates.length),b.xb(3),b.oc("ngIf",0===t.templates.length),b.xb(1),b.oc("ngForOf",t.sortTemplates())}},directives:[C.a,_.a,u.v,m.l,m.p,m.o,u.u,u.z,u.A,r.d,u.s,p.c,p.t,p.w],encapsulation:2}),e})();var ie=c("Osig"),ne=c("8PDw"),se=c("E45d"),le=c("1tmW");const be=["addBasketToBucketDialog"];var de,he,fe,ue,ge,pe,me,Re,ye,xe;de=$localize`:␟fac0df6aa17436575e165b4e7ec2bb0c4fbb8bdc␟2339984391599481637:(${"\ufffd0\ufffd"}:INTERPOLATION:)`,he=$localize`:␟5517dea9cd2ae57f755ec786e5ce712d2223b178␟8388570073302772112:Basket Actions`,fe=$localize`:␟15febde022c268f41bc77ae218582731b668dd6f␟8371227513128124547:View Basket`,ue=$localize`:␟a8d2c33741ffac33baa5034038c0ada021156cfe␟133993343914853660:Place Hold`,ge=$localize`:␟58a8dab32f1aefdc41ad914cfccea3c26704850c␟5740929948063666280:Print Title Details`,pe=$localize`:␟0f8fa1ccdf92998e7abf9e51919f48bd36266fc2␟2609957449622415886:Email Title Details`,me=$localize`:␟aa45d0b60cbbdc5e9885630684d6f999dcf85fbe␟1433099939355924006:Add Basket to Bucket`,Re=$localize`:␟18e97c3234dba787368bc7ed79a573971764ed32␟480925552307435874:Export Records`,ye=$localize`:␟c982c4adc343ce8427c6772bc98126f9864f49c5␟7195503763323526760:Clear Basket`,xe=$localize`:␟4199d36ba672058a473297870e3ad06ffa742b04␟7985064246399990288:Catalog Preferences`;const ve=function(){return{showBasket:!0}};let Ce=(()=>{class e{constructor(e,t,c,a,o){this.router=e,this.net=t,this.auth=c,this.printer=a,this.basket=o,this.basketAction=""}ngOnInit(){}basketCount(){return this.basket.recordCount()}applyAction(e){switch(this.basketAction=e,console.debug("Performing basket action",this.basketAction),this.basketAction){case"view":this.router.navigate(["/staff/catalog/search"],{queryParams:{showBasket:!0}});break;case"clear":this.basket.removeAllRecordIds();break;case"hold":this.basket.getRecordIds().then(e=>{this.router.navigate(["/staff/catalog/hold/T"],{queryParams:{target:e}})});break;case"print":this.basket.getRecordIds().then(e=>{this.net.request("open-ils.search","open-ils.search.biblio.record.print",e).subscribe(e=>{const t=e.template_output().data();this.printer.print({text:t,printContext:"default"})})});break;case"email":this.basket.getRecordIds().then(e=>{this.net.request("open-ils.search","open-ils.search.biblio.record.email",this.auth.token(),e).toPromise()});break;case"export_marc":this.router.navigate(["/staff/cat/vandelay/export/basket"],{queryParamsHandling:"merge"});break;case"bucket":this.basket.getRecordIds().then(e=>{this.addToBucketDialog.bucketClass="biblio",this.addToBucketDialog.itemIds=e,this.addToBucketDialog.open({size:"lg"})})}setTimeout(()=>this.basketAction="")}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(ie.b),b.Lb(ne.a),b.Lb(se.a),b.Lb(h.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-basket-actions"]],viewQuery:function(e,t){var c;1&e&&b.Ic(be,!0),2&e&&b.yc(c=b.gc())&&(t.addToBucketDialog=c.first)},decls:33,vars:4,consts:[["addBasketToBucketDialog",""],[1,"d-flex","justify-content-end"],[1,"pr-1"],[1,"float-right"],["routerLink","/staff/catalog/search",1,"label-with-material-icon",3,"queryParams"],[1,"material-icons"],["ngbDropdown","","placement","bottom-right"],["id","basketActions","ngbDropdownToggle","",1,"btn","btn-light",3,"disabled"],["ngbDropdownMenu","","aria-labelledby","basketActions"],[1,"dropdown-item",3,"click"],["routerLink","/staff/catalog/prefs","queryParamsHandling","merge"],[1,"btn","btn-light"]],template:function(e,t){1&e&&(b.Mb(0,"eg-bucket-dialog",null,0),b.Rb(2,"div",1),b.Rb(3,"div",2),b.Rb(4,"div",3),b.Rb(5,"a",4),b.Rb(6,"span",5),b.Mc(7,"shopping_basket"),b.Qb(),b.Rb(8,"span"),b.Vb(9,de),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(10,"div",2),b.Rb(11,"div",6),b.Rb(12,"button",7),b.Vb(13,he),b.Qb(),b.Rb(14,"div",8),b.Rb(15,"button",9),b.fc("click",(function(){return t.applyAction("view")})),b.Vb(16,fe),b.Qb(),b.Rb(17,"button",9),b.fc("click",(function(){return t.applyAction("hold")})),b.Vb(18,ue),b.Qb(),b.Rb(19,"button",9),b.fc("click",(function(){return t.applyAction("print")})),b.Vb(20,ge),b.Qb(),b.Rb(21,"button",9),b.fc("click",(function(){return t.applyAction("email")})),b.Vb(22,pe),b.Qb(),b.Rb(23,"button",9),b.fc("click",(function(){return t.applyAction("bucket")})),b.Vb(24,me),b.Qb(),b.Rb(25,"button",9),b.fc("click",(function(){return t.applyAction("export_marc")})),b.Vb(26,Re),b.Qb(),b.Rb(27,"button",9),b.fc("click",(function(){return t.applyAction("clear")})),b.Vb(28,ye),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(29,"div"),b.Rb(30,"a",10),b.Rb(31,"button",11),b.Vb(32,xe),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.xb(5),b.oc("queryParams",b.tc(3,ve)),b.xb(4),b.Zb(t.basketCount()),b.Wb(9),b.xb(3),b.oc("disabled",!t.basketCount()))},directives:[le.a,r.f,m.l,m.p,m.o],encapsulation:2}),e})();var Qe,Ie;function _e(e,t){1&e&&(b.Pb(0),b.Vb(1,Qe),b.Ob())}function Se(e,t){if(1&e&&(b.Rb(0,"option",5),b.Mc(1),b.Kc(2,_e,2,0,"ng-container",6),b.Qb()),2&e){const e=t.$implicit;b.pc("value",e.code()),b.xb(1),b.Oc(" ",e.search_label()||e.value()," "),b.xb(1),b.oc("ngIf","f"===e.opac_visible())}}function Te(e,t){1&e&&b.Kc(0,Se,3,3,"option",4),2&e&&b.oc("ngForOf",t.list)}function ke(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",7),b.Rb(1,"div",8),b.Mb(2,"div",9),b.Rb(3,"a",10),b.fc("click",(function(){return b.Bc(e),b.hc().showThyself=!0})),b.bc(4,Ie),b.Mb(5,"span",11),b.Yb(),b.Qb(),b.Qb(),b.Qb()}}Qe=$localize`:␟77176853cf639db9c72e0428967639ba5c156b6a␟3251825108526558596:(Hidden)`,Ie=$localize`:␟28db2d462432c6349603e5e53b18b19afaf509b4␟8120269181725722869: Show Search Form ${"\ufffd#5\ufffd"}:START_TAG_SPAN:unfold_more${"\ufffd/#5\ufffd"}:CLOSE_TAG_SPAN:`;const $e=["title",$localize`:␟3d58fd5e20265416211395bdd1b5b20a96c776eb␟5622103939576115496:Keyword Search`],we=["title",$localize`:␟fcddcc5f6270de6fa0647d785ff16e2d919d0a91␟7171276766661761441:Numeric Search`],Me=["title",$localize`:␟2b58cea040d61b91726290b662e7921b9d818f6c␟95301782947665561:MARC Search`],Ne=["title",$localize`:␟2c7dc726e93bcf3ca2f316bbebe96fa1e5288ba0␟787163983066183218:Browse`],Oe=["title",$localize`:␟b9eacc9896094e2bec84e875a25e959f36448f85␟1380690145177345961:Shelf Browse`];var ze,Pe,Le;ze=$localize`:␟d52accda82e1bfab1f36d0f0417cb9cc93d0f283␟5065837375253935970: Search `,Pe=$localize`:␟57d734752102a3a59233f7569a06b6185e07ffd7␟5606170787510897717: Reset `,Le=$localize`:␟3e4a3a681ca7b23d1b2ca762a90a093bb174b09f␟2191134112135066054:Sort by Relevance`;const Ae=["label",$localize`:␟82cc7cbbe6746eb6a769a1ac48e466df15abc236␟3761171626593711598:Sort by Title`];var Be,Ee;Be=$localize`:␟dd03a55bba50cce7602d5a8bce34895a73000626␟3620416795581417548:Title: A to Z`,Ee=$localize`:␟78d80f1650d73ab02a9a62ead01e3411e35dde34␟4954117169038902282:Title: Z to A`;const De=["label",$localize`:␟2f6eb9adba90a8937deb313277a3c9413d9d4fb3␟406936770088737944:Sort by Author`];var Fe,Ve;Fe=$localize`:␟1ed7929f08f9889499127413e7e8e021a723c9f3␟2382023229713400972:Author: A to Z`,Ve=$localize`:␟d96a469251a39d29b45edbfdd4cfa5cef944b99b␟9149191910176940706:Author: Z to A`;const Ke=["label",$localize`:␟be75e33c802e4b692a4aeee980fc8d3f4828d672␟7929052621434058567:Sort by Publication Date`];var Xe,Ge;Xe=$localize`:␟9419b89c1defa04a66b153c9e796f718c9d0ec3f␟6239412715469327015:Date: A to Z`,Ge=$localize`:␟1baa95a6c18bc2b787a0c710e391931a599c3e24␟7354093942845473787:Date: Z to A`;const He=["label",$localize`:␟3f0e68018c886e86297b136e675ddecb9cc7c039␟6326065868250195167:Sort by Popularity`];var qe,Ue,je,Ye,We,Ze,Je,et,tt,ct,at,ot,rt,it,nt,st;qe=$localize`:␟ae5a2ec602602cfc1ebf8de031cffc8149b130d5␟2627546436080053768:Most Popular`,Ue=$localize`:␟b7bdbcd49cef2d73293748b5a06d695a39758734␟8604707826673034823:Popularity Adjusted Relevance`,je=$localize`:␟0a4e098f092a018a92ade16fa351f325002d00bc␟1678157873175865218:Limit to Available`,Ye=$localize`:␟4ba181dab5c194849df0aa0eb7ccf04c017e8a62␟5448980652854097012:Group Formats/Editions`,We=$localize`:␟4715c797ac2364b895561d90da8897e441cb30b7␟246072592254200629:Results from All Libraries`,Ze=$localize`:␟856d4f9f808e2d113350ef83739857221c63adaf␟5206272431542421762:Keyword`,Je=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`,et=$localize`:␟788710f2567f5d095727dd4700199e26d8672857␟5814277628544156857:Journal Title`,tt=$localize`:␟d7293b61e9088c66421df2e367e0ccc00346cf9f␟7071470734400948493:Author`,ct=$localize`:␟4b0ca852bafa5037c4e64c7b18f9cd1e14b799de␟9127604588498960753:Subject`,at=$localize`:␟f2602159bf76864fa86ee0cd8e1ce2370f27c88b␟7707176955005055131:Series`,ot=$localize`:␟ac1fbba350bbb5cce73d81d370660b5225511825␟6238291467288576076:Contains`,rt=$localize`:␟f29693dfd21088eebb467f30c58a030be7b1085a␟6026830463967999464:Does not contain`,it=$localize`:␟67c0f3bd84bc681f8fb433ef349eed8b9e8e7259␟3579627173075186674:Contains phrase`,nt=$localize`:␟7a7382240f5456397594b6bbfef88a315022ea29␟7606173727286297984:Matches exactly`,st=$localize`:␟b5923a6ea6261be97fb755f1ec6f46560db99f96␟8863611568205528132:Starts with`;const lt=["title",$localize`:␟4a6a6e4be4e09a4968fc0bb378ffad641ef98581␟4747829620898136057:Add Search Row`],bt=["title",$localize`:␟d326d3f7c251c03b8e3d6858f2e1073e9b74583b␟5128849672893415097:Remove Search Row`];var dt;function ht(e,t){1&e&&b.Nb(0)}dt=$localize`:␟344a3db03a4a700b888c433c31229ff4b946c6e0␟769264049456217533:All Formats`;const ft=function(e){return{list:e}};function ut(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div"),b.Rb(1,"select",63),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(4).context.termSearch.format=t})),b.Rb(2,"option",36),b.Vb(3,dt),b.Qb(),b.Kc(4,ht,1,0,"ng-container",75),b.Qb(),b.Qb()}if(2&e){const e=b.hc(4),t=b.zc(1);b.xb(1),b.oc("ngModel",e.context.termSearch.format),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(3,ft,e.ccvmMap.search_format))}}var gt,pt,mt;function Rt(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div"),b.Rb(1,"select",63),b.fc("ngModelChange",(function(t){b.Bc(e);const c=b.hc().index;return b.hc(3).context.termSearch.joinOp[c]=t})),b.Rb(2,"option",76),b.Vb(3,gt),b.Qb(),b.Rb(4,"option",77),b.Vb(5,pt),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc().index,t=b.hc(3);b.xb(1),b.oc("ngModel",t.context.termSearch.joinOp[e])}}function yt(e,t){1&e&&(b.Rb(0,"option",78),b.Vb(1,mt),b.Qb())}function xt(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div"),b.Rb(1,"input",79),b.fc("ngModelChange",(function(t){b.Bc(e);const c=b.hc().index;return b.hc(3).context.termSearch.query[c]=t}))("keyup.enter",(function(){return b.Bc(e),b.hc(4).searchByForm()})),b.Qb(),b.Qb()}if(2&e){const e=b.hc().index,t=b.hc(3);b.xb(1),b.oc("ngModel",t.context.termSearch.query[e])}}function vt(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div"),b.Rb(1,"input",80),b.fc("ngModelChange",(function(t){b.Bc(e);const c=b.hc().index;return b.hc(3).context.termSearch.query[c]=t}))("keyup.enter",(function(){return b.Bc(e),b.hc(4).searchByForm()})),b.Qb(),b.Qb()}if(2&e){const e=b.hc().index,t=b.hc(3);b.xb(1),b.oc("ngModel",t.context.termSearch.query[e])}}gt=$localize`:␟1a8e4d6a42464c028d6c95919e677ab095d0f952␟188313477943387511:And`,pt=$localize`:␟1b518e7f8c067fa55ea797bb1b35b4a2d31dccbc␟5504129468136884250:Or`,mt=$localize`:␟390aa9100f551c77625b81c799400bb1c7f68794␟2380525656629725135:Digital Bookplate`;const Ct=["title",$localize`:␟87f76643147560b6a93890614342649ee8241dc9␟1414468176699633323:Toggle Search Filters`];function Qt(e,t){if(1&e){const e=b.Sb();b.Rb(0,"button",81),b.Xb(1,Ct),b.fc("click",(function(){return b.Bc(e),b.hc(4).toggleFilters()})),b.Rb(2,"span",11),b.Mc(3,"more_vert"),b.Qb(),b.Qb()}}const It=function(e,t){return{"mt-4":e,"mt-1":t}};function _t(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",52),b.Rb(1,"div",53),b.Kc(2,ut,5,5,"div",6),b.Kc(3,Rt,6,1,"div",6),b.Qb(),b.Rb(4,"div",54),b.Rb(5,"select",55),b.fc("change",(function(){b.Bc(e);const c=t.index;return b.hc(3).preventBogusCombos(c)}))("ngModelChange",(function(c){b.Bc(e);const a=t.index;return b.hc(3).context.termSearch.fieldClass[a]=c})),b.Rb(6,"option",56),b.Vb(7,Ze),b.Qb(),b.Rb(8,"option",57),b.Vb(9,Je),b.Qb(),b.Rb(10,"option",58),b.Vb(11,et),b.Qb(),b.Rb(12,"option",59),b.Vb(13,tt),b.Qb(),b.Rb(14,"option",60),b.Vb(15,ct),b.Qb(),b.Rb(16,"option",61),b.Vb(17,at),b.Qb(),b.Kc(18,yt,2,0,"option",62),b.Qb(),b.Qb(),b.Rb(19,"div",54),b.Rb(20,"select",63),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.index;return b.hc(3).context.termSearch.matchOp[a]=c})),b.Rb(21,"option",64),b.Vb(22,ot),b.Qb(),b.Rb(23,"option",65),b.Vb(24,rt),b.Qb(),b.Rb(25,"option",66),b.Vb(26,it),b.Qb(),b.Rb(27,"option",67),b.Vb(28,nt),b.Qb(),b.Rb(29,"option",68),b.Vb(30,st),b.Qb(),b.Qb(),b.Qb(),b.Rb(31,"div",69),b.Rb(32,"div",70),b.Kc(33,xt,2,1,"div",6),b.Kc(34,vt,2,1,"div",6),b.Qb(),b.Qb(),b.Rb(35,"div",71),b.Rb(36,"button",72),b.Xb(37,lt),b.fc("click",(function(){b.Bc(e);const c=t.index;return b.hc(3).addSearchRow(c+1)})),b.Rb(38,"span",11),b.Mc(39,"add_circle_outline"),b.Qb(),b.Qb(),b.Rb(40,"button",73),b.Xb(41,bt),b.fc("click",(function(){b.Bc(e);const c=t.index;return b.hc(3).delSearchRow(c)})),b.Rb(42,"span",11),b.Mc(43,"remove_circle_outline"),b.Qb(),b.Qb(),b.Kc(44,Qt,4,0,"button",74),b.Qb(),b.Qb()}if(2&e){const e=t.index,c=b.hc(3);b.oc("ngClass",b.vc(12,It,0==e,e>0)),b.xb(2),b.oc("ngIf",0==e),b.xb(1),b.oc("ngIf",e>0),b.xb(2),b.oc("ngModel",c.context.termSearch.fieldClass[e]),b.xb(13),b.oc("ngIf",c.showBookplate()),b.xb(2),b.oc("ngModel",c.context.termSearch.matchOp[e]),b.xb(7),b.oc("disabled","keyword"==c.context.termSearch.fieldClass[e]),b.xb(2),b.oc("disabled","keyword"==c.context.termSearch.fieldClass[e]),b.xb(4),b.oc("ngIf",0==e),b.xb(1),b.oc("ngIf",e>0),b.xb(6),b.oc("disabled",c.context.termSearch.query.length<2),b.xb(4),b.oc("ngIf",0==e)}}var St,Tt,kt,$t,wt,Mt,Nt,Ot,zt,Pt,Lt,At,Bt,Et,Dt,Ft,Vt,Kt,Xt,Gt,Ht,qt,Ut,jt,Yt,Wt,Zt,Jt,ec,tc,cc,ac;function oc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",49),b.Rb(1,"label"),b.Rb(2,"input",47),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.excludeElectronic=t})),b.Qb(),b.Rb(3,"span",48),b.Vb(4,St),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(3);b.xb(2),b.oc("ngModel",e.context.termSearch.excludeElectronic)}}function rc(e,t){1&e&&b.Nb(0)}function ic(e,t){1&e&&b.Nb(0)}function nc(e,t){1&e&&b.Nb(0)}function sc(e,t){1&e&&b.Nb(0)}function lc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",82),b.Rb(1,"div",83),b.Rb(2,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.item_type=t})),b.Rb(3,"option",36),b.Vb(4,Tt),b.Qb(),b.Kc(5,rc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(6,"div",83),b.Rb(7,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.item_form=t})),b.Rb(8,"option",36),b.Vb(9,kt),b.Qb(),b.Kc(10,ic,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(11,"div",83),b.Rb(12,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.item_lang=t})),b.Rb(13,"option",36),b.Vb(14,$t),b.Qb(),b.Kc(15,nc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(16,"div",83),b.Rb(17,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.audience=t})),b.Rb(18,"option",36),b.Vb(19,wt),b.Qb(),b.Kc(20,sc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(3),t=b.zc(1);b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.item_type),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(12,ft,e.ccvmMap.item_type)),b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.item_form),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(14,ft,e.ccvmMap.item_form)),b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.item_lang),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(16,ft,e.ccvmMap.item_lang)),b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.audience),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(18,ft,e.ccvmMap.audience))}}function bc(e,t){1&e&&b.Nb(0)}function dc(e,t){1&e&&b.Nb(0)}function hc(e,t){1&e&&b.Nb(0)}function fc(e,t){if(1&e&&(b.Rb(0,"option",5),b.Vb(1,Pt),b.Qb()),2&e){const e=t.$implicit,c=b.hc(4);b.pc("value",e.id()),b.xb(1),b.Zb(e.name())(c.orgName(e.owning_lib())),b.Wb(1)}}function uc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",82),b.Rb(1,"div",83),b.Rb(2,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.vr_format=t})),b.Rb(3,"option",36),b.Vb(4,Mt),b.Qb(),b.Kc(5,bc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(6,"div",83),b.Rb(7,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.bib_level=t})),b.Rb(8,"option",36),b.Vb(9,Nt),b.Qb(),b.Kc(10,dc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(11,"div",83),b.Rb(12,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.ccvmFilters.lit_form=t})),b.Rb(13,"option",36),b.Vb(14,Ot),b.Qb(),b.Kc(15,hc,1,0,"ng-container",75),b.Qb(),b.Qb(),b.Rb(16,"div",83),b.Rb(17,"select",84),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.copyLocations=t})),b.Rb(18,"option",36),b.Vb(19,zt),b.Qb(),b.Kc(20,fc,2,3,"option",4),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(3),t=b.zc(1);b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.vr_format),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(11,ft,e.ccvmMap.vr_format)),b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.bib_level),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(13,ft,e.ccvmMap.bib_level)),b.xb(2),b.oc("ngModel",e.context.termSearch.ccvmFilters.lit_form),b.xb(3),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(15,ft,e.ccvmMap.lit_form)),b.xb(2),b.oc("ngModel",e.context.termSearch.copyLocations),b.xb(3),b.oc("ngForOf",e.copyLocations)}}function gc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"input",92),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(4).context.termSearch.date2=t})),b.Qb()}if(2&e){const e=b.hc(4);b.oc("ngModel",e.context.termSearch.date2)}}function pc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",82),b.Rb(1,"div",24),b.Rb(2,"div",85),b.Rb(3,"label",86),b.Vb(4,Lt),b.Qb(),b.Rb(5,"select",87),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.dateOp=t})),b.Rb(6,"option",88),b.Vb(7,At),b.Qb(),b.Rb(8,"option",89),b.Vb(9,Bt),b.Qb(),b.Rb(10,"option",90),b.Vb(11,Et),b.Qb(),b.Rb(12,"option",91),b.Vb(13,Dt),b.Qb(),b.Qb(),b.Rb(14,"input",92),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(3).context.termSearch.date1=t})),b.Qb(),b.Kc(15,gc,1,1,"input",93),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(3);b.xb(5),b.oc("ngModel",e.context.termSearch.dateOp),b.xb(9),b.oc("ngModel",e.context.termSearch.date1),b.xb(1),b.oc("ngIf","between"==e.context.termSearch.dateOp)}}function mc(e,t){if(1&e){const e=b.Sb();b.Kc(0,_t,45,15,"div",33),b.Rb(1,"div",23),b.Rb(2,"div",34),b.Rb(3,"select",35),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.sort=t})),b.Rb(4,"option",36),b.Vb(5,Le),b.Qb(),b.Rb(6,"optgroup",37),b.Xb(7,Ae),b.Rb(8,"option",38),b.Vb(9,Be),b.Qb(),b.Rb(10,"option",39),b.Vb(11,Ee),b.Qb(),b.Qb(),b.Rb(12,"optgroup",37),b.Xb(13,De),b.Rb(14,"option",40),b.Vb(15,Fe),b.Qb(),b.Rb(16,"option",41),b.Vb(17,Ve),b.Qb(),b.Qb(),b.Rb(18,"optgroup",37),b.Xb(19,Ke),b.Rb(20,"option",42),b.Vb(21,Xe),b.Qb(),b.Rb(22,"option",43),b.Vb(23,Ge),b.Qb(),b.Qb(),b.Rb(24,"optgroup",37),b.Xb(25,He),b.Rb(26,"option",44),b.Vb(27,qe),b.Qb(),b.Rb(28,"option",45),b.Vb(29,Ue),b.Qb(),b.Qb(),b.Qb(),b.Rb(30,"div",46),b.Rb(31,"label"),b.Rb(32,"input",47),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.termSearch.available=t})),b.Qb(),b.Rb(33,"span",48),b.Vb(34,je),b.Qb(),b.Qb(),b.Qb(),b.Rb(35,"div",49),b.Rb(36,"label"),b.Rb(37,"input",47),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.termSearch.groupByMetarecord=t})),b.Qb(),b.Rb(38,"span",48),b.Vb(39,Ye),b.Qb(),b.Qb(),b.Qb(),b.Rb(40,"div",49),b.Rb(41,"label"),b.Rb(42,"input",47),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.global=t})),b.Qb(),b.Rb(43,"span",48),b.Vb(44,We),b.Qb(),b.Qb(),b.Qb(),b.Kc(45,oc,5,1,"div",50),b.Qb(),b.Qb(),b.Kc(46,lc,21,20,"div",51),b.Kc(47,uc,21,17,"div",51),b.Kc(48,pc,16,3,"div",51)}if(2&e){const e=b.hc(2);b.oc("ngForOf",e.context.termSearch.query)("ngForTrackBy",e.trackByIdx),b.xb(3),b.oc("ngModel",e.context.sort),b.xb(29),b.oc("ngModel",e.context.termSearch.available),b.xb(5),b.oc("ngModel",e.context.termSearch.groupByMetarecord),b.xb(5),b.oc("ngModel",e.context.global),b.xb(3),b.oc("ngIf",e.showExcludeElectronic()),b.xb(1),b.oc("ngIf",e.showFilters()),b.xb(1),b.oc("ngIf",e.showFilters()),b.xb(1),b.oc("ngIf",e.showFilters())}}function Rc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",94),b.Rb(1,"div",24),b.Rb(2,"div",85),b.Rb(3,"label",95),b.Vb(4,Ft),b.Qb(),b.Rb(5,"select",96),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.identSearch.queryType=t})),b.Rb(6,"option",97),b.Vb(7,Vt),b.Qb(),b.Rb(8,"option",98),b.Vb(9,Kt),b.Qb(),b.Rb(10,"option",99),b.Vb(11,Xt),b.Qb(),b.Rb(12,"option",100),b.Vb(13,Gt),b.Qb(),b.Rb(14,"option",101),b.Vb(15,Ht),b.Qb(),b.Rb(16,"option",102),b.Vb(17,qt),b.Qb(),b.Qb(),b.Rb(18,"label",103),b.Vb(19,Ut),b.Qb(),b.Rb(20,"input",104),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.identSearch.value=t}))("keyup.enter",(function(){return b.Bc(e),b.hc(2).searchByForm()})),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(2);b.xb(5),b.oc("ngModel",e.context.identSearch.queryType),b.xb(15),b.oc("ngModel",e.context.identSearch.value)}}function yc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",106),b.Rb(1,"label",107),b.Vb(2,jt),b.Qb(),b.Rb(3,"input",108),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.index;return b.hc(3).context.marcSearch.tags[a]=c}))("keyup.enter",(function(){return b.Bc(e),b.hc(3).searchByForm()})),b.Qb(),b.Rb(4,"label",109),b.Vb(5,Yt),b.Qb(),b.Rb(6,"input",110),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.index;return b.hc(3).context.marcSearch.subfields[a]=c}))("keyup.enter",(function(){return b.Bc(e),b.hc(3).searchByForm()})),b.Qb(),b.Rb(7,"label",109),b.Vb(8,Wt),b.Qb(),b.Rb(9,"input",111),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.index;return b.hc(3).context.marcSearch.values[a]=c}))("keyup.enter",(function(){return b.Bc(e),b.hc(3).searchByForm()})),b.Qb(),b.Rb(10,"button",112),b.fc("click",(function(){b.Bc(e);const c=t.index;return b.hc(3).addMarcSearchRow(c+1)})),b.Rb(11,"span",11),b.Mc(12,"add_circle_outline"),b.Qb(),b.Qb(),b.Rb(13,"button",113),b.fc("click",(function(){b.Bc(e);const c=t.index;return b.hc(3).delMarcSearchRow(c)})),b.Rb(14,"span",11),b.Mc(15,"remove_circle_outline"),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=t.index,c=b.hc(3);b.xb(1),b.qc("for","marc-tag-",e,""),b.xb(2),b.qc("name","marc-tag-",e,""),b.pc("id",0==e?"first-marc-tag":""),b.oc("ngModel",c.context.marcSearch.tags[e]),b.xb(1),b.qc("for","marc-subfield-",e,""),b.xb(2),b.qc("name","marc-subfield-",e,""),b.oc("ngModel",c.context.marcSearch.subfields[e]),b.xb(1),b.qc("for","marc-value-",e,""),b.xb(2),b.qc("name","marc-value-",e,""),b.oc("ngModel",c.context.marcSearch.values[e]),b.xb(4),b.oc("disabled",c.context.marcSearch.values.length<2)}}function xc(e,t){if(1&e&&(b.Rb(0,"div",94),b.Rb(1,"div",24),b.Kc(2,yc,16,11,"div",105),b.Qb(),b.Qb()),2&e){const e=b.hc(2);b.xb(2),b.oc("ngForOf",e.context.marcSearch.values)("ngForTrackBy",e.trackByIdx)}}function vc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",94),b.Rb(1,"div",34),b.Rb(2,"label",114),b.Vb(3,Zt),b.Qb(),b.Rb(4,"select",115),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.browseSearch.fieldClass=t})),b.Rb(5,"option",57),b.Vb(6,Jt),b.Qb(),b.Rb(7,"option",59),b.Vb(8,ec),b.Qb(),b.Rb(9,"option",60),b.Vb(10,tc),b.Qb(),b.Rb(11,"option",61),b.Vb(12,cc),b.Qb(),b.Qb(),b.Rb(13,"label",116),b.Mc(14," starting with "),b.Qb(),b.Rb(15,"input",117),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.browseSearch.value=t}))("keyup.enter",(function(){return b.Bc(e),b.hc(2).searchByForm()})),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(2);b.xb(4),b.oc("ngModel",e.context.browseSearch.fieldClass),b.xb(11),b.oc("ngModel",e.context.browseSearch.value)}}function Cc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",94),b.Rb(1,"div",34),b.Rb(2,"label",118),b.Vb(3,ac),b.Qb(),b.Rb(4,"input",119),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).context.cnBrowseSearch.value=t}))("keyup.enter",(function(){return b.Bc(e),b.hc(2).searchByForm()})),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc(2);b.xb(4),b.oc("ngModel",e.context.cnBrowseSearch.value)}}function Qc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",12),b.Rb(1,"div",13),b.Rb(2,"ngb-tabset",14,15),b.fc("tabChange",(function(t){return b.Bc(e),b.hc().onTabChange(t)})),b.Rb(4,"ngb-tab",16),b.Xb(5,$e),b.Kc(6,mc,49,10,"ng-template",17),b.Qb(),b.Rb(7,"ngb-tab",18),b.Xb(8,we),b.Kc(9,Rc,21,2,"ng-template",17),b.Qb(),b.Rb(10,"ngb-tab",19),b.Xb(11,Me),b.Kc(12,xc,3,2,"ng-template",17),b.Qb(),b.Rb(13,"ngb-tab",20),b.Xb(14,Ne),b.Kc(15,vc,16,2,"ng-template",17),b.Qb(),b.Rb(16,"ngb-tab",21),b.Xb(17,Oe),b.Kc(18,Cc,5,1,"ng-template",17),b.Qb(),b.Qb(),b.Qb(),b.Rb(19,"div",22),b.Rb(20,"div",23),b.Rb(21,"div",24),b.Rb(22,"div",25),b.Rb(23,"div",26),b.Rb(24,"div",27),b.Rb(25,"eg-org-select",28),b.fc("onChange",(function(t){return b.Bc(e),b.hc().orgOnChange(t)})),b.Qb(),b.Rb(26,"button",29),b.fc("click",(function(){b.Bc(e);const t=b.hc();return t.context.pager.offset=0,t.searchByForm()})),b.Vb(27,ze),b.Qb(),b.Rb(28,"button",30),b.fc("click",(function(){return b.Bc(e),b.hc().context.reset()})),b.Vb(29,Pe),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(30,"div",31),b.Rb(31,"div",24),b.Mb(32,"eg-catalog-search-templates",32),b.Qb(),b.Qb(),b.Rb(33,"div",31),b.Rb(34,"div",24),b.Mb(35,"eg-catalog-basket-actions"),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(2),b.oc("activeId",e.searchTab),b.xb(23),b.oc("initialOrg",e.context.searchOrg)("placeholder","Library"),b.xb(1),b.oc("disabled",e.searchIsActive()),b.xb(2),b.oc("disabled",e.searchIsActive()),b.xb(4),b.oc("searchTab",e.searchTab)}}St=$localize`:␟66c623858fc7d390c823aab1eeab9ded320ddefc␟5614904407716642098:Exclude Electronic Resources`,Tt=$localize`:␟75a8764758a9473e94f1f76f034e559e726d994c␟8169449220694982439:All Item Types`,kt=$localize`:␟6b1fa6cb8111abf80ad3d1ba69e36b579989b282␟4842640262162637956:All Item Forms`,$t=$localize`:␟5432abf900845651738dcb0a1ea27a330a008696␟6993909835054714449:All Languages`,wt=$localize`:␟06220092f5040eb7c3d6e54265430c7d7ccfd7e8␟7205590655845335646:All Audiences`,Mt=$localize`:␟29a2dad75ceeb5aa0a1256329b274b6c7b383817␟4315136048474243677:All Video Formats`,Nt=$localize`:␟1f08880bdd729085f45635dfd25850726200e62e␟6802112529604770771:All Bib Levels`,Ot=$localize`:␟eeed8f8b22116a335862716d1c7ff931f33dc42e␟1706257715386386167:All Literary Forms`,zt=$localize`:␟cd450893b99bdd09c6fc350d45ef1839d27fbead␟8781798358723083129:All Copy Locations`,Pt=$localize`:␟7eea5f3dd570bac7f30ac94b858537923e163868␟7101915224114661423: ${"\ufffd0\ufffd"}:INTERPOLATION: (${"\ufffd1\ufffd"}:INTERPOLATION_1:) `,Lt=$localize`:␟31d1560dfb60c0e13f7d941c36e696e4a9653636␟6131485316916951527:Publication Year is`,At=$localize`:␟042e19e83bb0ac2511784ba391534466669c14bc␟9147046130713106935:Is`,Bt=$localize`:␟8785188e6c678b842fcb93b7392faf86db7ec676␟1218334388194408974:Before`,Et=$localize`:␟be2add3a3d9e4e2556b8f9048a15a9c0f00bf1ad␟6371576811194810854:After`,Dt=$localize`:␟198d65de380901ff29d34108069df1ae1c6e7a7e␟3890131054593067798:Between`,Ft=$localize`:␟9dfefbfdfc3edb3df3580f4b3ffd2177e5db2c3a␟8048107774628227659:Query Type`,Vt=$localize`:␟d579249e5fe296d2eb3d02d79cc19ebbca88ec1e␟8860567190320038063:ISBN`,Kt=$localize`:␟cfa278e1f8babd235d96f6a9819133103c2176de␟481971971557154380:UPC`,Xt=$localize`:␟f0aa76ad6166bb3f153b66300eb690f65c90bde7␟8147268666114840144:ISSN`,Gt=$localize`:␟ebafb73b5175ab6dc9a3e0dc055d8aa58f8636d4␟5729347704943251933:LCCN`,Ht=$localize`:␟6b444e4c7a12daf39ca80a482512c881d28ca4ef␟6143330778178833170:TCN`,qt=$localize`:␟1e12554886683414162ae15ea0338d3391ebfb42␟865668397856791272:Item Barcode`,Ut=$localize`:␟5049e204c14c648691ac775a64fb504467aeb549␟6555318547274416232:Value`,jt=$localize`:␟337ca2e5eeea28eaca91e8511eb5eaafdb385ce6␟1825829511397926879:Tag`,Yt=$localize`:␟21ae0db95cdb830f6a9771bd0b6b2d62d85689cc␟8130366701056210024:Subfield`,Wt=$localize`:␟5049e204c14c648691ac775a64fb504467aeb549␟6555318547274416232:Value`,Zt=$localize`:␟1df7e8453edfc4975fd415cff55e6f4b093fdc01␟6871968110130773266:Browse for`,Jt=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`,ec=$localize`:␟d7293b61e9088c66421df2e367e0ccc00346cf9f␟7071470734400948493:Author`,tc=$localize`:␟4b0ca852bafa5037c4e64c7b18f9cd1e14b799de␟9127604588498960753:Subject`,cc=$localize`:␟f2602159bf76864fa86ee0cd8e1ce2370f27c88b␟7707176955005055131:Series`,ac=$localize`:␟b469d5f0d53f19950554bd3ccf026ef96250cca0␟5976382552788816081: Browse Call Numbers starting with `;const Ic={expert:"marc",numeric:"ident",advanced:"term"};let _c=(()=>{class e{constructor(e,t,c,a,o,i){this.renderer=e,this.router=t,this.route=c,this.org=a,this.cat=o,this.staffCat=i,this.ccvmMap={},this.cmfMap={},this.showSearchFilters=!1,this.showThyself=!0,this.orgOnChange=e=>{this.context.searchOrg=e,this.refreshCopyLocations()},this.copyLocations=[],this.route.queryParams.subscribe(e=>{e.searchTab&&(this.searchTab=e.searchTab)}),this.router.events.subscribe(e=>{e instanceof r.b&&(this.showThyself=!e.url.match(/catalog\/record/))})}ngOnInit(){this.ccvmMap=this.cat.ccvmMap,this.cmfMap=this.cat.cmfMap,this.context=this.staffCat.searchContext,this.showSearchFilters=this.filtersActive()}ngAfterViewInit(){setTimeout(()=>{""===this.context.identSearch.queryType&&(this.context.identSearch.queryType="identifier|isbn"),this.searchTab||(this.searchTab=this.context.marcSearch.isSearchable()?"marc":this.context.identSearch.isSearchable()?"ident":this.context.browseSearch.isSearchable()?"browse":this.context.termSearch.isSearchable()?"term":Ic[this.staffCat.defaultTab]||this.staffCat.defaultTab||"term","term"===this.searchTab&&this.refreshCopyLocations()),this.focusTabInput()})}onTabChange(e){this.searchTab=e.nextId,setTimeout(()=>this.focusTabInput())}focusTabInput(){let e;switch(this.searchTab){case"ident":e="#ident-query-input";break;case"marc":e="#first-marc-tag";break;case"browse":e="#browse-term-input";break;case"cnbrowse":e="#cnbrowse-term-input";break;default:this.refreshCopyLocations(),e="#first-query-input"}try{this.renderer.selectRootElement(e).focus()}catch(t){}}showFilters(){return this.showSearchFilters||this.filtersActive()}toggleFilters(){this.showSearchFilters=!this.showSearchFilters,this.refreshCopyLocations()}filtersActive(){if(""!==this.context.termSearch.copyLocations[0])return!0;let e=!1;return Object.keys(this.context.termSearch.ccvmFilters).forEach(t=>{""!==this.context.termSearch.ccvmFilters[t][0]&&(e=!0)}),e}refreshCopyLocations(){if(!this.showFilters())return;const e=this.context.searchOrg;e.id()!==this.org.root().id()?this.cat.fetchCopyLocations(e).then(()=>this.copyLocations=this.cat.copyLocations):this.copyLocations=[]}orgName(e){return this.org.get(e).shortname()}addSearchRow(e){this.context.termSearch.query.splice(e,0,""),this.context.termSearch.fieldClass.splice(e,0,"keyword"),this.context.termSearch.joinOp.splice(e,0,"&&"),this.context.termSearch.matchOp.splice(e,0,"contains")}delSearchRow(e){this.context.termSearch.query.splice(e,1),this.context.termSearch.fieldClass.splice(e,1),this.context.termSearch.joinOp.splice(e,1),this.context.termSearch.matchOp.splice(e,1)}addMarcSearchRow(e){this.context.marcSearch.tags.splice(e,0,""),this.context.marcSearch.subfields.splice(e,0,""),this.context.marcSearch.values.splice(e,0,"")}delMarcSearchRow(e){this.context.marcSearch.tags.splice(e,1),this.context.marcSearch.subfields.splice(e,1),this.context.marcSearch.values.splice(e,1)}searchByForm(){switch(this.context.pager.offset=0,this.context.showBasket=!1,this.context.scrub(this.searchTab),this.searchTab){case"term":case"ident":case"marc":this.staffCat.search();break;case"browse":this.staffCat.browse();break;case"cnbrowse":this.staffCat.cnBrowse()}}trackByIdx(e,t){return e}searchIsActive(){return this.context.searchState===g.c.SEARCHING}preventBogusCombos(e){if("keyword"===this.context.termSearch.fieldClass[e]){const t=this.context.termSearch.matchOp[e];"exact"!==t&&"starts"!==t||(this.context.termSearch.matchOp[e]="contains")}}showBookplate(){return this.staffCat.enableBookplates}showExcludeElectronic(){return this.staffCat.showExcludeElectronic}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(b.D),b.Lb(r.c),b.Lb(r.a),b.Lb(i.a),b.Lb(n.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-search-form"]],decls:5,vars:2,consts:[["ccvmOption",""],["id","staffcat-search-form"],["class","row pt-1 pb-1 mb-2 pr-2",4,"ngIf"],["class","row pt-3 pb-3 mb-3",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[4,"ngIf"],[1,"row","pt-1","pb-1","mb-2","pr-2"],[1,"col-lg-12","d-flex"],[1,"flex-1"],[1,"label-with-material-icon","no-href",3,"click"],[1,"material-icons"],[1,"row","pt-3","pb-3","mb-3"],[1,"col-lg-8"],[3,"activeId","tabChange"],["searchTabs",""],["id","term",6,"title"],["ngbTabContent",""],["id","ident",6,"title"],["id","marc",6,"title"],["id","browse",6,"title"],["id","cnbrowse",6,"title"],[1,"col-lg-4"],[1,"row"],[1,"col-lg-12"],[1,"card"],[1,"card-body"],[1,"float-right","d-flex"],[3,"initialOrg","placeholder","onChange"],["type","button",1,"btn","btn-success","mr-1","ml-1",3,"disabled","click"],["type","button",1,"btn","btn-warning","mr-1",3,"disabled","click"],[1,"row","mt-1"],[3,"searchTab"],["class","row",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-lg-12","form-inline"],[1,"form-control","mr-2",3,"ngModel","ngModelChange"],["value",""],[6,"label"],["value","titlesort"],["value","titlesort.descending"],["value","authorsort"],["value","authorsort.descending"],["value","pubdate"],["value","pubdate.descending"],["value","popularity"],["value","poprel"],[1,"checkbox","pl-2","ml-2","pt-2"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"pl-1"],[1,"checkbox","pl-3","pt-2"],["class","checkbox pl-3 pt-2",4,"ngIf"],["class","row mt-3",4,"ngIf"],[1,"row",3,"ngClass"],[1,"col-lg-2","pr-1"],[1,"col-lg-2","pl-0","pr-2"],[1,"form-control",3,"ngModel","change","ngModelChange"],["value","keyword"],["value","title"],["value","jtitle"],["value","author"],["value","subject"],["value","series"],["value","bookplate",4,"ngIf"],[1,"form-control",3,"ngModel","ngModelChange"],["value","contains"],["value","nocontains"],["value","phrase"],["value","exact",3,"disabled"],["value","starts",3,"disabled"],[1,"col-lg-4","pl-0","pr-2"],[1,"form-group"],[1,"col-lg-2","pl-0","pr-1"],[1,"btn","btn-sm","material-icon-button",3,"click",6,"title"],[1,"btn","btn-sm","material-icon-button",3,"disabled","click",6,"title"],["class","btn btn-sm material-icon-button","type","button",3,"click",4,"ngIf",6,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["value","&&"],["value","||"],["value","bookplate"],["type","text","id","first-query-input","placeholder","Query...",1,"form-control",3,"ngModel","ngModelChange","keyup.enter"],["type","text","placeholder","Query...",1,"form-control",3,"ngModel","ngModelChange","keyup.enter"],["type","button",1,"btn","btn-sm","material-icon-button",3,"click",6,"title"],[1,"row","mt-3"],[1,"col-lg-3"],["multiple","true",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-inline"],["for","pub-date1-input"],[1,"form-control","ml-2",3,"ngModel","ngModelChange"],["value","is"],["value","before"],["value","after"],["value","between"],["type","number",1,"form-control","ml-2",3,"ngModel","ngModelChange"],["class","form-control ml-2","type","number",3,"ngModel","ngModelChange",4,"ngIf"],[1,"row","mt-4"],["for","ident-type"],["name","ident-type",1,"form-control","ml-2",3,"ngModel","ngModelChange"],["value","identifier|isbn"],["value","identifier|upc"],["value","identifier|issn"],["value","identifier|lccn"],["value","identifier|tcn"],["value","item_barcode"],["for","ident-value",1,"ml-2"],["name","ident-value","id","ident-query-input","type","text","placeholder","Numeric Query...",1,"form-control","ml-2",3,"ngModel","ngModelChange","keyup.enter"],["class","form-inline mt-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form-inline","mt-2"],[3,"for"],["size","3","type","text",1,"form-control","ml-2",3,"name","id","ngModel","ngModelChange","keyup.enter"],[1,"ml-2",3,"for"],["size","1","type","text",1,"form-control","ml-2",3,"name","ngModel","ngModelChange","keyup.enter"],["type","text",1,"form-control","ml-2",3,"name","ngModel","ngModelChange","keyup.enter"],[1,"btn","btn-sm","material-icon-button","ml-2",3,"click"],[1,"btn","btn-sm","material-icon-button","ml-2",3,"disabled","click"],["for","field-class"],["name","field-class",1,"form-control","ml-2",3,"ngModel","ngModelChange"],["for","query",1,"ml-2"],["type","text","id","browse-term-input","name","query","placeholder","Browse for...",1,"form-control","ml-2",3,"ngModel","ngModelChange","keyup.enter"],["for","cnbrowse-term-input"],["type","text","id","cnbrowse-term-input","name","query","placeholder","Browse Call Numbers...",1,"form-control","ml-2",3,"ngModel","ngModelChange","keyup.enter"]],template:function(e,t){1&e&&(b.Kc(0,Te,1,1,"ng-template",null,0,b.Lc),b.Rb(2,"div",1),b.Kc(3,ke,6,0,"div",2),b.Kc(4,Qc,36,6,"div",3),b.Qb()),2&e&&(b.xb(3),b.oc("ngIf",!t.showThyself),b.xb(1),b.oc("ngIf",t.showThyself))},directives:[u.v,u.u,p.y,p.I,m.W,m.T,m.U,R.a,re,Ce,p.F,p.t,p.w,p.a,u.s,u.C,p.c,p.G,p.z],styles:[".checkbox[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.1rem}select.form-control[_ngcontent-%COMP%]:not([size]):not([multiple]){padding:.355rem .55rem;height:2.2rem}#staffcat-search-form[_ngcontent-%COMP%]{border-radius:0 0 7px 7px;background-color:#f7f7f7;box-shadow:1px 2px 3px -1px rgba(0,0,0,.2)}#staffcat-search-form[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{border:3px}.tab-content[_ngcontent-%COMP%]{padding:5px;margin-top:25px;font-weight:700}"]}),e})();const Sc=["bannerText",$localize`:␟93df42f16268240c7618bc964dceac5105b3f4a8␟2551770919821310290:Staff Catalog`];var Tc,kc;function $c(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",2),b.Rb(2,"div",3),b.Rb(3,"span",4),b.bc(4,Tc),b.Mb(5,"a",5),b.Yb(),b.Qb(),b.Qb(),b.Rb(6,"div",6),b.Rb(7,"button",7),b.fc("click",(function(){return b.Bc(e),b.hc().clearHoldPatron()})),b.Vb(8,kc),b.Qb(),b.Qb(),b.Qb(),b.Ob()}if(2&e){const e=b.hc();b.xb(5),b.qc("href","/eg/staff/circ/patron/",e.holdForUser().id(),"/holds",b.Ec),b.Zb(e.holdForUser().family_name())(e.holdForUser().first_given_name()),b.Wb(4)}}Tc=$localize`:␟be114594b9bc68ecc077bffda0f630a979953bc9␟6590346929677091371: Placing hold for patron ${"\ufffd#5\ufffd"}:START_LINK: ${"\ufffd0\ufffd"}:INTERPOLATION:, ${"\ufffd1\ufffd"}:INTERPOLATION_1: ${"\ufffd/#5\ufffd"}:CLOSE_LINK:. `,kc=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`;let wc=(()=>{class e{constructor(e,t){this.basket=e,this.staffCat=t}ngOnInit(){this.staffCat.createContext()}holdForUser(){return this.staffCat.holdForUser}clearHoldPatron(){this.staffCat.holdForUser=null,this.staffCat.holdForBarcode=null}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(h.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["ng-component"]],decls:5,vars:1,consts:[[6,"bannerText"],[4,"ngIf"],[1,"row","border","border-info","mb-2","pt-1","pb-1"],[1,"col-lg-10","offset-lg-1","d-flex","justify-content-center"],[1,"mt-2"],[3,"href"],[1,"col-lg-1"],[1,"btn","btn-info","btn-sm",3,"click"]],template:function(e,t){1&e&&(b.Rb(0,"eg-staff-banner",0),b.Xb(1,Sc),b.Qb(),b.Kc(2,$c,9,3,"ng-container",1),b.Mb(3,"eg-catalog-search-form"),b.Mb(4,"router-outlet")),2&e&&(b.xb(2),b.oc("ngIf",t.holdForUser()))},directives:[f.a,u.v,_c,r.h],encapsulation:2}),e})();var Mc=c("XKii"),Nc=c("iA0r"),Oc=c("ayJW");const zc=["aria-label",$localize`:␟680d5c75b7fd8d37961083608b9fcdc4167b4c43␟4452427314943113135:Previous`],Pc=["aria-label",$localize`:␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`];var Lc;Lc=$localize`:␟eb98135e35af26a9a326ee69bd8ff104d36dd8ec␟2634265024545519524:(current)`;const Ac=function(e){return{active:e}};function Bc(e,t){if(1&e){const e=b.Sb();b.Rb(0,"li",1),b.Rb(1,"a",5),b.fc("click",(function(){b.Bc(e);const c=t.$implicit;return b.hc().setPage(c)})),b.Mc(2),b.Rb(3,"span",6),b.Vb(4,Lc),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=t.$implicit,c=b.hc();b.oc("ngClass",b.uc(2,Ac,c.searchContext.pager.currentPage()==e)),b.xb(2),b.Oc(" ",e," ")}}const Ec=function(e){return{disabled:e}};let Dc=(()=>{class e{constructor(e,t){this.cat=e,this.staffCat=t,this.numPages=10}ngOnInit(){this.searchContext=this.staffCat.searchContext}currentPageList(){const e=this.searchContext.pager;return e.pageRange(e.currentPage(),this.numPages)}nextPage(){this.searchContext.pager.increment(),this.staffCat.search()}prevPage(){this.searchContext.pager.decrement(),this.staffCat.search()}setPage(e){this.searchContext.pager.currentPage()!==e&&(this.searchContext.pager.setPage(e),this.staffCat.search())}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(n.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-result-pagination"]],inputs:{numPages:"numPages"},decls:12,vars:7,consts:[[1,"pagination"],[1,"page-item",3,"ngClass"],[1,"page-link",3,"click",6,"aria-label"],["aria-hidden","true"],["class","page-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"page-link",3,"click"],[1,"sr-only"]],template:function(e,t){1&e&&(b.Rb(0,"ul",0),b.Rb(1,"li",1),b.Rb(2,"a",2),b.Xb(3,zc),b.fc("click",(function(){return t.prevPage()})),b.Rb(4,"span",3),b.Mc(5,"\xab"),b.Qb(),b.Qb(),b.Qb(),b.Kc(6,Bc,5,4,"li",4),b.Rb(7,"li",1),b.Rb(8,"a",2),b.Xb(9,Pc),b.fc("click",(function(){return t.nextPage()})),b.Rb(10,"span",3),b.Mc(11,"\xbb"),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.xb(1),b.oc("ngClass",b.uc(3,Ec,t.searchContext.pager.isFirstPage())),b.xb(5),b.oc("ngForOf",t.currentPageList()),b.xb(1),b.oc("ngClass",b.uc(5,Ec,t.searchContext.pager.isLastPage())))},directives:[u.s,u.u],styles:[".pagination[_ngcontent-%COMP%]{margin:0}.pagination[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(.active)   a[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();const Fc=function(e){return{"facet-selected":e}};function Vc(e,t){if(1&e&&(b.Rb(0,"li",8),b.Rb(1,"div",3),b.Rb(2,"div",9),b.Rb(3,"a",10),b.Mc(4),b.Qb(),b.Qb(),b.Rb(5,"div",11),b.Mc(6),b.Qb(),b.Qb(),b.Qb()),2&e){const e=t.$implicit,c=b.hc(2).$implicit,a=b.hc(2).$implicit,o=b.hc(2);b.oc("ngClass",b.uc(4,Fc,o.facetIsApplied(a.facetClass,c,e.value))),b.xb(3),b.oc("queryParams",o.getFacetUrlParams(a.facetClass,c,e.value)),b.xb(1),b.Oc(" ",e.value," "),b.xb(2),b.Nc(e.count)}}function Kc(e,t){if(1&e&&(b.Rb(0,"div",3),b.Rb(1,"div",4),b.Rb(2,"h4",5),b.Mc(3),b.Qb(),b.Rb(4,"ul",6),b.Kc(5,Vc,7,6,"li",7),b.ic(6,"slice"),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc().$implicit,t=b.hc(2).$implicit,c=b.hc(2);b.xb(3),b.Oc(" ",c.searchContext.result.facetData[t.facetClass][e].cmfLabel," "),b.xb(2),b.oc("ngForOf",b.lc(6,2,c.searchContext.result.facetData[t.facetClass][e].valueList,0,c.facetConfig.displayCount))}}function Xc(e,t){if(1&e&&(b.Rb(0,"div"),b.Kc(1,Kc,7,6,"div",2),b.Qb()),2&e){const e=t.$implicit,c=b.hc(2).$implicit,a=b.hc(2);b.xb(1),b.oc("ngIf",a.searchContext.result.facetData[c.facetClass][e])}}function Gc(e,t){if(1&e&&(b.Rb(0,"div"),b.Kc(1,Xc,2,1,"div",1),b.Qb()),2&e){const e=b.hc().$implicit;b.xb(1),b.oc("ngForOf",e.facetOrder)}}function Hc(e,t){if(1&e&&(b.Rb(0,"div"),b.Kc(1,Gc,2,1,"div",0),b.Qb()),2&e){const e=t.$implicit,c=b.hc(2);b.xb(1),b.oc("ngIf",c.searchContext.result.facetData[e.facetClass])}}function qc(e,t){if(1&e&&(b.Rb(0,"div"),b.Kc(1,Hc,2,1,"div",1),b.Qb()),2&e){const e=b.hc();b.xb(1),b.oc("ngForOf",e.facetConfig.display)}}const Uc={display:[{facetClass:"author",facetOrder:["personal","corporate"]},{facetClass:"subject",facetOrder:["topic"]},{facetClass:"identifier",facetOrder:["genre"]},{facetClass:"series",facetOrder:["seriestitle"]},{facetClass:"subject",facetOrder:["name","geographic"]}],displayCount:5};let jc=(()=>{class e{constructor(e,t,c){this.cat=e,this.catUrl=t,this.staffCat=c,this.facetConfig=Uc}ngOnInit(){this.searchContext=this.staffCat.searchContext}facetIsApplied(e,t,c){return this.searchContext.termSearch.hasFacet(new g.d(e,t,c))}getFacetUrlParams(e,t,c){const a=this.staffCat.cloneContext(this.searchContext);return a.termSearch.toggleFacet(new g.d(e,t,c)),a.pager.offset=0,this.catUrl.toUrlParams(a)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(n.a),b.Lb(s.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-result-facets"]],decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[1,"row"],[1,"card","mb-2"],[1,"card-header"],[1,"list-group","list-group-flush"],["class","list-group-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"list-group-item",3,"ngClass"],[1,"col-lg-9"],["routerLink","/staff/catalog/search",1,"card-link",3,"queryParams"],[1,"col-lg-3"]],template:function(e,t){1&e&&b.Kc(0,qc,2,1,"div",0),2&e&&b.oc("ngIf",t.searchContext.result.facetData)},directives:[u.v,u.u,u.s,r.f],pipes:[u.G],styles:[".facet-selected[_ngcontent-%COMP%] {\n    background-color: #DDD;\n  }\n  .card[_ngcontent-%COMP%] {\n    width: 100%;\n  }\n  .list-group-item[_ngcontent-%COMP%] {padding: .5rem .75rem .5rem .75rem}"]}),e})();var Yc,Wc,Zc,Jc,ea,ta,ca,aa,oa=c("+MQy"),ra=c("RXDw");function ia(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"a",13),b.Mb(2,"img",22),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.oc("queryParams",e.appendFromMrParam(e.summary)),b.xb(1),b.qc("src","/opac/extras/ac/jacket/medium/r/",e.summary.id,"",b.Ec)}}function na(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"a",23),b.Mb(2,"img",22),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.qc("routerLink","/staff/catalog/record/",e.summary.id,""),b.oc("queryParams",e.currentParams()),b.xb(1),b.qc("src","/opac/extras/ac/jacket/medium/r/",e.summary.id,"",b.Ec)}}function sa(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",24),b.Mc(2),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(2),b.Rc(" ",e.callNumber.prefix().label()," ",e.callNumber.label()," ",e.callNumber.suffix().label()," @ ",e.orgName(e.callNumber.owning_lib())," ")}}function la(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"a",13),b.Mb(2,"eg-bib-display-field",25),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.oc("queryParams",e.appendFromMrParam(e.summary)),b.xb(1),b.oc("summary",e.summary)("usePlaceholder",!0)}}function ba(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"a",23),b.Mb(2,"eg-bib-display-field",25),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.qc("routerLink","/staff/catalog/record/",e.summary.id,""),b.oc("queryParams",e.currentParams()),b.xb(1),b.oc("summary",e.summary)("usePlaceholder",!0)}}function da(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"span",27),b.Mb(2,"img",28),b.Rb(3,"span"),b.Mc(4),b.Qb(),b.Qb(),b.Ob()),2&e){const e=t.$implicit,c=b.hc(2);b.xb(2),b.qc("src","/images/format_icons/icon_format/",e,".png",b.Ec),b.xb(2),b.Nc(c.iconFormatLabel(e))}}function ha(e,t){if(1&e&&(b.Pb(0),b.Kc(1,da,5,2,"ng-container",26),b.Ob()),2&e){const e=b.hc();b.xb(1),b.oc("ngForOf",e.summary.attributes.icon_format)}}function fa(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",29),b.bc(2,Yc),b.Mb(3,"eg-bib-display-field",30),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("summary",e.summary)}}function ua(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",29),b.bc(2,Wc),b.Mb(3,"eg-bib-display-field",31),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("summary",e.summary)}}function ga(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",29),b.bc(2,Zc),b.Mb(3,"eg-bib-display-field",34),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc(2);b.xb(3),b.oc("summary",e.summary)}}function pa(e,t){if(1&e&&(b.Rb(0,"div",29),b.bc(1,Jc),b.Mb(2,"eg-bib-display-field",35),b.Yb(),b.Qb()),2&e){const e=b.hc(2);b.xb(2),b.oc("summary",e.summary)}}function ma(e,t){if(1&e&&(b.Pb(0),b.Kc(1,ga,4,1,"ng-container",32),b.Kc(2,pa,3,1,"ng-template",null,33,b.Lc),b.Ob()),2&e){const e=b.zc(3),t=b.hc();b.xb(1),b.oc("ngIf",t.summary.display.publisher)("ngIfElse",e)}}function Ra(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",29),b.bc(2,ea),b.Mb(3,"eg-bib-display-field",36),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("summary",e.summary)}}function ya(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",29),b.bc(2,ta),b.Mb(3,"eg-bib-display-field",37),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("summary",e.summary)}}function xa(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div"),b.bc(2,ca),b.Mb(3,"eg-bib-display-field",38),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("summary",e.summary)}}function va(e,t){if(1&e&&(b.bc(0,aa,1),b.Rb(1,"span"),b.Mb(2,"a",39),b.Qb(),b.Yb()),2&e){const e=t.$implicit,c=t.last;b.xb(2),b.qc("routerLink","/staff/admin/local/asset/course_list/",e.id(),""),b.Zb(e.name())(e.course_number())(c?"":", "),b.Wb(0)}}function Ca(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div"),b.bc(2,aa),b.Kc(3,va,3,4,"span",26),b.Yb(),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(3),b.oc("ngForOf",e.courses)}}Yc=$localize`:␟aaf88419098f2f824350299750ff2469fc4b670b␟5369485958442419491:Phys. Desc.: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,Wc=$localize`:␟847d9eea0921c596b62111e5dfc199ab3aea61d3␟8992033074649446754:Edition: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,Zc=$localize`:␟29a81f4884543d6ced3de675f121b6342d85940f␟8586958906227719625:Publisher: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,Jc=$localize`:␟a7d43cdf60988e9068205b86b55a4292b7b6b815␟6306398049346640452:Pub Date: ${"\ufffd#2\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#2\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,ea=$localize`:␟3a4251e3cc271dfc42657b20d617dc37fc81d588␟2361044151971010973:ISBN: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,ta=$localize`:␟4799bce797a6f90b57eacc2aa55ea1e8060a0a6b␟2669141259567340051:UPC: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,ca=$localize`:␟c5d9d2c0732c5716a366312b200c01e0c0399f00␟5735544153935476140:ISSN: ${"\ufffd#3\ufffd"}:START_TAG_EG_BIB_DISPLAY_FIELD:${"\ufffd/#3\ufffd"}:CLOSE_TAG_EG_BIB_DISPLAY_FIELD:`,aa=$localize`:␟f334b791c1bf2785267b60590ceabbb69c6f6f73␟6772447970859188136:Associated Courses: ${"\ufffd*3:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_SPAN:${"\ufffd#2:1\ufffd"}:START_LINK: ${"\ufffd0:1\ufffd"}:INTERPOLATION: (${"\ufffd1:1\ufffd"}:INTERPOLATION_1:) ${"\ufffd/#2:1\ufffd"}:CLOSE_LINK:${"\ufffd2:1\ufffd"}:INTERPOLATION_2: ${"\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd"}:CLOSE_TAG_SPAN:`;const Qa=function(e){return{"pt-2":e}};function Ia(e,t){if(1&e&&(b.Rb(0,"div",40),b.Rb(1,"div",41),b.Rb(2,"span",27),b.Mc(3),b.Qb(),b.Qb(),b.Rb(4,"div",42),b.Mc(5),b.Qb(),b.Qb()),2&e){const e=t.$implicit,c=b.hc();b.oc("ngClass",b.uc(4,Qa,c.copyIndex>0)),b.xb(3),b.Pc(" ",e.available," / ",e.count," items "),b.xb(2),b.Oc(" @ ",c.orgName(e.org_unit)," ")}}function _a(e,t){if(1&e&&(b.Rb(0,"a",43),b.Mc(1),b.Qb()),2&e){const e=b.hc();b.qc("href","/eg/staff/circ/patron/",e.summary.record.creator().id(),"/checkout",b.Ec),b.xb(1),b.Oc(" ",e.summary.record.creator().usrname()," ")}}function Sa(e,t){1&e&&(b.Rb(0,"span"),b.Mc(1," ... "),b.Qb())}function Ta(e,t){if(1&e&&(b.bc(0,ka,1),b.Mb(1,"a",43),b.Yb()),2&e){const e=b.hc();b.xb(1),b.qc("href","/eg/staff/circ/patron/",e.summary.record.editor().id(),"/checkout",b.Ec),b.Zb(e.summary.record.editor().usrname()),b.Wb(0)}}var ka,$a,wa;function Ma(e,t){1&e&&(b.bc(0,ka,2),b.Mb(1,"span"),b.Yb())}function Na(e,t){1&e&&(b.Pb(0),b.Rb(1,"span",44),b.Vb(2,$a),b.Qb(),b.Ob())}function Oa(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"span"),b.Rb(2,"button",45),b.fc("click",(function(){return b.Bc(e),b.hc().placeHold()})),b.Rb(3,"span",46),b.Mc(4,"check"),b.Qb(),b.Rb(5,"span"),b.Vb(6,wa),b.Qb(),b.Qb(),b.Qb(),b.Ob()}}ka=$localize`:␟3b8b60757e2b15ee45751ac70533ea89f095f7b4␟2165628872509841455: Edited ${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd*55:1\ufffd\ufffd#1:1\ufffd"}:START_LINK: ${"\ufffd0:1\ufffd"}:INTERPOLATION_1: ${"\ufffd/#1:1\ufffd\ufffd/*55:1\ufffd"}:CLOSE_LINK:${"\ufffd*56:2\ufffd\ufffd#1:2\ufffd"}:START_TAG_SPAN: ... ${"\ufffd/#1:2\ufffd\ufffd/*56:2\ufffd"}:CLOSE_TAG_SPAN:`,$a=$localize`:␟3d3c2661b7b68182d21dc842ad6f797f7ae3695a␟989472037369554228:(Deleted)`,wa=$localize`:␟a8d2c33741ffac33baa5034038c0ada021156cfe␟133993343914853660:Place Hold`;let za=(()=>{class e{constructor(e,t,c,a,o,r,i){this.router=e,this.org=t,this.cat=c,this.catUrl=a,this.staffCat=o,this.basket=r,this.course=i,this.hasCourse=!1,this.courses=[]}ngOnInit(){this.searchContext=this.staffCat.searchContext,this.loadCourseInformation(this.summary.id),this.isRecordSelected=this.basket.hasRecordId(this.summary.id),this.basketSub=this.basket.onChange.subscribe(()=>{this.isRecordSelected=this.basket.hasRecordId(this.summary.id)})}ngOnDestroy(){this.basketSub.unsubscribe()}loadCourseInformation(e){this.course.isOptedIn().then(t=>{t&&this.course.fetchCoursesForRecord(e).then(e=>{e&&(Object.keys(e).forEach(t=>{this.courses.push(e[t])}),this.hasCourse=!0)})})}orgName(e){return this.org.get(e).shortname()}iconFormatLabel(e){return this.cat.iconFormatLabel(e)}placeHold(){let e="T",t=this.summary.id;this.searchContext.termSearch.isMetarecordSearch()&&(e="M",t=this.summary.metabibId),this.router.navigate(["/staff/catalog/hold/"+e],{queryParams:{target:t}})}addToList(){alert("Adding to list for bib "+this.summary.id)}getAuthorSearchParams(e){return this.staffCat.getAuthorSearchParams(e)}appendFromMrParam(e){const t=this.staffCat.cloneContext(this.searchContext);return t.termSearch.fromMetarecord=e.metabibId,this.catUrl.toUrlParams(t)}hasMrConstituentRecords(e){return e.metabibId&&e.metabibRecords.length>1}currentParams(){return this.catUrl.toUrlParams(this.searchContext)}toggleBasketEntry(){return this.isRecordSelected?this.basket.addRecordIds([this.summary.id]):this.basket.removeRecordIds([this.summary.id])}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(i.a),b.Lb(n.a),b.Lb(s.a),b.Lb(d),b.Lb(h.a),b.Lb(oa.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-result-record"]],inputs:{index:"index",summary:"summary",callNumber:"callNumber"},decls:62,vars:35,consts:[[1,"col-lg-12","card","tight-card","mb-2","bg-light"],[1,"card-body"],[1,"row"],[1,"col-lg-7","d-flex"],[1,"checkbox"],[1,"font-weight-bold","font-italic"],["type","checkbox",1,"pl-1",3,"ngModel","ngModelChange","change"],[1,"pl-2","record-jacket-div"],[4,"ngIf"],[1,"flex-1","pl-2"],[1,"col-lg-12","font-weight-bold"],[1,"row","pt-2"],[1,"col-lg-12"],["routerLink","/staff/catalog/search",3,"queryParams"],["field","author",3,"summary","usePlaceholder"],[1,"col-lg-2"],["class","row",3,"ngClass",4,"ngFor","ngForOf"],[1,"col-lg-1"],[1,"w-100"],[1,"float-right","small-text-1"],["target","_self",3,"href",4,"ngIf"],[1,"float-right"],[3,"src"],[3,"routerLink","queryParams"],[1,"pl-2","font-weight-bold"],["field","title",3,"summary","usePlaceholder"],[4,"ngFor","ngForOf"],[1,"pr-1"],[1,"pr-1",3,"src"],[1,"pb-1"],["field","physical_description","joiner",",",3,"summary"],["field","edition","joiner",",",3,"summary"],[4,"ngIf","ngIfElse"],["pubDate",""],["field","publisher",3,"summary"],["field","pubdate",3,"summary"],["field","isbn","joiner",",",3,"summary"],["field","upc","joiner",",",3,"summary"],["field","issn","joiner",",",3,"summary"],[3,"routerLink"],[1,"row",3,"ngClass"],[1,"float-left","text-left","w-50"],[1,"float-left","w-50"],["target","_self",3,"href"],[1,"text-danger"],[1,"btn","btn-sm","btn-success","label-with-material-icon","small-text-1",3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Rb(3,"div",3),b.Rb(4,"label",4),b.Rb(5,"span",5),b.Mc(6),b.Qb(),b.Rb(7,"input",6),b.fc("ngModelChange",(function(e){return t.isRecordSelected=e}))("change",(function(){return t.toggleBasketEntry()})),b.Qb(),b.Qb(),b.Rb(8,"div",7),b.Kc(9,ia,3,2,"ng-container",8),b.Kc(10,na,3,3,"ng-container",8),b.Qb(),b.Kc(11,sa,3,4,"ng-container",8),b.Rb(12,"div",9),b.Rb(13,"div",2),b.Rb(14,"div",10),b.Kc(15,la,3,3,"ng-container",8),b.Kc(16,ba,3,4,"ng-container",8),b.Qb(),b.Qb(),b.Rb(17,"div",11),b.Rb(18,"div",12),b.Rb(19,"a",13),b.Mb(20,"eg-bib-display-field",14),b.Qb(),b.Qb(),b.Qb(),b.Rb(21,"div",11),b.Rb(22,"div",12),b.Kc(23,ha,2,1,"ng-container",8),b.Qb(),b.Qb(),b.Rb(24,"div",11),b.Rb(25,"div",12),b.Kc(26,fa,4,1,"ng-container",8),b.Kc(27,ua,4,1,"ng-container",8),b.Kc(28,ma,4,2,"ng-container",8),b.Kc(29,Ra,4,1,"ng-container",8),b.Kc(30,ya,4,1,"ng-container",8),b.Kc(31,xa,4,1,"ng-container",8),b.Kc(32,Ca,4,1,"ng-container",8),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(33,"div",15),b.Kc(34,Ia,6,6,"div",16),b.Qb(),b.Rb(35,"div",17),b.Rb(36,"div",2),b.Rb(37,"div",18),b.Mc(38),b.Qb(),b.Qb(),b.Rb(39,"div",2),b.Rb(40,"div",18),b.Mc(41),b.Qb(),b.Qb(),b.Qb(),b.Rb(42,"div",15),b.Rb(43,"div",2),b.Rb(44,"div",12),b.Rb(45,"div",19),b.Mc(46),b.ic(47,"date"),b.Kc(48,_a,2,2,"a",20),b.Kc(49,Sa,2,0,"span",8),b.Qb(),b.Qb(),b.Qb(),b.Rb(50,"div",11),b.Rb(51,"div",12),b.Rb(52,"div",19),b.bc(53,ka),b.ic(54,"date"),b.Kc(55,Ta,2,2,"a",20),b.Kc(56,Ma,2,0,"span",8),b.Yb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(57,"div",11),b.Rb(58,"div",12),b.Rb(59,"div",21),b.Kc(60,Na,3,0,"ng-container",8),b.Kc(61,Oa,7,0,"ng-container",8),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.xb(6),b.Oc(" ",t.index+1+t.searchContext.pager.offset,". "),b.xb(1),b.oc("ngModel",t.isRecordSelected),b.xb(2),b.oc("ngIf",t.hasMrConstituentRecords(t.summary)),b.xb(1),b.oc("ngIf",!t.hasMrConstituentRecords(t.summary)),b.xb(1),b.oc("ngIf",t.callNumber),b.xb(4),b.oc("ngIf",t.hasMrConstituentRecords(t.summary)),b.xb(1),b.oc("ngIf",!t.hasMrConstituentRecords(t.summary)),b.xb(3),b.oc("queryParams",t.getAuthorSearchParams(t.summary)),b.xb(1),b.oc("summary",t.summary)("usePlaceholder",!0),b.xb(3),b.oc("ngIf",t.summary.attributes.icon_format&&t.summary.attributes.icon_format[0]),b.xb(3),b.oc("ngIf",t.summary.display.physical_description),b.xb(1),b.oc("ngIf",t.summary.display.edition),b.xb(1),b.oc("ngIf",t.summary.display.publisher||t.summary.display.pubdate),b.xb(1),b.oc("ngIf",t.summary.display.isbn),b.xb(1),b.oc("ngIf",t.summary.display.upc),b.xb(1),b.oc("ngIf",t.summary.display.issn),b.xb(1),b.oc("ngIf",t.hasCourse),b.xb(2),b.oc("ngForOf",t.summary.holdingsSummary),b.xb(4),b.Oc(" TCN: ",t.summary.record.tcn_value()," "),b.xb(3),b.Oc(" Holds: ",t.summary.holdCount," "),b.xb(5),b.Oc(" Created ",b.kc(47,29,t.summary.record.create_date(),"shortDate")," by "),b.xb(2),b.oc("ngIf",t.summary.record.creator().usrname),b.xb(1),b.oc("ngIf",!t.summary.record.creator().usrname),b.xb(6),b.oc("ngIf",t.summary.record.editor().usrname),b.xb(1),b.oc("ngIf",!t.summary.record.editor().usrname),b.Zb(b.kc(54,32,t.summary.record.edit_date(),"shortDate")),b.Wb(53),b.xb(4),b.oc("ngIf","t"==t.summary.record.deleted()),b.xb(1),b.oc("ngIf","f"==t.summary.record.deleted()))},directives:[p.a,p.t,p.w,u.v,r.f,ra.a,u.u,u.s],pipes:[u.f],styles:[".record-jacket-div[_ngcontent-%COMP%]{width:120px}.record-jacket-div[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;max-height:158px;max-width:100px}"]}),e})();const Pa=["prefix",$localize`:␟25ce0a27b312c4dec7da2cefa12ccd5227f9e8eb␟3084484714683041513:Catalog Search - ${"\ufffd0\ufffd"}:INTERPOLATION: Results`];function La(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"eg-title",3),b.Xb(2,Pa),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.Zb(e.searchContext.result.count),b.Wb(2)}}const Aa=["prefix",$localize`:␟0fddb347997622ca3dbb74499aab731c8537ad2c␟5683677427011567244:Catalog Search`];function Ba(e,t){1&e&&(b.Pb(0),b.Rb(1,"eg-title",3),b.Xb(2,Aa),b.Qb(),b.Ob())}var Ea,Da,Fa,Va,Ka,Xa;function Ga(e,t){1&e&&(b.Rb(0,"div",4),b.Rb(1,"div",5),b.Rb(2,"div",6),b.Rb(3,"div",7),b.Rb(4,"span",8),b.Vb(5,Ea),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}function Ha(e,t){1&e&&(b.Rb(0,"div"),b.Rb(1,"div",9),b.Rb(2,"div",10),b.Rb(3,"div",11),b.Rb(4,"span"),b.Vb(5,Da),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}function qa(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"h3"),b.Vb(2,Fa),b.Qb(),b.Ob()),2&e){const e=b.hc(3);b.xb(2),b.Zb(e.searchContext.termSearch.browseEntry.value()),b.Wb(2)}}function Ua(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"h3"),b.Vb(2,Va),b.Qb(),b.Ob()),2&e){const e=b.hc(3);b.xb(2),b.Zb(e.searchContext.result.count),b.Wb(2)}}function ja(e,t){if(1&e&&(b.Rb(0,"div",14),b.Kc(1,qa,3,1,"ng-container",0),b.Kc(2,Ua,3,1,"ng-container",0),b.Qb()),2&e){const e=b.hc(2);b.xb(1),b.oc("ngIf",e.searchContext.termSearch.browseEntry),b.xb(1),b.oc("ngIf",!e.searchContext.termSearch.browseEntry)}}function Ya(e,t){1&e&&(b.Rb(0,"div",14),b.Rb(1,"h3"),b.Vb(2,Ka),b.Qb(),b.Qb())}function Wa(e,t){if(1&e){const e=b.Sb();b.Rb(0,"label",21),b.Rb(1,"input",22),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).allRecsSelected=t}))("change",(function(){return b.Bc(e),b.hc(2).toggleAllRecsSelected()})),b.Qb(),b.Rb(2,"span",23),b.Vb(3,Xa),b.Qb(),b.Qb()}if(2&e){const e=b.hc(2);b.xb(1),b.oc("ngModel",e.allRecsSelected),b.xb(2),b.Zb(e.searchContext.pager.rowNumber(0))(e.searchContext.pager.rowNumber(e.searchContext.currentResultIds().length-1)),b.Wb(3)}}function Za(e,t){1&e&&(b.Rb(0,"div",14),b.Mb(1,"eg-catalog-result-facets"),b.Qb())}function Ja(e,t){if(1&e&&(b.Rb(0,"div"),b.Mb(1,"eg-catalog-result-record",24),b.Qb()),2&e){const e=b.hc(),t=e.$implicit,c=e.index;b.xb(1),b.oc("summary",t)("index",c)}}function eo(e,t){if(1&e&&(b.Rb(0,"div"),b.Kc(1,Ja,2,2,"div",0),b.Qb()),2&e){const e=t.$implicit;b.xb(1),b.oc("ngIf",e)}}Ea=$localize`:␟ec967aea6202d50552ab385751214fcb816e7218␟3926189656918144187:Searching..`,Da=$localize`:␟6b90aaee4294ccb5e34a4413ebe3f4649d70167f␟5773175567567821732:No Maching Items Were Found`,Fa=$localize`:␟74a4c900878c6c1766e54fc55758dab4f8ef81b6␟874036780110482491:Results for browse "${"\ufffd0\ufffd"}:INTERPOLATION:"`,Va=$localize`:␟edbcb0b00cbfa5948da854f35ccd4288c3a3ddb0␟2460578430343548399:Search Results (${"\ufffd0\ufffd"}:INTERPOLATION:)`,Ka=$localize`:␟50d4691922d4d3907b665c0c719932bfca945a9d␟5794675761928643849:Basket View`,Xa=$localize`:␟427f84dcead8d82f9480dad2325b7e45ae553c3c␟689342868183390953:Select ${"\ufffd0\ufffd"}:INTERPOLATION: - ${"\ufffd1\ufffd"}:INTERPOLATION_1: `;const to=function(e,t){return{"col-lg-10":e,"col-lg-12":t}};function co(e,t){if(1&e&&(b.Rb(0,"div",12),b.Rb(1,"div",4),b.Kc(2,ja,3,2,"div",13),b.Kc(3,Ya,3,0,"div",13),b.Rb(4,"div",14),b.Kc(5,Wa,4,3,"label",15),b.Qb(),b.Rb(6,"div",16),b.Rb(7,"div",17),b.Mb(8,"eg-catalog-result-pagination"),b.Qb(),b.Qb(),b.Qb(),b.Rb(9,"div"),b.Rb(10,"div",18),b.Kc(11,Za,2,0,"div",13),b.Rb(12,"div",19),b.Kc(13,eo,2,1,"div",20),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc();b.xb(2),b.oc("ngIf",!e.searchContext.basket),b.xb(1),b.oc("ngIf",e.searchContext.basket),b.xb(2),b.oc("ngIf",!e.searchContext.basket),b.xb(6),b.oc("ngIf",!e.searchContext.basket),b.xb(1),b.oc("ngClass",b.vc(6,to,!e.searchContext.basket,e.searchContext.basket)),b.xb(1),b.oc("ngForOf",e.searchContext.result.records)}}let ao=(()=>{class e{constructor(e,t,c,a,o,r,i){this.route=e,this.pcrud=t,this.cat=c,this.bib=a,this.catUrl=o,this.staffCat=r,this.basket=i,this.userCache={}}ngOnInit(){this.searchContext=this.staffCat.searchContext,this.routeSub=this.route.queryParamMap.subscribe(e=>{this.searchByUrl(e)}),this.searchSub=this.cat.onSearchComplete.subscribe(e=>this.applyRecordSelection()),this.basketSub=this.basket.onChange.subscribe(()=>this.applyRecordSelection())}ngOnDestroy(){this.routeSub&&(this.routeSub.unsubscribe(),this.searchSub.unsubscribe(),this.basketSub.unsubscribe())}applyRecordSelection(){const e=this.searchContext.currentResultIds();let t=!0;e.forEach(e=>{this.basket.hasRecordId(e)||(t=!1)}),this.allRecsSelected=t}searchByUrl(e){this.catUrl.applyUrlParams(this.searchContext,e),this.searchContext.isSearchable()&&this.cat.search(this.searchContext).then(e=>{this.cat.fetchFacets(this.searchContext),this.cat.fetchBibSummaries(this.searchContext)})}searchIsDone(){return this.searchContext.searchState===g.c.COMPLETE}searchIsActive(){return this.searchContext.searchState===g.c.SEARCHING}searchHasResults(){return this.searchIsDone()&&this.searchContext.result.count>0}toggleAllRecsSelected(){const e=this.searchContext.currentResultIds();this.allRecsSelected?this.basket.addRecordIds(e):this.basket.removeRecordIds(e)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.a),b.Lb(Nc.a),b.Lb(n.a),b.Lb(Mc.a),b.Lb(s.a),b.Lb(d),b.Lb(h.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-results"]],decls:5,vars:5,consts:[[4,"ngIf"],["class","row",4,"ngIf"],["id","staff-catalog-results-container",4,"ngIf"],[6,"prefix"],[1,"row"],[1,"col-lg-6","offset-lg-3","pt-3"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","active","w-100"],[1,"sr-only"],[1,"row","pt-3"],[1,"col-lg-6","offset-lg-3"],[1,"alert","alert-warning"],["id","staff-catalog-results-container"],["class","col-lg-2",4,"ngIf"],[1,"col-lg-2"],["class","checkbox",4,"ngIf"],[1,"col-lg-8"],[1,"float-right"],[1,"row","mt-2"],[3,"ngClass"],[4,"ngFor","ngForOf"],[1,"checkbox"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"pl-1"],[3,"summary","index"]],template:function(e,t){1&e&&(b.Kc(0,La,3,1,"ng-container",0),b.Kc(1,Ba,3,0,"ng-container",0),b.Kc(2,Ga,6,0,"div",1),b.Kc(3,Ha,6,0,"div",0),b.Kc(4,co,14,9,"div",2)),2&e&&(b.oc("ngIf",t.searchIsDone()),b.xb(1),b.oc("ngIf",!t.searchIsDone()),b.xb(1),b.oc("ngIf",t.searchIsActive()),b.xb(1),b.oc("ngIf",t.searchIsDone()&&!t.searchHasResults()),b.xb(1),b.oc("ngIf",t.searchHasResults()))},directives:[u.v,Oc.a,Dc,u.s,u.u,p.a,p.t,p.w,jc,za],encapsulation:2}),e})();var oo=c("1kwX"),ro=c("LRne"),io=c("HDdC"),no=c("lJxs"),so=c("wBwE"),lo=c("MWGh"),bo=c("9Zsr"),ho=c("gtj8"),fo=c("ItyU"),uo=c("+hKF"),go=c("WC/f"),po=c("VX9d"),mo=c("Emlq"),Ro=c("Fbhp"),yo=c("6Unn"),xo=c("EQDH"),vo=c("YRS1");const Co=["successMsg"],Qo=["errorMsg"],Io=["text",$localize`:␟5da240f815d4758b36ce998d2cf0dabfce8239f0␟4667625150960622371:Successfully Made Item(s) Bookable`],_o=["text",$localize`:␟f9e52321f06f481509fc3dc261b174dfb3726c20␟6562773258560565841:Failed To Make Item(s) Bookable`];var So;So=$localize`:␟eb54baf62013157b20942b38bd8b5ed8f364240f␟7379382393049527575:Make Items Bookable`;const To=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var ko,$o,wo,Mo,No,Oo;function zo(e,t){if(1&e&&(b.Rb(0,"div",13),b.Rb(1,"div",14),b.Rb(2,"span"),b.Vb(3,$o),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc(2);b.xb(3),b.Zb(e.copyIds.length),b.Wb(3)}}function Po(e,t){if(1&e&&(b.Rb(0,"div",13),b.Rb(1,"div",15),b.Rb(2,"div"),b.Vb(3,wo),b.Qb(),b.Rb(4,"div",16),b.Rb(5,"a",17),b.Vb(6,Mo),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc(2);b.xb(3),b.Zb(e.numSucceeded),b.Wb(3),b.xb(2),b.oc("queryParams",e.manageUrlParams())}}function Lo(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",18),b.fc("click",(function(){return b.Bc(e),b.hc(2).makeBookable()})),b.Vb(2,No),b.Qb(),b.Ob()}}function Ao(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",18),b.fc("click",(function(){b.Bc(e);const t=b.hc(2);return t.close(t.numSucceeded>0)})),b.Vb(2,Oo),b.Qb(),b.Ob()}}function Bo(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",4),b.Rb(1,"h4",5),b.Rb(2,"span"),b.Vb(3,So),b.Qb(),b.Qb(),b.Rb(4,"button",6),b.Xb(5,To),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Rb(6,"span",7),b.Mc(7,"\xd7"),b.Qb(),b.Qb(),b.Qb(),b.Rb(8,"div",8),b.Kc(9,zo,4,1,"div",9),b.Kc(10,Po,7,2,"div",9),b.Qb(),b.Rb(11,"div",10),b.Pb(12),b.Rb(13,"button",11),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Vb(14,ko),b.Qb(),b.Kc(15,Lo,3,0,"ng-container",12),b.Kc(16,Ao,3,0,"ng-container",12),b.Ob(),b.Qb()}if(2&e){const e=b.hc();b.xb(9),b.oc("ngIf",!e.updateComplete),b.xb(1),b.oc("ngIf",e.updateComplete),b.xb(5),b.oc("ngIf",!e.updateComplete),b.xb(1),b.oc("ngIf",e.updateComplete)}}ko=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,$o=$localize`:␟a692973489d91ae076074d8f2935045ba76eff1b␟6766049857341654823:Make ${"\ufffd0\ufffd"}:INTERPOLATION: Item(s) Bookable?`,wo=$localize`:␟09f4638d6fd18a923b8ebf6d3f44cb8b9422d51a␟4872924920332776591:${"\ufffd0\ufffd"}:INTERPOLATION: Item(s) Made Bookable.`,Mo=$localize`:␟af2b30468861ece9992a59296f922ecf24f5289f␟7202143428564996576: Manage Bookable Resources `,No=$localize`:␟7ebf3da54b5f41f0da7d011fb17e1c84044e95e5␟5729382375938649042:Make Bookable`,Oo=$localize`:␟8dd413cee2228118c536f503709329a4d1a395e2␟397098723873502323:Done`;let Eo=(()=>{class e extends v.a{constructor(e,t,c,a,o,r){super(e),this.modal=e,this.toast=t,this.net=c,this.pcrud=a,this.evt=o,this.auth=r}ngOnInit(){this.onOpenSub=this.onOpen$.subscribe(()=>{return e=this,void 0,c=function*(){this.numSucceeded=0,this.numFailed=0,this.updateComplete=!1},new((t=void 0)||(t=Promise))((function(a,o){function r(e){try{n(c.next(e))}catch(t){o(t)}}function i(e){try{n(c.throw(e))}catch(t){o(t)}}function n(e){var c;e.done?a(e.value):(c=e.value,c instanceof t?c:new t((function(e){e(c)}))).then(r,i)}n((c=c.apply(e,[])).next())}));var e,t,c})}ngOnDestroy(){this.onOpenSub.unsubscribe()}manageUrlParams(){if(this.newResourceOrg)return{gridFilters:JSON.stringify({type:this.newResourceType}),contextOrg:this.newResourceOrg}}makeBookable(){this.newResourceType=null,this.net.request("open-ils.booking","open-ils.booking.resources.create_from_copies",this.auth.token(),this.copyIds).toPromise().then(e=>{const t=this.evt.parse(e);if(t)return Promise.reject(t);this.numSucceeded=e.brsrc.length,this.newResourceType=e.brt[0][0],this.updateComplete=!0,this.successMsg.current().then(e=>this.toast.success(e))},e=>Promise.reject(e)).then(e=>{this.pcrud.retrieve("acp",this.copyIds[0],{flesh:1,flesh_fields:{acp:["call_number"]}}).toPromise().then(e=>{this.newResourceOrg=e.call_number().owning_lib(),this.updateComplete=!0})},e=>{console.error(e),this.numFailed++,this.errorMsg.current().then(e=>this.toast.danger(e)),this.updateComplete=!0})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(m.s),b.Lb(vo.a),b.Lb(ie.b),b.Lb(Nc.a),b.Lb(xo.a),b.Lb(ne.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-make-bookable-dialog"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(Co,!0),b.Ic(Qo,!0)),2&e&&(b.yc(c=b.gc())&&(t.successMsg=c.first),b.yc(c=b.gc())&&(t.errorMsg=c.first))},inputs:{copyIds:"copyIds"},features:[b.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],["class","row",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],[4,"ngIf"],[1,"row"],[1,"col-lg-12"],[1,"col-lg-12","d-flex","flex-column"],[1,"mt-2"],["target","_blank","routerLink","/staff/admin/booking/resource",3,"queryParams"],["type","button",1,"btn","btn-success",3,"click"]],template:function(e,t){1&e&&(b.Rb(0,"eg-string",0,1),b.Xb(2,Io),b.Qb(),b.Rb(3,"eg-string",0,2),b.Xb(5,_o),b.Qb(),b.Kc(6,Bo,17,4,"ng-template",null,3,b.Lc))},directives:[_.a,u.v,r.f],encapsulation:2}),e})();var Do=c("7DyM"),Fo=c("S3Is"),Vo=c("/xpB"),Ko=c("Ef5J"),Xo=c("QGNW"),Go=c("t7hH"),Ho=c("LZHW"),qo=function(e,t,c,a){return new(c||(c=Promise))((function(o,r){function i(e){try{s(a.next(e))}catch(t){r(t)}}function n(e){try{s(a.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof c?t:new c((function(e){e(t)}))).then(i,n)}s((a=a.apply(e,t||[])).next())}))};const Uo=["holdingsGrid"],jo=["callNumsCheckbox"],Yo=["copiesCheckbox"],Wo=["emptyCallNumsCheckbox"],Zo=["emptyLibsCheckbox"],Jo=["markDamagedDialog"],er=["markMissingDialog"],tr=["copyAlertsDialog"],cr=["replaceBarcode"],ar=["deleteHolding"],or=["bucketDialog"],rr=["conjoinedDialog"],ir=["makeBookableDialog"],nr=["transferItems"],sr=["transferHoldings"],lr=["transferAlert"];var br;br=$localize`:␟3f8b5a62638f31b2283cf9a22de04e05d6a5b48d␟3112017872024638015:Holdings Maintenance`;const dr=["dialogTitle",$localize`:␟c32e734e8c0a557c04e0e53bad499ee33a13cc0a␟8676162913971358015:No Target Selected`,"dialogBody",$localize`:␟b3b2543ec52f3a97e91fae1e873b6cea81d88c44␟2683084124556355488:Please select a suitable transfer target`],hr=["label",$localize`:␟245d514000b5337da69ec48d322ccfedbcce0587␟9039478103729243085:Show Call Numbers`],fr=["label",$localize`:␟bcf9f79c10c6ff7e0ce36ff27b60e8885f665cfd␟3344472691112893784:Show Copies`],ur=["label",$localize`:␟22519d9ddb001722666b140ab2296d93ae60ac2f␟9058249305563463446:Show Empty Call Numbers`],gr=["label",$localize`:␟9933a870ffccb0d0d7ac5683ce7f7eecfa7b4e69␟5799999425339047694:Show Empty Libs`],pr=["label",$localize`:␟494d3fc040a27e8322be14f28263b8861db6d01c␟6725247217556343836:Print Labels`],mr=["label",$localize`:␟081d5e4350bc13e1a5c5b415e97991d5c36fd806␟5873179874485934360:Request Items`],Rr=["label",$localize`:␟5a351eeec6ba474bcc1cdff481e7ef7dfda2677e␟6653383051054354510:Link as Conjoined to Marked Bib Record`],yr=["group",$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,"label",$localize`:␟1111bab7c41657365ba6e7e79c9c772c2819b81f␟3639523470474194699:Add Call Numbers`],xr=["group",$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,"label",$localize`:␟78b7dd2e821cbf22fc29f1439c9e486afa40d93a␟192533301975651164:Add Items`],vr=["group",$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,"label",$localize`:␟984addc204a0a1c79d944d2ff794bec3b3097c5a␟5117253013271867323:Add Call Numbers and Items`],Cr=["group",$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,"label",$localize`:␟514febbd202e4b3fcb0552702f435d582ad1b8e8␟6045315895626581502:Add Item Alerts`],Qr=["group",$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,"label",$localize`:␟3e1dd661ff71d1a22178994c2150310a8abcf449␟6445738484686351287:Add Items To Bucket`],Ir=["group",$localize`:␟6c088e91256dd14ed45f9b23c7f33bf6987c9694␟847964475497879979:Booking`,"label",$localize`:␟8f4019aceca2747ec56dd9c18645e5c06510657e␟6217322650629547196:Book Item Now`],_r=["group",$localize`:␟6c088e91256dd14ed45f9b23c7f33bf6987c9694␟847964475497879979:Booking`,"label",$localize`:␟eb54baf62013157b20942b38bd8b5ed8f364240f␟7379382393049527575:Make Items Bookable`],Sr=["group",$localize`:␟6c088e91256dd14ed45f9b23c7f33bf6987c9694␟847964475497879979:Booking`,"label",$localize`:␟2f459f35dd7184d07fabce77ab9e5b430597100d␟3188500773800251137:Manage Reservations`],Tr=["group",$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,"label",$localize`:␟7be6a8dd362d95ee25c52c6357e7808d421d6c08␟9119196986424406963:Edit Call Numbers`],kr=["group",$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,"label",$localize`:␟0824873ced2a0d7bdc4ada6cf98927d8795a5440␟7378404369785185933:Edit Call Numbers And Items`],$r=["group",$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,"label",$localize`:␟40349503bc67a8350c48c7309c108740a0905e47␟2487026685187955236:Edit Items`],wr=["group",$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,"label",$localize`:␟1cfbdb963878784b0f2f5e388ceedc33d5817cc4␟3791829168201550061:Edit Item Alerts`],Mr=["group",$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,"label",$localize`:␟02e033bbdbd4c6c22574b96daa571f123392fe8d␟34629385610162626:Replace Barcodes`],Nr=["group",$localize`:␟826b25211922a1b46436589233cb6f1a163d89b7␟7022070615528435141:Delete`,"label",$localize`:␟8c7b245737e041e4df4e46d4c8d405e936825968␟2987879433722111169:Delete Empty Call Numbers`],Or=["group",$localize`:␟826b25211922a1b46436589233cb6f1a163d89b7␟7022070615528435141:Delete`,"label",$localize`:␟d884137e50bb472620d99221efc9673bd3f70569␟1027110684228149244:Delete Items`],zr=["group",$localize`:␟826b25211922a1b46436589233cb6f1a163d89b7␟7022070615528435141:Delete`,"label",$localize`:␟8b0e5bfc0045dff0e17619e091f42f642667d4e1␟8845055839026159850:Delete Call Numbers and Items`],Pr=["group",$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,"label",$localize`:␟0e973b187ee65a5aeb3a91b34bdb1e8f214bafe6␟8939811925686190875:Show Item Status (list)`],Lr=["group",$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,"label",$localize`:␟cea65f4e2a43b270bbb294b064c794e9a9d0106f␟6877650221569097327:Show Item Status (detail)`],Ar=["group",$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,"label",$localize`:␟4e34e48065823ff1c4ec71d5170d926bd39adfc8␟6340033566582141010:Show Item Holds`],Br=["group",$localize`:␟2aba1e87039819aca3b70faa9aa848c12bf139ca␟8461842260159597706:Show`,"label",$localize`:␟f2c005544fa1d07027875978dc96c59b2dc6241d␟9059463333049750618:Show Triggered Events`],Er=["group",$localize`:␟b58719bcb9184e1a7884d00d22d10899d59bf295␟1226060325201042854:Mark`,"label",$localize`:␟f5f12a4e25ce9e9a43b92bd508b3c47abdecc1a1␟2673254818468878353:Mark Item Damaged`],Dr=["group",$localize`:␟b58719bcb9184e1a7884d00d22d10899d59bf295␟1226060325201042854:Mark`,"label",$localize`:␟6461cdc419feca98e82e8443773f921adf49e5f7␟5007030082081715697:Mark Item Missing`],Fr=["group",$localize`:␟b58719bcb9184e1a7884d00d22d10899d59bf295␟1226060325201042854:Mark`,"label",$localize`:␟42cbdd2b6c3b2cba18fca256b2f86af81b2e274b␟5038178072363653668:Mark Library/Call Number as Transfer Destination`],Vr=["group",$localize`:␟798f7720c371eda6d7931bc590b771a02e2881bb␟8402696305361715603:Transfer`,"label",$localize`:␟e620d79006381161d25858afea7081f0682e3db2␟4496539083734221070:Transfer Items to Marked Destination`],Kr=["group",$localize`:␟798f7720c371eda6d7931bc590b771a02e2881bb␟8402696305361715603:Transfer`,"label",$localize`:␟d8b7bb3b7c61163609d69eb326be538bb47659b7␟2916579526585779016:Transfer Holdings to Marked Destination`],Xr=["label",$localize`:␟27e0b1e650bef276e8c29dd8d547e3fc8c4f833f␟194067946846246769:Item ID`],Gr=["label",$localize`:␟12c2d7f29f1598afa8c3d52a5baf5042e3e1041a␟1407332882545400518:Call Number ID`],Hr=["label",$localize`:␟aaf21536de13b4c8a98ca2d6b6224756d1233d08␟270227330719814731:Location/Barcode`],qr=["label",$localize`:␟544b4e35d2aeb9a2735f74e877a7c3635214fcf0␟8481725481011463835:Call Numbers`],Ur=["label",$localize`:␟bd8d693da6fac85652e5c175bef8bf07c9fc35ed␟2525347614110514925:Copies`],jr=["label",$localize`:␟115508ef944d0bdb066e511220b8679efd7fb4b2␟6100860029551607069:Call Number`],Yr=["label",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`],Wr=["label",$localize`:␟e3e3dcab422689d5bddc3be6316c7d17549d83b7␟2428732022049202001:Circ Library`],Zr=["label",$localize`:␟1ab32f0f2aac0aeeac9ac4184f2afe9ec030ffbc␟8318478181786126182:Owning Library`],Jr=["label",$localize`:␟2e8989faee1f152aa7c8ef12fb79e49c29da9390␟1917979079769004212:Due Date`],ei=["label",$localize`:␟5e3e384df062924aa75d2f5ca826e1e077372153␟8734320241258430920:Shelving Location`],ti=["label",$localize`:␟172a27bb1b7db1ef4a56779c6dcdc20a602a16e7␟3860933437516464957:Circulation Modifier`],ci=["label",$localize`:␟a9b7115c9c65d2601b5021fce0863bf2eab4814a␟8439452045919004338:Item Number`],ai=["label",$localize`:␟81b97b8ea996ad1e4f9fca8415021850214884b1␟5611592591303869712:Status`],oi=["label",$localize`:␟91cf7696f1ff827095be6ef51a8e8cfe548553c7␟7191542028183887855:Call Number Prefix`],ri=["label",$localize`:␟ee334107c83a4c6dc1c5fa2be7c06fc763d6f3bc␟3703469904608875490:Call Number Suffix`],ii=["label",$localize`:␟6e23f8a038ca74043917139174472427205fbaea␟258555327340170828:Parts`],ni=["label",$localize`:␟fcde58253a4cfd52c228eebdae74e1be7a1ab714␟8104421162933956065:Notes`],si=["label",$localize`:␟cafc87479686947e2590b9f588a88040aeaf660b␟7886570921510760899:Tags`],li=["label",$localize`:␟9fe218829514884cdd0ca2300573a4e0428c324f␟8154453727027523235:Alerts`],bi=["label",$localize`:␟74497f22d74b91419277c9d75401db246e63233e␟2547157710218610782:Circulate As MARC Type`],di=["label",$localize`:␟78d8c573992fc570520af8c7db1785b83cb8fd82␟2119215820561494041:Active/Create Date`],hi=["label",$localize`:␟1447f7768ab20b9a1c3d506aa8cb27cf335e2ef9␟8615389546889015621:Age Hold Protection`],fi=["label",$localize`:␟68d3d4821bee1ada3b5f551f21a71e5912e59da3␟7562440787446042921:Item Price`],ui=["label",$localize`:␟e968d9ef2061ec0a798196584a84fda84b7ed925␟7900227474985064812:Circulate`],gi=["label",$localize`:␟cf06fa6d688bcb358f749f49f5f73deeb4be2a9c␟5213771062241898526:Deposit`],pi=["label",$localize`:␟069e1b1ff0629ad1b348c60048ea4ad50b7c8fb6␟4481344588466827844:Deposit Amount`],mi=["label",$localize`:␟a8a65a848ce359ae4137efb842f00190e656370c␟5460489461219302985:Holdable?`],Ri=["label",$localize`:␟ef2244d740370849d57af9583b0fdb67d719074e␟7194843678844004435:Reference?`],yi=["label",$localize`:␟78e744925e6d831e7499caffecb727b9179982b9␟3456963123814264599:Last Inventory Date`],xi=["label",$localize`:␟c8d8b6aa93bc2f7070da17360a52c5749549e20b␟4985327096509445287:Last Inventory Workstation`],vi=function(e){return{invisible:e}};function Ci(e,t){if(1&e&&(b.Rb(0,"span",64),b.Mc(1,"keyboard_arrow_down"),b.Qb()),2&e){const e=b.hc().row;b.oc("ngClass",b.uc(1,vi,e.copy||0==e.treeNode.children.length))}}function Qi(e,t){if(1&e&&(b.Rb(0,"span",64),b.Mc(1,"keyboard_arrow_right"),b.Qb()),2&e){const e=b.hc().row;b.oc("ngClass",b.uc(1,vi,e.copy||0==e.treeNode.children.length))}}function Ii(e,t){if(1&e&&(b.Rb(0,"div"),b.Rb(1,"span"),b.Rb(2,"a",62),b.fc("click",(function(){return t.userContext.toggleExpandRow(t.row)})),b.Kc(3,Ci,2,3,"span",63),b.Kc(4,Qi,2,3,"span",63),b.Rb(5,"span"),b.Mc(6),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e){const e=t.row;b.Bb("pl-",e.locationDepth,""),b.xb(1),b.Bb("pl-",e.locationDepth,""),b.xb(2),b.oc("ngIf",e.treeNode.expanded),b.xb(1),b.oc("ngIf",!e.treeNode.expanded),b.xb(2),b.Nc(e.locationLabel)}}function _i(e,t){if(1&e&&(b.Pb(0),b.Mb(1,"eg-bool",66),b.Ob()),2&e){const e=b.hc(),t=e.row,c=e.userContext;b.xb(1),b.oc("value",c.copyIsHoldable(t.copy))}}function Si(e,t){1&e&&b.Kc(0,_i,2,1,"ng-container",65),2&e&&b.oc("ngIf",t.row.copy)}class Ti{constructor(){this.children=[]}}class ki{constructor(){this.root=new Ti}}class $i{}let wi=(()=>{class e{constructor(e,t,c,a,o,r,i,n,s,l,b){this.router=e,this.org=t,this.idl=c,this.pcrud=a,this.auth=o,this.staffCat=r,this.store=i,this.localStore=n,this.holdings=s,this.broadcaster=l,this.anonCache=b,this.initDone=!1,this.gridDataSource=new lo.c,this.refreshHoldings=!0,this.renderFromPrefs=!0,this.contextOrg=this.staffCat.searchContext.searchOrg,this.rowClassCallback=e=>e.callNum?e.copy?"holdings-copy-row":"holdings-callNum-row":"holdings-org-row holdings-org-row-"+e.treeNode.target.ou_type().depth(),this.cellTextGenerator={owner_label:e=>e.locationLabel,holdable:e=>e.copy?this.gridTemplateContext.copyIsHoldable(e.copy):""},this.gridTemplateContext={toggleExpandRow:e=>{if(e.treeNode.expanded=!e.treeNode.expanded,!e.treeNode.expanded){const t=e=>{e.expanded=!1,e.children.forEach(t)};t(e.treeNode)}this.holdingsGrid.reload()},copyIsHoldable:e=>"t"===e.holdable()&&"t"===e.location().holdable()&&"t"===e.status().holdable()}}set recordId(e){this._recId=e,this.initDone&&this.hardRefresh()}get recordId(){return this._recId}ngOnInit(){this.initDone=!0,this.broadcaster.listen("eg.holdings.update").subscribe(e=>{e&&e.records&&e.records.includes(this.recordId)&&(this.refreshHoldings=!0,this.holdingsGrid.reload())});const e=this.store.getItemBatchCached(["cat.holdings_show_empty_org","cat.holdings_show_empty","cat.holdings_show_copies","cat.holdings_show_vols"]);let t=e["cat.holdings_show_vols"];null===t&&(t=!0),this.callNumsCheckbox.checked(t),this.copiesCheckbox.checked(e["cat.holdings_show_copies"]),this.emptyCallNumsCheckbox.checked(e["cat.holdings_show_empty"]),this.emptyLibsCheckbox.checked(e["cat.holdings_show_empty_org"]),this.initHoldingsTree(),this.gridDataSource.getRows=(e,t)=>this.fetchHoldings(e)}contextOrgChanged(e){this.contextOrg=e,this.hardRefresh()}hardRefresh(){this.renderFromPrefs=!0,this.refreshHoldings=!0,this.initHoldingsTree(),this.holdingsGrid.reload()}toggleShowCopies(e){this.store.setItem("cat.holdings_show_copies",e),e&&this.callNumsCheckbox.checked(!0),this.renderFromPrefs=!0,this.holdingsGrid.reload()}toggleShowCallNums(e){this.store.setItem("cat.holdings_show_vols",e),e||(this.copiesCheckbox.checked(!1),this.emptyCallNumsCheckbox.checked(!1)),this.renderFromPrefs=!0,this.holdingsGrid.reload()}toggleShowEmptyCallNums(e){this.store.setItem("cat.holdings_show_empty",e),e&&this.callNumsCheckbox.checked(!0),this.renderFromPrefs=!0,this.holdingsGrid.reload()}toggleShowEmptyLibs(e){this.store.setItem("cat.holdings_show_empty_org",e),this.renderFromPrefs=!0,this.holdingsGrid.reload()}onRowActivate(e){e.copy||this.gridTemplateContext.toggleExpandRow(e)}initHoldingsTree(){const e=this.org.fullPath(this.contextOrg,!0),t=c=>{c.target.children().forEach(a=>{if(-1===e.indexOf(a.id()))return;const o=new Ti;o.nodeType="org",o.target=a,o.parentNode=c,c.children.push(o),this.treeNodeCache.org[a.id()]=o,t(o)})};this.treeNodeCache={org:{},callNum:{},copy:{}},this.holdingsTree=new ki,this.holdingsTree.root.nodeType="org",this.holdingsTree.root.target=this.org.root(),this.treeNodeCache.org[this.org.root().id()]=this.holdingsTree.root,t(this.holdingsTree.root)}sortOrgNodeChildren(e){e.children=e.children.sort((e,t)=>"org"===e.nodeType?"org"===t.nodeType?e.target.shortname()<t.target.shortname()?-1:1:-1:"org"===t.nodeType?1:e.target._label<t.target._label?-1:1)}setTreeCounts(e){"org"===e.nodeType?(e.copyCount=0,e.callNumCount=0):"callNum"===e.nodeType&&(e.copyCount=0);let t=!1,c=!1;e.children.forEach(a=>{this.setTreeCounts(a),"org"===e.nodeType?(e.copyCount+=a.copyCount,"callNum"===a.nodeType?e.callNumCount++:(t=a.callNumCount>0,c=0===a.callNumCount,e.callNumCount+=a.callNumCount)):"callNum"===e.nodeType&&(e.copyCount=e.children.length,this.renderFromPrefs&&(e.expanded=this.copiesCheckbox.checked()))}),this.renderFromPrefs&&"org"===e.nodeType&&(e.expanded=!!(e.copyCount>0&&this.callNumsCheckbox.checked()||e.callNumCount>0&&this.emptyCallNumsCheckbox.checked()||t||c&&this.emptyLibsCheckbox.checked()))}propagateTreeEntries(e,t){const c=new $i;switch(c.treeNode=t,c.index=this.gridIndex++,t.nodeType){case"org":if(0===t.callNumCount&&!this.emptyLibsCheckbox.checked())return;c.locationLabel=t.target.shortname(),c.locationDepth=t.target.ou_type().depth(),c.copyCount=t.copyCount,c.callNumCount=t.callNumCount,this.sortOrgNodeChildren(t);break;case"callNum":if(this.renderFromPrefs){if(!this.callNumsCheckbox.checked())return;if(0===t.copyCount&&!this.emptyCallNumsCheckbox.checked())return}c.locationLabel=t.target._label,c.locationDepth=t.parentNode.target.ou_type().depth()+1,c.callNumberLabel=c.locationLabel,c.callNum=t.target,c.copyCount=t.copyCount;break;case"copy":c.locationLabel=t.target.barcode(),c.locationDepth=t.parentNode.parentNode.target.ou_type().depth()+2,c.callNumberLabel=t.parentNode.target.label(),c.callNum=t.parentNode.target,c.copy=t.target,c.circ=t.target._circ}e.next(c),t.expanded&&t.children.forEach(t=>this.propagateTreeEntries(e,t))}flattenHoldingsTree(e){this.gridIndex=0,this.setTreeCounts(this.holdingsTree.root),this.propagateTreeEntries(e,this.holdingsTree.root),e.complete(),this.renderFromPrefs=!1}fetchHoldings(e){return this.recordId?new io.a(e=>{this.refreshHoldings?(this.itemCircsNeeded=[],this.pcrud.search("acn",{record:this.recordId,owning_lib:this.org.fullPath(this.contextOrg,!0),deleted:"f",label:{"!=":"##URI##"}},{flesh:3,flesh_fields:{acp:["status","location","circ_lib","parts","notes","tags","age_protect","copy_alerts","latest_inventory"],acn:["prefix","suffix","copies"],acli:["inventory_workstation"]}},{authoritative:!0}).subscribe(e=>this.appendCallNum(e),e=>{},()=>{this.refreshHoldings=!1,this.fetchCircs().then(t=>this.flattenHoldingsTree(e))})):this.flattenHoldingsTree(e)}):Object(ro.a)([])}fetchCircs(){const e=this.itemCircsNeeded.map(e=>e.id());return 0===e.length?Promise.resolve():this.pcrud.search("circ",{target_copy:e,checkin_time:null}).pipe(Object(no.a)(e=>{this.itemCircsNeeded.filter(t=>Number(t.id())===Number(e.target_copy()))[0]._circ=e})).toPromise()}setCallNumLabel(e){const t=e.prefix()?e.prefix().label():"",c=e.suffix()?e.suffix().label():"";e._label=t?t+" ":"",e._label+=e.label(),e._label+=c?" "+c:""}appendCallNum(e){let t=this.treeNodeCache.callNum[e.id()];if(this.setCallNumLabel(e),t){const c=this.treeNodeCache.org[e.owning_lib()];t.parentNode.target.id()!==c.target.id()&&(t.parentNode=c,t.parentNode.children.push(t))}else t=new Ti,t.nodeType="callNum",t.parentNode=this.treeNodeCache.org[e.owning_lib()],t.parentNode.children.push(t),this.treeNodeCache.callNum[e.id()]=t;t.target=e,e.copies().filter(e=>"t"!==e.deleted()).sort((e,t)=>e.barcode()<t.barcode()?-1:1).forEach(e=>this.appendCopy(t,e))}appendCopy(e,t){let c=this.treeNodeCache.copy[t.id()];c?c.parentNode.target.id()!==e.target.id()&&(c.parentNode=e,e.children.push(c)):(c=new Ti,c.nodeType="copy",e.children.push(c),c.parentNode=e,this.treeNodeCache.copy[t.id()]=c),c.target=t;const a=Number(t.status().id());t._monograph_parts="",t.parts().length>0&&(t._monograph_parts=t.parts().map(e=>e.label()).join(",")),1!==a&&16!==a||this.itemCircsNeeded.push(t)}selectedCopyIds(e,t){return this.selectedCopies(e,t).map(e=>Number(e.id()))}selectedVolIds(e){return e.filter(e=>Boolean(e.callNum)).map(e=>Number(e.callNum.id()))}selectedCopies(e,t){let c=e.filter(e=>Boolean(e.copy)).map(e=>e.copy);return t&&(c=c.filter(e=>Number(e.status().id())!==Number(t))),c}selectedCallNumIds(e){return this.selectedCallNums(e).map(e=>e.id())}selectedCallNums(e){return e.filter(e=>"callNum"===e.treeNode.nodeType).map(e=>e.callNum)}showMarkDamagedDialog(e){return qo(this,void 0,void 0,(function*(){const t=this.selectedCopyIds(e,14);if(0===t.length)return;let c=!1;const a=e=>qo(this,void 0,void 0,(function*(){return 0===e.length?Promise.resolve():(this.markDamagedDialog.copyId=e.pop(),this.markDamagedDialog.open({size:"lg"}).subscribe(t=>(t&&(c=!0),a(e)),t=>a(e)))}));yield a(t),c&&(this.refreshHoldings=!0,this.holdingsGrid.reload())}))}showMarkMissingDialog(e){const t=this.selectedCopyIds(e,4);t.length>0&&(this.markMissingDialog.copyIds=t,this.markMissingDialog.open({}).subscribe(e=>{e&&(this.refreshHoldings=!0,this.holdingsGrid.reload())},e=>{}))}markLibCnForTransfer(e){if(0===e.length)return;const t=e[0].treeNode;if("copy"===t.nodeType)return;let c;"org"===t.nodeType?(c=t.target.id(),this.localStore.removeLocalItem("eg.cat.transfer_target_vol")):"callNum"===t.nodeType&&(c=t.parentNode.target.id(),this.localStore.setLocalItem("eg.cat.transfer_target_vol",t.target.id())),this.localStore.setLocalItem("eg.cat.transfer_target_lib",c),this.localStore.setLocalItem("eg.cat.transfer_target_record",this.recordId)}openAngJsWindow(e){window.open("/eg/staff/"+e,"_blank")}openItemHolds(e){e.length>0&&e[0].copy&&this.openAngJsWindow(`cat/item/${e[0].copy.id()}/holds`)}openItemStatusList(e){const t=this.selectedCopyIds(e);if(t.length>0)return this.openAngJsWindow("cat/item/search/"+t.join(","))}openItemStatus(e){if(e.length>0&&e[0].copy)return this.openAngJsWindow("cat/item/"+e[0].copy.id())}openItemTriggeredEvents(e){if(e.length>0&&e[0].copy)return this.openAngJsWindow(`cat/item/${e[0].copy.id()}/triggered_events`)}openItemPrintLabels(e){const t=this.selectedCopyIds(e);0!==t.length&&this.anonCache.setItem(null,"print-labels-these-copies",{copies:t}).then(e=>this.openAngJsWindow("cat/printlabels/"+e))}openHoldingEdit(e,t,c){const a=this.selectedCopies(e),o=a.map(e=>Number(e.call_number())),r=[];this.selectedVolIds(e).forEach(e=>{o.includes(e)||r.push(e)}),this.holdings.spawnAddHoldingsUi(this.recordId,r,null,a.map(e=>Number(e.id())),c,t)}openHoldingAdd(e,t,c){const a={},o=[];if(e.forEach(e=>{if("callNum"===e.treeNode.nodeType)o.push(e.callNum);else if("copy"===e.treeNode.nodeType)o.push(e.treeNode.parentNode.target);else if("org"===e.treeNode.nodeType){const t=e.treeNode.target;"t"===t.ou_type().can_have_vols()&&(a[t.id()]=!0)}}),c&&!t){if(o.length>0){const e=o.map(e=>Number(e.id()));this.holdings.spawnAddHoldingsUi(this.recordId,e)}}else if(t){const e=[];o.forEach(t=>e.push({label:t.label(),owner:t.owning_lib()})),Object.keys(a).forEach(t=>e.push({owner:t})),0===e.length&&e.push({owner:this.auth.user().ws_ou()}),this.holdings.spawnAddHoldingsUi(this.recordId,null,e,null,!c)}}openItemNotes(e,t){const c=this.selectedCopyIds(e);0!==c.length&&(this.copyAlertsDialog.copyIds=c,this.copyAlertsDialog.mode=t,this.copyAlertsDialog.open({size:"lg"}).subscribe(e=>{e&&this.hardRefresh()}))}openReplaceBarcodeDialog(e){const t=this.selectedCopyIds(e);0!==t.length&&(this.replaceBarcode.copyIds=t,this.replaceBarcode.open({}).subscribe(e=>{e&&this.hardRefresh()}))}deleteHoldings(e,t){const c={};"callNums"!==t&&"both"!==t||e.filter(e=>"callNum"===e.treeNode.nodeType).forEach(e=>{const a=this.idl.clone(e.callNum);if("callNums"===t){if(a.copies().length>0)return}else a.copies().forEach(e=>e.isdeleted(!0));a.isdeleted(!0),c[a.id()]=a}),"copies"!==t&&"both"!==t||e.filter(e=>"copy"===e.treeNode.nodeType).forEach(e=>{const t=e.treeNode.parentNode.target;c[t.id()]||(c[t.id()]=this.idl.clone(t),c[t.id()].copies([]));const a=this.idl.clone(e.copy);a.isdeleted(!0),c[t.id()].copies().push(a)}),0!==Object.keys(c).length&&(this.deleteHolding.forceDeleteCopies="both"===t,this.deleteHolding.callNums=Object.values(c),this.deleteHolding.open({size:"sm"}).subscribe(e=>{e&&this.hardRefresh()}))}requestItems(e){const t=this.selectedCopyIds(e);0!==t.length&&this.router.navigate(["/staff/catalog/hold/C"],{queryParams:{target:t,holdFor:"staff"}})}openBucketDialog(e){const t=this.selectedCopyIds(e);t.length>0&&(this.bucketDialog.bucketClass="copy",this.bucketDialog.itemIds=t,this.bucketDialog.open({size:"lg"}))}openConjoinedDialog(e){const t=this.selectedCopyIds(e);t.length>0&&(this.conjoinedDialog.copyIds=t,this.conjoinedDialog.open({size:"sm"}))}bookItems(e){this.selectedCopyIds(e).length>0&&this.router.navigate(["staff","booking","create_reservation","for_resource",e.filter(e=>Boolean(e.copy))[0].copy.barcode()])}makeBookable(e){const t=this.selectedCopyIds(e);t.length>0&&(this.makeBookableDialog.copyIds=t,this.makeBookableDialog.open({}))}manageReservations(e){this.selectedCopyIds(e).length>0&&this.router.navigate(["staff","booking","manage_reservations","by_resource",e.filter(e=>Boolean(e.copy))[0].copy.barcode()])}transferSelectedItems(e){if(0===e.length)return;const t=this.localStore.getLocalItem("eg.cat.transfer_target_vol"),c=this.localStore.getLocalItem("eg.cat.transfer_target_lib"),a=this.localStore.getLocalItem("eg.cat.transfer_target_record");let o;if(t){const c=this.selectedCopyIds(e);o=this.transferItems.transferItems(c,t)}else if(c&&a){const t=this.idl.clone(this.selectedCopies(e));t.forEach(e=>e.call_number(this.treeNodeCache.callNum[e.call_number()].target)),console.log(t),o=this.transferItems.autoTransferItems(t,a,c)}else o=this.transferAlert.open().toPromise();o.then(e=>e?this.hardRefresh():null)}transferSelectedHoldings(e){const t=this.selectedCallNums(e);if(0===t.length)return;const c=this.localStore.getLocalItem("eg.cat.transfer_target_lib");let a=this.localStore.getLocalItem("eg.cat.transfer_target_record");if(c)a=this.recordId;else if(!a)return this.transferAlert.open();this.transferHoldings.targetRecId=a,this.transferHoldings.targetOrgId=c,this.transferHoldings.callNums=t,this.transferHoldings.transferHoldings().then(e=>e?this.hardRefresh():null)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(i.a),b.Lb(so.a),b.Lb(Nc.a),b.Lb(ne.a),b.Lb(d),b.Lb(x.a),b.Lb(y.a),b.Lb(go.a),b.Lb(Ko.a),b.Lb(I.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-holdings-maintenance"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(Uo,!0),b.Ic(jo,!0),b.Ic(Yo,!0),b.Ic(Wo,!0),b.Ic(Zo,!0),b.Ic(Jo,!0),b.Ic(er,!0),b.Ic(tr,!0),b.Ic(cr,!0),b.Ic(ar,!0),b.Ic(or,!0),b.Ic(rr,!0),b.Ic(ir,!0),b.Sc(nr,!0),b.Sc(sr,!0),b.Sc(lr,!0)),2&e&&(b.yc(c=b.gc())&&(t.holdingsGrid=c.first),b.yc(c=b.gc())&&(t.callNumsCheckbox=c.first),b.yc(c=b.gc())&&(t.copiesCheckbox=c.first),b.yc(c=b.gc())&&(t.emptyCallNumsCheckbox=c.first),b.yc(c=b.gc())&&(t.emptyLibsCheckbox=c.first),b.yc(c=b.gc())&&(t.markDamagedDialog=c.first),b.yc(c=b.gc())&&(t.markMissingDialog=c.first),b.yc(c=b.gc())&&(t.copyAlertsDialog=c.first),b.yc(c=b.gc())&&(t.replaceBarcode=c.first),b.yc(c=b.gc())&&(t.deleteHolding=c.first),b.yc(c=b.gc())&&(t.bucketDialog=c.first),b.yc(c=b.gc())&&(t.conjoinedDialog=c.first),b.yc(c=b.gc())&&(t.makeBookableDialog=c.first),b.yc(c=b.gc())&&(t.transferItems=c.first),b.yc(c=b.gc())&&(t.transferHoldings=c.first),b.yc(c=b.gc())&&(t.transferAlert=c.first))},inputs:{recordId:"recordId"},decls:168,vars:31,consts:[[1,"row","mt-3"],[1,"col-lg-4"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[3,"initialOrg","onChange"],["locationTemplate",""],["holdableTemplate",""],["markDamagedDialog",""],["markMissingDialog",""],["copyAlertsDialog",""],["replaceBarcode",""],["deleteHolding",""],["bucketDialog",""],["conjoinedDialog",""],["makeBookableDialog",""],["transferItems",""],["transferHoldings",""],[6,"dialogTitle","dialogBody"],["transferAlert",""],[1,"eg-copies","w-100","mt-3"],["persistKey","cat.holdings",3,"dataSource","disablePaging","rowClassCallback","cellTextGenerator","sortable","onRowActivate"],["holdingsGrid",""],[3,"onChange",6,"label"],["callNumsCheckbox",""],["copiesCheckbox",""],["emptyCallNumsCheckbox",""],["emptyLibsCheckbox",""],[3,"onClick",6,"label"],[3,"onClick",6,"group","label"],["path","index",3,"hidden","index"],["name","id","path","copy.id",3,"hidden",6,"label"],["path","callNum.id",3,"hidden",6,"label"],["name","owner_label",3,"flex","cellTemplate","cellContext","disableTooltip",6,"label"],["path","callNumCount","datatype","number",6,"label"],["path","copyCount","datatype","number",6,"label"],["path","callNum._label","name","call_number.label",6,"label"],["path","copy.barcode","name","barcode",6,"label"],["path","copy.circ_lib","name","circ_lib.name","datatype","org_unit",6,"label"],["path","callNum.owning_lib","datatype","org_unit",6,"label"],["path","circ.due_date","datatype","timestamp",6,"label"],["path","copy.location.name","name","location.name",6,"label"],["path","copy.circ_modifier","name","circ_modifier",6,"label"],["path","copy.copy_number","name","copy_number",3,"hidden",6,"label"],["path","copy.status.name","name","status_name",6,"label"],["path","callNum.prefix.label","name","call_number.prefix.label",3,"hidden",6,"label"],["path","callNum.suffix.label","name","call_number.suffix.label",3,"hidden",6,"label"],["path","copy._monograph_parts","name","monograph_parts",3,"hidden",6,"label"],["path","copy.notes.length","name","note_count",3,"hidden",6,"label"],["path","copy.tags.length","name","tag_count",3,"hidden",6,"label"],["path","copy.copy_alerts.length","name","alert_count",3,"hidden",6,"label"],["path","copy.circ_as_type",3,"hidden",6,"label"],["path","copy.active_date","datatype","timestamp",6,"label"],["path","copy.age_protect.name","name","age_protect.name",6,"label"],["path","copy.price","name","price",3,"hidden",6,"label"],["path","copy.circulate","name","circulate","datatype","bool",3,"hidden",6,"label"],["path","copy.deposit","name","deposit","datatype","bool",3,"hidden",6,"label"],["path","copy.deposit_amount","name","deposit_amount","datatype","money",3,"hidden",6,"label"],["name","holdable",3,"cellTemplate","cellContext",6,"label"],["path","copy.ref","name","ref","datatype","bool",3,"hidden",6,"label"],["path","copy.latest_inventory.inventory_date","name","latest_inventory.inventory_date","datatype","timestamp",3,"hidden",6,"label"],["path","copy.latest_inventory.inventory_workstation.name","name","latest_inventory.inventory_workstation.name",3,"hidden",6,"label"],[1,"label-with-material-icon",3,"click"],["class","material-icons p-0 m-0",3,"ngClass",4,"ngIf"],[1,"material-icons","p-0","m-0",3,"ngClass"],[4,"ngIf"],[3,"value"]],template:function(e,t){if(1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Rb(3,"div",3),b.Rb(4,"div",4),b.Vb(5,br),b.Qb(),b.Qb(),b.Rb(6,"eg-org-select",5),b.fc("onChange",(function(e){return t.contextOrgChanged(e)})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Kc(7,Ii,7,9,"ng-template",null,6,b.Lc),b.Kc(9,Si,1,1,"ng-template",null,7,b.Lc),b.Mb(11,"eg-mark-damaged-dialog",null,8),b.Mb(13,"eg-mark-missing-dialog",null,9),b.Mb(15,"eg-copy-alerts-dialog",null,10),b.Mb(17,"eg-replace-barcode-dialog",null,11),b.Mb(19,"eg-delete-holding-dialog",null,12),b.Mb(21,"eg-bucket-dialog",null,13),b.Mb(23,"eg-conjoined-items-dialog",null,14),b.Mb(25,"eg-make-bookable-dialog",null,15),b.Mb(27,"eg-transfer-items",null,16),b.Mb(29,"eg-transfer-holdings",null,17),b.Rb(31,"eg-alert-dialog",18,19),b.Xb(33,dr),b.Qb(),b.Rb(34,"div",20),b.Rb(35,"eg-grid",21,22),b.fc("onRowActivate",(function(e){return t.onRowActivate(e)})),b.Rb(37,"eg-grid-toolbar-checkbox",23,24),b.Xb(39,hr),b.fc("onChange",(function(e){return t.toggleShowCallNums(e)})),b.Qb(),b.Rb(40,"eg-grid-toolbar-checkbox",23,25),b.Xb(42,fr),b.fc("onChange",(function(e){return t.toggleShowCopies(e)})),b.Qb(),b.Rb(43,"eg-grid-toolbar-checkbox",23,26),b.Xb(45,ur),b.fc("onChange",(function(e){return t.toggleShowEmptyCallNums(e)})),b.Qb(),b.Rb(46,"eg-grid-toolbar-checkbox",23,27),b.Xb(48,gr),b.fc("onChange",(function(e){return t.toggleShowEmptyLibs(e)})),b.Qb(),b.Rb(49,"eg-grid-toolbar-action",28),b.Xb(50,pr),b.fc("onClick",(function(e){return t.openItemPrintLabels(e)})),b.Qb(),b.Rb(51,"eg-grid-toolbar-action",28),b.Xb(52,mr),b.fc("onClick",(function(e){return t.requestItems(e)})),b.Qb(),b.Rb(53,"eg-grid-toolbar-action",28),b.Xb(54,Rr),b.fc("onClick",(function(e){return t.openConjoinedDialog(e)})),b.Qb(),b.Rb(55,"eg-grid-toolbar-action",29),b.Xb(56,yr),b.fc("onClick",(function(e){return t.openHoldingAdd(e,!0,!1)})),b.Qb(),b.Rb(57,"eg-grid-toolbar-action",29),b.Xb(58,xr),b.fc("onClick",(function(e){return t.openHoldingAdd(e,!1,!0)})),b.Qb(),b.Rb(59,"eg-grid-toolbar-action",29),b.Xb(60,vr),b.fc("onClick",(function(e){return t.openHoldingAdd(e,!0,!0)})),b.Qb(),b.Rb(61,"eg-grid-toolbar-action",29),b.Xb(62,Cr),b.fc("onClick",(function(e){return t.openItemNotes(e,"create")})),b.Qb(),b.Rb(63,"eg-grid-toolbar-action",29),b.Xb(64,Qr),b.fc("onClick",(function(e){return t.openBucketDialog(e)})),b.Qb(),b.Rb(65,"eg-grid-toolbar-action",29),b.Xb(66,Ir),b.fc("onClick",(function(e){return t.bookItems(e)})),b.Qb(),b.Rb(67,"eg-grid-toolbar-action",29),b.Xb(68,_r),b.fc("onClick",(function(e){return t.makeBookable(e)})),b.Qb(),b.Rb(69,"eg-grid-toolbar-action",29),b.Xb(70,Sr),b.fc("onClick",(function(e){return t.manageReservations(e)})),b.Qb(),b.Rb(71,"eg-grid-toolbar-action",29),b.Xb(72,Tr),b.fc("onClick",(function(e){return t.openHoldingEdit(e,!1,!0)})),b.Qb(),b.Rb(73,"eg-grid-toolbar-action",29),b.Xb(74,kr),b.fc("onClick",(function(e){return t.openHoldingEdit(e,!1,!1)})),b.Qb(),b.Rb(75,"eg-grid-toolbar-action",29),b.Xb(76,$r),b.fc("onClick",(function(e){return t.openHoldingEdit(e,!0,!1)})),b.Qb(),b.Rb(77,"eg-grid-toolbar-action",29),b.Xb(78,wr),b.fc("onClick",(function(e){return t.openItemNotes(e,"manage")})),b.Qb(),b.Rb(79,"eg-grid-toolbar-action",29),b.Xb(80,Mr),b.fc("onClick",(function(e){return t.openReplaceBarcodeDialog(e)})),b.Qb(),b.Rb(81,"eg-grid-toolbar-action",29),b.Xb(82,Nr),b.fc("onClick",(function(e){return t.deleteHoldings(e,"callNums")})),b.Qb(),b.Rb(83,"eg-grid-toolbar-action",29),b.Xb(84,Or),b.fc("onClick",(function(e){return t.deleteHoldings(e,"copies")})),b.Qb(),b.Rb(85,"eg-grid-toolbar-action",29),b.Xb(86,zr),b.fc("onClick",(function(e){return t.deleteHoldings(e,"both")})),b.Qb(),b.Rb(87,"eg-grid-toolbar-action",29),b.Xb(88,Pr),b.fc("onClick",(function(e){return t.openItemStatusList(e)})),b.Qb(),b.Rb(89,"eg-grid-toolbar-action",29),b.Xb(90,Lr),b.fc("onClick",(function(e){return t.openItemStatus(e)})),b.Qb(),b.Rb(91,"eg-grid-toolbar-action",29),b.Xb(92,Ar),b.fc("onClick",(function(e){return t.openItemHolds(e)})),b.Qb(),b.Rb(93,"eg-grid-toolbar-action",29),b.Xb(94,Br),b.fc("onClick",(function(e){return t.openItemTriggeredEvents(e)})),b.Qb(),b.Rb(95,"eg-grid-toolbar-action",29),b.Xb(96,Er),b.fc("onClick",(function(e){return t.showMarkDamagedDialog(e)})),b.Qb(),b.Rb(97,"eg-grid-toolbar-action",29),b.Xb(98,Dr),b.fc("onClick",(function(e){return t.showMarkMissingDialog(e)})),b.Qb(),b.Rb(99,"eg-grid-toolbar-action",29),b.Xb(100,Fr),b.fc("onClick",(function(e){return t.markLibCnForTransfer(e)})),b.Qb(),b.Rb(101,"eg-grid-toolbar-action",29),b.Xb(102,Vr),b.fc("onClick",(function(e){return t.transferSelectedItems(e)})),b.Qb(),b.Rb(103,"eg-grid-toolbar-action",29),b.Xb(104,Kr),b.fc("onClick",(function(e){return t.transferSelectedHoldings(e)})),b.Qb(),b.Mb(105,"eg-grid-column",30),b.Rb(106,"eg-grid-column",31),b.Xb(107,Xr),b.Qb(),b.Rb(108,"eg-grid-column",32),b.Xb(109,Gr),b.Qb(),b.Rb(110,"eg-grid-column",33),b.Xb(111,Hr),b.Qb(),b.Rb(112,"eg-grid-column",34),b.Xb(113,qr),b.Qb(),b.Rb(114,"eg-grid-column",35),b.Xb(115,Ur),b.Qb(),b.Rb(116,"eg-grid-column",36),b.Xb(117,jr),b.Qb(),b.Rb(118,"eg-grid-column",37),b.Xb(119,Yr),b.Qb(),b.Rb(120,"eg-grid-column",38),b.Xb(121,Wr),b.Qb(),b.Rb(122,"eg-grid-column",39),b.Xb(123,Zr),b.Qb(),b.Rb(124,"eg-grid-column",40),b.Xb(125,Jr),b.Qb(),b.Rb(126,"eg-grid-column",41),b.Xb(127,ei),b.Qb(),b.Rb(128,"eg-grid-column",42),b.Xb(129,ti),b.Qb(),b.Rb(130,"eg-grid-column",43),b.Xb(131,ci),b.Qb(),b.Rb(132,"eg-grid-column",44),b.Xb(133,ai),b.Qb(),b.Rb(134,"eg-grid-column",45),b.Xb(135,oi),b.Qb(),b.Rb(136,"eg-grid-column",46),b.Xb(137,ri),b.Qb(),b.Rb(138,"eg-grid-column",47),b.Xb(139,ii),b.Qb(),b.Rb(140,"eg-grid-column",48),b.Xb(141,ni),b.Qb(),b.Rb(142,"eg-grid-column",49),b.Xb(143,si),b.Qb(),b.Rb(144,"eg-grid-column",50),b.Xb(145,li),b.Qb(),b.Rb(146,"eg-grid-column",51),b.Xb(147,bi),b.Qb(),b.Rb(148,"eg-grid-column",52),b.Xb(149,di),b.Qb(),b.Rb(150,"eg-grid-column",53),b.Xb(151,hi),b.Qb(),b.Rb(152,"eg-grid-column",54),b.Xb(153,fi),b.Qb(),b.Rb(154,"eg-grid-column",55),b.Xb(155,ui),b.Qb(),b.Rb(156,"eg-grid-column",56),b.Xb(157,gi),b.Qb(),b.Rb(158,"eg-grid-column",57),b.Xb(159,pi),b.Qb(),b.Rb(160,"eg-grid-column",58),b.Xb(161,mi),b.Qb(),b.Rb(162,"eg-grid-column",59),b.Xb(163,Ri),b.Qb(),b.Rb(164,"eg-grid-column",60),b.Xb(165,yi),b.Qb(),b.Rb(166,"eg-grid-column",61),b.Xb(167,xi),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.zc(8),c=b.zc(10);b.xb(6),b.oc("initialOrg",t.contextOrg),b.xb(29),b.oc("dataSource",t.gridDataSource)("disablePaging",!0)("rowClassCallback",t.rowClassCallback)("cellTextGenerator",t.cellTextGenerator)("sortable",!1),b.xb(70),b.oc("hidden",!0)("index",!0),b.xb(1),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("flex",4)("cellTemplate",e)("cellContext",t.gridTemplateContext)("disableTooltip",!0),b.xb(20),b.oc("hidden",!0),b.xb(4),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(6),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("cellTemplate",c)("cellContext",t.gridTemplateContext),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0),b.xb(2),b.oc("hidden",!0)}},directives:[R.a,fo.a,uo.a,po.a,mo.a,Ro.a,le.a,yo.a,Eo,Do.a,Fo.a,Vo.a,bo.a,ho.a,Xo.a,Go.a,u.v,u.s,Ho.a],styles:[".holdings-callNum-row{background-color:#c9efe4}.holdings-org-row{color:rgba(0,0,0,.8);background-color:#e1efeb}"],encapsulation:2}),e})();var Mi=c("7w9P"),Ni=c("Q4dc");const Oi=["aria-label",$localize`:␟8434d4a28744d7df82cd39ef8da4266fcbc40064␟5162686434580248853:Start`];var zi;zi=$localize`:␟8434d4a28744d7df82cd39ef8da4266fcbc40064␟5162686434580248853:Start`;const Pi=["aria-label",$localize`:␟680d5c75b7fd8d37961083608b9fcdc4167b4c43␟4452427314943113135:Previous`];var Li;Li=$localize`:␟680d5c75b7fd8d37961083608b9fcdc4167b4c43␟4452427314943113135:Previous`;const Ai=["aria-label",$localize`:␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`];var Bi;Bi=$localize`:␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`;const Ei=["aria-label",$localize`:␟b68ce78c3f2c548391d812c248217f8a212491e1␟1241348629231510663:End`];var Di;Di=$localize`:␟b68ce78c3f2c548391d812c248217f8a212491e1␟1241348629231510663:End`;const Fi=["aria-label",$localize`:␟401d2306a165296a87910c67f53108e75f63ae34␟6389851594466445126:Back to Results`];var Vi;Vi=$localize`:␟a71d70fc9ca356422e95fd8ccbb59a8402e4bbd3␟7420872352510095290: Back to Results (${"\ufffd0\ufffd"}:INTERPOLATION: / ${"\ufffd1\ufffd"}:INTERPOLATION_1:) `;const Ki=function(e){return{disabled:e}};function Xi(e,t){if(1&e){const e=b.Sb();b.Rb(0,"ul",1),b.Rb(1,"li",2),b.Rb(2,"a",3),b.Xb(3,Oi),b.fc("click",(function(){return b.Bc(e),b.hc().firstRecord()})),b.Rb(4,"span"),b.Vb(5,zi),b.Qb(),b.Qb(),b.Qb(),b.Rb(6,"li",2),b.Rb(7,"a",3),b.Xb(8,Pi),b.fc("click",(function(){return b.Bc(e),b.hc().prevRecord()})),b.Rb(9,"span"),b.Vb(10,Li),b.Qb(),b.Qb(),b.Qb(),b.Rb(11,"li",2),b.Rb(12,"a",3),b.Xb(13,Ai),b.fc("click",(function(){return b.Bc(e),b.hc().nextRecord()})),b.Rb(14,"span"),b.Vb(15,Bi),b.Qb(),b.Qb(),b.Qb(),b.Rb(16,"li",2),b.Rb(17,"a",3),b.Xb(18,Ei),b.fc("click",(function(){return b.Bc(e),b.hc().lastRecord()})),b.Rb(19,"span"),b.Vb(20,Di),b.Qb(),b.Qb(),b.Qb(),b.Rb(21,"li",4),b.Rb(22,"a",3),b.Xb(23,Fi),b.fc("click",(function(){return b.Bc(e),b.hc().returnToSearch()})),b.Rb(24,"span"),b.Vb(25,Vi),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(1),b.oc("ngClass",b.uc(6,Ki,0==e.index)),b.xb(5),b.oc("ngClass",b.uc(8,Ki,0==e.index)),b.xb(5),b.oc("ngClass",b.uc(10,Ki,e.index>=e.searchContext.result.count-1)),b.xb(5),b.oc("ngClass",b.uc(12,Ki,e.index>=e.searchContext.result.count-1)),b.xb(9),b.Zb(e.index+1)(e.searchContext.result.count),b.Wb(25)}}let Gi=(()=>{class e{constructor(e,t,c,a){this.router=e,this.cat=t,this.catUrl=c,this.staffCat=a,this.initDone=!1}set recordTab(e){this._recordTab=e}get recordTab(){return this._recordTab}set recordId(e){this.id=e,this.initDone&&this.setIndex()}ngOnInit(){this.initDone=!0,this.setIndex()}routeToRecord(e){let t="/staff/catalog/record/"+e;this.recordTab&&(t+="/"+this.recordTab);const c=this.catUrl.toUrlParams(this.searchContext);this.router.navigate([t],{queryParams:c})}firstRecord(){this.findRecordAtIndex(0).then(e=>this.routeToRecord(e))}lastRecord(){this.findRecordAtIndex(this.searchContext.result.count-1).then(e=>this.routeToRecord(e))}nextRecord(){this.findRecordAtIndex(this.index+1).then(e=>this.routeToRecord(e))}prevRecord(){this.findRecordAtIndex(this.index-1).then(e=>this.routeToRecord(e))}searchIndex(e){return e+this.searchContext.pager.offset}setIndex(){return this.searchContext=this.staffCat.searchContext,this.index=null,new Promise((e,t)=>(this.index=this.searchContext.indexForResult(this.id),null!==this.index?e():this.refreshSearch().then(t=>{this.index=this.searchContext.indexForResult(this.id),e()})))}findRecordAtIndex(e){return new Promise((t,c)=>{const a=this.searchContext.resultIdAt(e);return a?t(a):(console.debug("Record paginator unable to find record at index "+e),this.refreshSearch(e+2).then(a=>{const o=this.searchContext.resultIdAt(e);o?t(o):c("no record found")}))})}refreshSearch(e){if(console.debug("paginator refreshing search"),!this.searchContext.isSearchable())return Promise.resolve();const t=this.searchContext,c=t.pager,a=new Ni.a;return a.limit=e||1e3,t.pager=a,t.getHighlightsFor=this.id,this.cat.search(t).then(e=>{t.pager=c,t.getHighlightsFor=null})}returnToSearch(){this.staffCat.search()}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(n.a),b.Lb(s.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-record-pagination"]],inputs:{recordTab:"recordTab",recordId:"recordId"},decls:1,vars:1,consts:[["class","pagination mb-0",4,"ngIf"],[1,"pagination","mb-0"],[1,"page-item",3,"ngClass"],[1,"no-href","page-link",3,"click",6,"aria-label"],[1,"page-item"]],template:function(e,t){1&e&&b.Kc(0,Xi,26,14,"ul",0),2&e&&b.oc("ngIf",null!==t.index)},directives:[u.v,u.s],encapsulation:2}),e})();const Hi=["text",$localize`:␟1ad61a7f9082b69b46ff90277708d1b577b90f13␟5363309161975546263:Conjoined Record Target Set`],qi=["text",$localize`:␟0a80c2cbffc39b53c501e2e2db6219949130446b␟3928059378279508467:Record Overlay Target Set`],Ui=["text",$localize`:␟5403aa8f50aa287c0e4352f4ed167d4f3eb718d9␟3382577031615876832:Hold Transfer Target Set`],ji=["text",$localize`:␟7c9a0196de63b4e200e992bba384b4fc0790d801␟6565022694097285936:Holding Transfer Target Set`];var Yi,Wi,Zi,Ji,en,tn,cn,an,on,rn,nn,sn,ln,bn;function dn(e,t){if(1&e&&(b.bc(0,nn,1),b.Nb(1),b.Yb()),2&e){const e=b.hc();b.xb(1),b.Zb(e.targets.conjoined.current),b.Wb(0)}}function hn(e,t){if(1&e&&(b.bc(0,sn,1),b.Nb(1),b.Yb()),2&e){const e=b.hc();b.xb(1),b.Zb(e.targets.overlay.current),b.Wb(0)}}function fn(e,t){if(1&e&&(b.bc(0,ln,1),b.Nb(1),b.Yb()),2&e){const e=b.hc();b.xb(1),b.Zb(e.targets.holdTransfer.current),b.Wb(0)}}function un(e,t){if(1&e&&(b.bc(0,bn,1),b.Nb(1),b.Yb()),2&e){const e=b.hc();b.xb(1),b.Zb(e.targets.holdingTransfer.current),b.Wb(0)}}Yi=$localize`:␟a8d2c33741ffac33baa5034038c0ada021156cfe␟133993343914853660:Place Hold`,Wi=$localize`:␟16501c4045286721e0dba75b704cadee1fadaec7␟5802108972540440840: Add Holdings `,Zi=$localize`:␟b440da764cb5f02b9a1b4dba60e3a011a9f09c8a␟2957817963391638218:Serials`,Ji=$localize`:␟c8a0892eed48aa53b4e78af3a8bf210af7ae76cf␟3504169390685831024: Manage Subscriptions `,en=$localize`:␟e08c20f0128f0b833c094773129fff4d88c08a5e␟7431706574394511216: Manage MFHDs `,tn=$localize`:␟170cc327fe109ad368aa3d48607f292bcfb6acef␟1055264699431097396:Mark For...`,cn=$localize`:␟e10b415573566c956c395e0cc9522d47a1630f45␟4119911782935171588:Reset Record Marks`,an=$localize`:␟de7c729285b10d15d1de4d1a86ab3a1c60ddc8e3␟2333268741491427330:Other Actions`,on=$localize`:␟482f8545f97ee214b11a518647d31051a71833ac␟9190320582959715379:Add To Bucket`,rn=$localize`:␟335e07687800c2c41b4659f289456f838d256b8c␟1308717189020799030:View/Place Orders`,nn=$localize`:␟134ca1f040045127cd85ad928dae6006f7e2d0eb␟6223274782988266903: Conjoined Items${"\ufffd*32:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: (Currently ${"\ufffd0:1\ufffd"}:INTERPOLATION:)${"\ufffd/#1:1\ufffd\ufffd/*32:1\ufffd"}:CLOSE_TAG_NG_CONTAINER:`,sn=$localize`:␟45f91cdbb392411380abf43a1b90576c6a2c75d5␟8080190627159920980: Overlay Target${"\ufffd*36:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: (Currently ${"\ufffd0:1\ufffd"}:INTERPOLATION:)${"\ufffd/#1:1\ufffd\ufffd/*36:1\ufffd"}:CLOSE_TAG_NG_CONTAINER:`,ln=$localize`:␟5a5ad0d0e99e6df95a29949a48343c16e885b7eb␟10750687562183996: Title Hold Transfer${"\ufffd*40:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: (Currently ${"\ufffd0:1\ufffd"}:INTERPOLATION:)${"\ufffd/#1:1\ufffd\ufffd/*40:1\ufffd"}:CLOSE_TAG_NG_CONTAINER:`,bn=$localize`:␟aa5e01d499d5c7e3b3793d85011baf6c248a051b␟7634477308898522756: Holding Transfer${"\ufffd*44:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: (Currently ${"\ufffd0:1\ufffd"}:INTERPOLATION:)${"\ufffd/#1:1\ufffd\ufffd/*44:1\ufffd"}:CLOSE_TAG_NG_CONTAINER:`;const gn=function(e){return[e]},pn=function(e){return{target:e}};let mn=(()=>{class e{constructor(e,t,c,a,o,r,i,n){this.router=e,this.store=t,this.strings=c,this.toast=a,this.cat=o,this.catUrl=r,this.staffCat=i,this.holdings=n,this.addHoldingsRequested=new b.n,this.initDone=!1,this.targets={conjoined:{key:"eg.cat.marked_conjoined_record",current:null},overlay:{key:"eg.cat.marked_overlay_record",current:null},holdTransfer:{key:"eg.circ.hold.title_transfer_target",current:null},holdingTransfer:{key:"eg.cat.transfer_target_record",current:null,clear:["eg.cat.transfer_target_lib","eg.cat.transfer_target_vol"]}}}set recordId(e){this.recId=e}ngOnInit(){this.initDone=!0,Object.keys(this.targets).forEach(e=>{const t=this.targets[e];t.current=this.store.getLocalItem(t.key)})}mark(e){const t=this.targets[e];t.current=this.recId,this.store.setLocalItem(t.key,this.recId),t.clear&&t.clear.forEach(e=>this.store.removeLocalItem(e)),this.strings.interpolate("catalog.record.toast."+e).then(e=>this.toast.success(e))}clearMarks(){Object.keys(this.targets).forEach(e=>{const t=this.targets[e];t.current=null,this.store.removeLocalItem(t.key)}),this.strings.interpolate("catalog.record.toast.cleared").then(e=>this.toast.success(e))}addHoldings(){this.addHoldingsRequested.emit()}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(y.a),b.Lb(Q.a),b.Lb(vo.a),b.Lb(n.a),b.Lb(s.a),b.Lb(d),b.Lb(go.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-record-actions"]],inputs:{recordId:"recordId"},outputs:{addHoldingsRequested:"addHoldingsRequested"},decls:58,vars:13,consts:[["key","catalog.record.toast.conjoined",6,"text"],["key","catalog.record.toast.overlay",6,"text"],["key","catalog.record.toast.holdTransfer",6,"text"],["key","catalog.record.toast.holdingTransfer",6,"text"],["key","catalog.record.toast.cleared","text","Record Marks Cleared"],["bucketClass","biblio",3,"itemIds"],["recordBucketDialog",""],[1,"row","ml-0","mr-0"],["routerLink","/staff/catalog/hold/T",3,"queryParams"],[1,"btn","btn-outline-primary","ml-1"],[1,"btn","btn-outline-primary","ml-1",3,"click"],["ngbDropdown","","placement","bottom-right",1,"ml-1"],["id","actionsForSerials","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["ngbDropdownMenu","","aria-labelledby","actionsForSerials"],[1,"dropdown-item",3,"href"],["id","actionsForDd","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["ngbDropdownMenu","","aria-labelledby","actionsForDd"],[1,"dropdown-item",3,"click"],[4,"ngIf"],["id","otherActionsForDd","ngbDropdownToggle","",1,"btn","btn-outline-primary"],["ngbDropdownMenu","","aria-labelledby","otherActionsForDd"]],template:function(e,t){if(1&e){const e=b.Sb();b.Rb(0,"eg-string",0),b.Xb(1,Hi),b.Qb(),b.Rb(2,"eg-string",1),b.Xb(3,qi),b.Qb(),b.Rb(4,"eg-string",2),b.Xb(5,Ui),b.Qb(),b.Rb(6,"eg-string",3),b.Xb(7,ji),b.Qb(),b.Mb(8,"eg-string",4),b.Mb(9,"eg-bucket-dialog",5,6),b.Rb(11,"div",7),b.Rb(12,"a",8),b.Rb(13,"button",9),b.Vb(14,Yi),b.Qb(),b.Qb(),b.Rb(15,"button",10),b.fc("click",(function(){return t.addHoldings()})),b.Vb(16,Wi),b.Qb(),b.Rb(17,"div",11),b.Rb(18,"button",12),b.Vb(19,Zi),b.Qb(),b.Rb(20,"div",13),b.Rb(21,"a",14),b.Vb(22,Ji),b.Qb(),b.Rb(23,"a",14),b.Vb(24,en),b.Qb(),b.Qb(),b.Qb(),b.Rb(25,"div",11),b.Rb(26,"button",15),b.Vb(27,tn),b.Qb(),b.Rb(28,"div",16),b.Rb(29,"button",17),b.fc("click",(function(){return t.mark("conjoined")})),b.Rb(30,"span"),b.bc(31,nn),b.Kc(32,dn,2,1,"ng-container",18),b.Yb(),b.Qb(),b.Qb(),b.Rb(33,"button",17),b.fc("click",(function(){return t.mark("overlay")})),b.Rb(34,"span"),b.bc(35,sn),b.Kc(36,hn,2,1,"ng-container",18),b.Yb(),b.Qb(),b.Qb(),b.Rb(37,"button",17),b.fc("click",(function(){return t.mark("holdTransfer")})),b.Rb(38,"span"),b.bc(39,ln),b.Kc(40,fn,2,1,"ng-container",18),b.Yb(),b.Qb(),b.Qb(),b.Rb(41,"button",17),b.fc("click",(function(){return t.mark("holdingTransfer")})),b.Rb(42,"span"),b.bc(43,bn),b.Kc(44,un,2,1,"ng-container",18),b.Yb(),b.Qb(),b.Qb(),b.Rb(45,"button",17),b.fc("click",(function(){return t.clearMarks()})),b.Rb(46,"span"),b.Vb(47,cn),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(48,"div",11),b.Rb(49,"button",19),b.Vb(50,an),b.Qb(),b.Rb(51,"div",20),b.Rb(52,"button",17),b.fc("click",(function(){return b.Bc(e),b.zc(10).open({size:"lg"})})),b.Rb(53,"span"),b.Vb(54,on),b.Qb(),b.Qb(),b.Rb(55,"a",14),b.Rb(56,"span"),b.Vb(57,rn),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb()}2&e&&(b.xb(9),b.oc("itemIds",b.uc(9,gn,t.recId)),b.xb(3),b.oc("queryParams",b.uc(11,pn,t.recId)),b.xb(9),b.qc("href","/eg/staff/serials/",t.recId,"",b.Ec),b.xb(2),b.qc("href","/eg/staff/serials/",t.recId,"/manage-mfhds",b.Ec),b.xb(9),b.oc("ngIf",t.targets.conjoined.current),b.xb(4),b.oc("ngIf",t.targets.overlay.current),b.xb(4),b.oc("ngIf",t.targets.holdTransfer.current),b.xb(4),b.oc("ngIf",t.targets.holdingTransfer.current),b.xb(11),b.qc("href","/eg/staff/acq/legacy/lineitem/related/",t.recId,"?target=bib",b.Ec))},directives:[_.a,le.a,r.f,m.l,m.p,m.o,u.v],encapsulation:2}),e})();const Rn=["copyGrid"],yn=["label",$localize`:␟27e0b1e650bef276e8c29dd8d547e3fc8c4f833f␟194067946846246769:Item ID`],xn=["label",$localize`:␟ed31c09fd77c36238c13d83635f3fe5294c733d2␟471816275243265264:Location`],vn=["label",$localize`:␟f16c2aa6403282c2e085754bb88a455b90a4ac33␟4488968375845802506:Call Number / Item Notes`],Cn=["label",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`],Qn=["label",$localize`:␟5e3e384df062924aa75d2f5ca826e1e077372153␟8734320241258430920:Shelving Location`],In=["label",$localize`:␟172a27bb1b7db1ef4a56779c6dcdc20a602a16e7␟3860933437516464957:Circulation Modifier`],_n=["label",$localize`:␟1447f7768ab20b9a1c3d506aa8cb27cf335e2ef9␟8615389546889015621:Age Hold Protection`],Sn=["label",$localize`:␟78d8c573992fc570520af8c7db1785b83cb8fd82␟2119215820561494041:Active/Create Date`],Tn=["label",$localize`:␟a8a65a848ce359ae4137efb842f00190e656370c␟5460489461219302985:Holdable?`],kn=["label",$localize`:␟81b97b8ea996ad1e4f9fca8415021850214884b1␟5611592591303869712:Status`],$n=["label",$localize`:␟2e8989faee1f152aa7c8ef12fb79e49c29da9390␟1917979079769004212:Due Date`];function wn(e,t){if(1&e&&b.Mc(0),2&e){const e=t.row;b.Qc(" ",e.call_number_prefix_label," ",e.call_number_label," ",e.call_number_suffix_label,"\n")}}var Mn,Nn,On,zn;function Pn(e,t){if(1&e&&(b.Rb(0,"div"),b.Mc(1),b.Qb(),b.Rb(2,"div"),b.Rb(3,"a",19),b.Vb(4,Mn),b.Qb(),b.Mc(5," | "),b.Rb(6,"a",19),b.Vb(7,Nn),b.Qb(),b.Qb()),2&e){const e=t.row;b.xb(1),b.Nc(e.barcode),b.xb(2),b.qc("href","/eg/staff/cat/item/",e.id,"",b.Ec),b.xb(3),b.qc("href","/eg/staff/cat/item/",e.id,"/edit",b.Ec)}}Mn=$localize`:␟6829218544e108e152f5fa72cb79c4ccb82e0d06␟2509141182388535183:View`,Nn=$localize`:␟28f86ffd419b869711aa13f5e5ff54be6d70731c␟7585826646011739428:Edit`,On=$localize`:␟162451de3f4267fc19a6b8c04b680e0d08d04cd1␟7005237229114856893: Item Hold `,zn=$localize`:␟71870e860d25745b1cb77d647fda21ee67e82ac5␟6372643429582651317: Call Number Hold `;const Ln=function(e){return{target:e}};function An(e,t){if(1&e&&(b.Rb(0,"span"),b.Rb(1,"div",21),b.Rb(2,"a",22),b.Vb(3,On),b.Qb(),b.Qb(),b.Rb(4,"div"),b.Rb(5,"a",23),b.Vb(6,zn),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc().row;b.xb(2),b.oc("queryParams",b.uc(2,Ln,e.id)),b.xb(3),b.oc("queryParams",b.uc(4,Ln,e.call_number))}}var Bn;function En(e,t){1&e&&(b.Rb(0,"span"),b.Vb(1,Bn),b.Qb())}function Dn(e,t){if(1&e&&(b.Kc(0,An,7,6,"span",20),b.Kc(1,En,2,0,"span",20)),2&e){const e=t.row,c=t.userContext;b.oc("ngIf",c.holdable(e)),b.xb(1),b.oc("ngIf",!c.holdable(e))}}function Fn(e,t){if(1&e&&(b.Rb(0,"div"),b.Rb(1,"a",25),b.Mc(2),b.Qb(),b.Qb()),2&e){const e=t.$implicit;b.xb(1),b.qc("routerLink","/staff/admin/local/asset/course_list/",e.id(),""),b.xb(1),b.Oc(" ",e.course_number()," ")}}function Vn(e,t){1&e&&b.Kc(0,Fn,3,2,"div",24),2&e&&b.oc("ngForOf",t.row._courses)}Bn=$localize`:␟3d3ae7deebc5949b0c1c78b9847886a94321d9fd␟3542042671420335679:No`;const Kn=["label",$localize`:␟b7a285515e41f0c8038d8b8e65b5199cb9928681␟8317457230285174180:Course`];function Xn(e,t){if(1&e&&(b.Rb(0,"eg-grid-column",26),b.Xb(1,Kn),b.Qb()),2&e){b.hc();const e=b.zc(7);b.oc("cellTemplate",e)}}let Gn=(()=>{class e{constructor(e,t,c,a,o){this.course=e,this.net=t,this.org=c,this.staffCat=a,this.broadcaster=o,this.initDone=!1,this.usingCourseModule=!1,this.gridDataSource=new lo.c}set recordId(e){this.recId=e,this.initDone&&this.copyGrid.reload()}ngOnInit(){this.initDone=!0,this.course.isOptedIn().then(e=>{this.usingCourseModule=e}),this.gridDataSource.getRows=(e,t)=>this.fetchCopies(e),this.copyContext={holdable:e=>"t"===e.holdable&&"t"===e.location_holdable&&"t"===e.status_holdable},this.cellTextGenerator={callnumber:e=>(e.call_number_prefix_label+" "+`${e.call_number_label} ${e.call_number_suffix_label}`).trim(),holdable:e=>this.copyContext.holdable(e),barcode:e=>e.barcode},this.broadcaster.listen("eg.holdings.update").subscribe(e=>{e&&e.records&&e.records.includes(this.recId)&&this.copyGrid.reload()})}orgName(e){return this.org.get(e).shortname()}fetchCopies(e){if(!this.recId)return Object(ro.a)([]);const t=this.staffCat.searchContext.global?this.org.root().ou_type().depth():this.staffCat.searchContext.searchOrg.ou_type().depth();return this.net.request("open-ils.search","open-ils.search.bib.copies.staff",this.recId,this.staffCat.searchContext.searchOrg.id(),t,e.limit,e.offset,this.staffCat.prefOrg?this.staffCat.prefOrg.id():null).pipe(Object(no.a)(e=>(this.org.settings("circ.course_materials_opt_in").then(t=>{t["circ.course_materials_opt_in"]&&this.course.getCoursesFromMaterial(e.id).then(t=>{e._courses=t})}),e.active_date=e.active_date||e.create_date,e)))}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(oa.a),b.Lb(ie.b),b.Lb(i.a),b.Lb(d),b.Lb(Ko.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-copies"]],viewQuery:function(e,t){var c;1&e&&b.Ic(Rn,!0),2&e&&b.yc(c=b.gc())&&(t.copyGrid=c.first)},inputs:{recordId:"recordId"},decls:34,vars:11,consts:[["cnTemplate",""],["barcodeTemplate",""],["holdableTemplate",""],["courseTemplate",""],[1,"eg-copies","w-100","mt-3"],["persistKey","catalog.record.copies",3,"dataSource","disableSelect","cellTextGenerator","sortable"],["copyGrid",""],["path","id",3,"hidden","index",6,"label"],["path","circ_lib","datatype","org_unit",6,"label"],["name","callnumber",3,"cellTemplate",6,"label"],["name","barcode",3,"cellTemplate",6,"label"],["path","copy_location",6,"label"],["path","circ_modifier",6,"label"],["path","age_protect",6,"label"],["path","active_date","datatype","timestamp",6,"label"],["name","holdable",3,"cellTemplate","cellContext",6,"label"],["name","course",3,"cellTemplate",4,"ngIf",6,"label"],["path","copy_status",6,"label"],["path","due_date","datatype","timestamp",6,"label"],["target","_blank",1,"pl-1",3,"href"],[4,"ngIf"],[1,"border-bottom"],["routerLink","/staff/catalog/hold/C","queryParamsHandling","merge",3,"queryParams"],["routerLink","/staff/catalog/hold/V","queryParamsHandling","merge",3,"queryParams"],[4,"ngFor","ngForOf"],[3,"routerLink"],["name","course",3,"cellTemplate",6,"label"]],template:function(e,t){if(1&e&&(b.Kc(0,wn,1,3,"ng-template",null,0,b.Lc),b.Kc(2,Pn,8,3,"ng-template",null,1,b.Lc),b.Kc(4,Dn,2,2,"ng-template",null,2,b.Lc),b.Kc(6,Vn,1,1,"ng-template",null,3,b.Lc),b.Rb(8,"div",4),b.Rb(9,"eg-grid",5,6),b.Rb(11,"eg-grid-column",7),b.Xb(12,yn),b.Qb(),b.Rb(13,"eg-grid-column",8),b.Xb(14,xn),b.Qb(),b.Rb(15,"eg-grid-column",9),b.Xb(16,vn),b.Qb(),b.Rb(17,"eg-grid-column",10),b.Xb(18,Cn),b.Qb(),b.Rb(19,"eg-grid-column",11),b.Xb(20,Qn),b.Qb(),b.Rb(21,"eg-grid-column",12),b.Xb(22,In),b.Qb(),b.Rb(23,"eg-grid-column",13),b.Xb(24,_n),b.Qb(),b.Rb(25,"eg-grid-column",14),b.Xb(26,Sn),b.Qb(),b.Rb(27,"eg-grid-column",15),b.Xb(28,Tn),b.Qb(),b.Kc(29,Xn,2,1,"eg-grid-column",16),b.Rb(30,"eg-grid-column",17),b.Xb(31,kn),b.Qb(),b.Rb(32,"eg-grid-column",18),b.Xb(33,$n),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.zc(1),c=b.zc(3),a=b.zc(5);b.xb(9),b.oc("dataSource",t.gridDataSource)("disableSelect",!0)("cellTextGenerator",t.cellTextGenerator)("sortable",!1),b.xb(2),b.oc("hidden",!0)("index",!0),b.xb(4),b.oc("cellTemplate",e),b.xb(2),b.oc("cellTemplate",c),b.xb(10),b.oc("cellTemplate",a)("cellContext",t.copyContext),b.xb(2),b.oc("ngIf",t.usingCourseModule)}},directives:[bo.a,Go.a,u.v,r.f,u.u],encapsulation:2}),e})();var Hn,qn=c("2XLs"),Un=c("4uox"),jn=c("wN9v"),Yn=c("UUQ6");Hn=$localize`:␟6991b44dc86e56c98d8f421324abb0e6ac3a5ea9␟9078873786201586368:Merge Monograph Parts`;const Wn=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var Zn,Jn,es;function ts(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",10),b.Rb(1,"div",11),b.Rb(2,"div",12),b.Rb(3,"input",13),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc(2).leadPart=t})),b.Qb(),b.Rb(4,"label",14),b.Mc(5),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=t.$implicit,c=b.hc(2);b.xb(3),b.pc("value",e.id()),b.oc("ngModel",c.leadPart),b.xb(2),b.Nc(e.label())}}function cs(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",1),b.Rb(1,"h4",2),b.Vb(2,Hn),b.Qb(),b.Rb(3,"button",3),b.Xb(4,Wn),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Rb(5,"span",4),b.Mc(6,"\xd7"),b.Qb(),b.Qb(),b.Qb(),b.Rb(7,"div",5),b.Rb(8,"h5"),b.Vb(9,Zn),b.Qb(),b.Kc(10,ts,6,3,"div",6),b.Qb(),b.Rb(11,"div",7),b.Rb(12,"button",8),b.fc("click",(function(){return b.Bc(e),b.hc().mergeParts()})),b.Vb(13,Jn),b.Qb(),b.Rb(14,"button",9),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Vb(15,es),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(10),b.oc("ngForOf",e.parts)}}Zn=$localize`:␟be9878595e267a1394def0391c41dbf1f41a273b␟4890338651503073033:Select a Lead Part`,Jn=$localize`:␟7f8e64261497f0b38cfb8aa12b8f77cbb01a179b␟3206542606001340679:Merge`,es=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`;let as=(()=>{class e extends v.a{constructor(e,t,c){super(c),this.idl=e,this.pcrud=t,this.modal=c}mergeParts(){if(console.log("Merging parts into lead part ",this.leadPart),!this.leadPart)return;this.leadPart=Number(this.leadPart);const e=this.parts.filter(e=>Number(e.id())!==this.leadPart).map(e=>Number(e.id())),t=[];this.pcrud.search("acpm",{part:e}).subscribe(e=>{e.part(this.leadPart),e.ischanged(!0),t.push(e)},e=>{},()=>{t.length>0?this.pcrud.autoApply(t).toPromise().then(()=>this.deleteParts()):this.deleteParts()})}deleteParts(){const e=this.parts.filter(e=>Number(e.id())!==this.leadPart);e.forEach(e=>e.isdeleted(!0)),this.pcrud.autoApply(e).toPromise().then(e=>this.close(e))}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(so.a),b.Lb(Nc.a),b.Lb(m.s))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-part-merge-dialog"]],features:[b.ub],decls:2,vars:0,consts:[["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],["class","row",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],[1,"row"],[1,"col-lg-10","offset-lg-1"],[1,"form-check"],["type","radio","name","lead",1,"form-check-input",3,"value","ngModel","ngModelChange"],[1,"form-check-label"]],template:function(e,t){1&e&&b.Kc(0,cs,16,1,"ng-template",null,0,b.Lc)},directives:[u.u,p.B,p.c,p.t,p.w],encapsulation:2}),e})();var os=c("eXX1");const rs=["partsGrid"],is=["editDialog"],ns=["mergeDialog"],ss=["label",$localize`:␟ed0ad03571d933aa70d713e8c9fde395a5132b80␟4140562699563658426:New Monograph Part`],ls=["label",$localize`:␟d2ef8081970bfa9f556bd5a386dff5b41d6572a8␟5393432850392471631:Merge Selected`],bs=["label",$localize`:␟96e678d5f4bfe1a041ecfcd34804efa5e100d5e8␟5167284364083276913:Delete Selected`];let ds=(()=>{class e{constructor(e,t,c,a){this.idl=e,this.org=t,this.pcrud=c,this.perm=a,this.permissions={},this.gridDataSource=new lo.c}set recordId(e){this.recId=e,this.initDone&&this.partsGrid.reload()}get recordId(){return this.recId}ngOnInit(){this.initDone=!0,this.perm.hasWorkPermHere(["CREATE_MONOGRAPH_PART","UPDATE_MONOGRAPH_PART","DELETE_MONOGRAPH_PART"]).then(e=>this.permissions=e),this.gridDataSource.getRows=(e,t)=>{const c={};return c.bmp=t.length?t[0].name+" "+t[0].dir:"label",this.pcrud.search("bmp",{record:this.recId,deleted:"f"},{offset:e.offset,limit:e.limit,order_by:c})},this.partsGrid.onRowActivate.subscribe(e=>{this.editDialog.mode="update",this.editDialog.recordId=e.id(),this.editDialog.open().subscribe(e=>this.partsGrid.reload())}),this.createNew=()=>{const e=this.idl.create("bmp");e.record(this.recordId),this.editDialog.record=e,this.editDialog.mode="create",this.editDialog.open().subscribe(e=>this.partsGrid.reload())},this.deleteSelected=e=>{e.forEach(e=>e.isdeleted(!0)),this.pcrud.autoApply(e).subscribe(e=>console.debug("deleted: "+e),e=>{},()=>this.partsGrid.reload())},this.mergeSelected=e=>{e.length<2||(this.mergeDialog.parts=e,this.mergeDialog.open().subscribe(e=>this.partsGrid.reload()))}}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(so.a),b.Lb(i.a),b.Lb(Nc.a),b.Lb(jn.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-record-parts"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(rs,!0),b.Ic(is,!0),b.Ic(ns,!0)),2&e&&(b.yc(c=b.gc())&&(t.partsGrid=c.first),b.yc(c=b.gc())&&(t.editDialog=c.first),b.yc(c=b.gc())&&(t.mergeDialog=c.first))},inputs:{recordId:"recordId"},decls:13,vars:6,consts:[["mergeDialog",""],[1,"mt-3"],["idlClass","bmp","persistKey","catalog.record.parts","showFields","id,label",1,"mt-3",3,"dataSource","sortable"],["partsGrid",""],[3,"disabled","action",6,"label"],[3,"action",6,"label"],["idlClass","bmp","hiddenFields","record,label_sortkey,deleted"],["editDialog",""]],template:function(e,t){1&e&&(b.Mb(0,"eg-catalog-part-merge-dialog",null,0),b.Rb(2,"div",1),b.Rb(3,"eg-grid",2,3),b.Rb(5,"eg-grid-toolbar-button",4),b.Xb(6,ss),b.Qb(),b.Rb(7,"eg-grid-toolbar-action",5),b.Xb(8,ls),b.Qb(),b.Rb(9,"eg-grid-toolbar-action",5),b.Xb(10,bs),b.Qb(),b.Qb(),b.Mb(11,"eg-fm-record-editor",6,7),b.Qb()),2&e&&(b.xb(3),b.oc("dataSource",t.gridDataSource)("sortable",!0),b.xb(2),b.oc("disabled",!t.permissions.CREATE_MONOGRAPH_PART)("action",t.createNew),b.xb(2),b.oc("action",t.mergeSelected),b.xb(2),b.oc("action",t.deleteSelected))},directives:[as,bo.a,os.a,Xo.a,Yn.a],encapsulation:2}),e})();const hs=["conjoinedGrid"],fs=["conjoinedDialog"],us=["confirmUnlink"],gs=["dialogTitle",$localize`:␟b2e9d1abebe3cbac82dcf9526370ea2c5b3e2a50␟1483279394152487973:Confirm Unlink`,"dialogBody",$localize`:␟c0841fe63ff8bbffe0a8df5e6951c83de762e2b4␟8239673116545752108:Unlink ${"\ufffd0\ufffd"}:INTERPOLATION: Items?`],ps=["label",$localize`:␟acaaf9471652fdd0b8dd96dba8a060a0582f4026␟7192703482932328770:Change Type`],ms=["label",$localize`:␟b4c7b8ed9a734473143ebde10fb034c29ec483fd␟4658982717700339898:Unlink`];let Rs=(()=>{class e{constructor(e,t,c,a){this.idl=e,this.org=t,this.pcrud=c,this.perm=a,this.gridDataSource=new lo.c,this.idsToUnlink=[]}ngOnInit(){this.perm.hasWorkPermHere(["UPDATE_COPY"]).then(e=>this.hasPerm=e.UPDATE_COPY),this.gridDataSource.getRows=(e,t)=>{const c={};return c.bmp=t.length?t[0].name+" "+t[0].dir:"id",this.pcrud.search("bpbcm",{peer_record:this.recordId},{offset:e.offset,limit:e.limit,order_by:c},{fleshSelectors:!0})}}unlink(e){return t=this,void 0,a=function*(){this.idsToUnlink=e.map(e=>e.target_copy().id()),0!==this.idsToUnlink.length&&this.confirmUnlink.open({size:"sm"}).subscribe(e=>{if(!e)return;const t=[];this.pcrud.search("bpbcm",{target_copy:this.idsToUnlink,peer_record:this.recordId}).subscribe(e=>t.push(e),e=>{},()=>{this.pcrud.remove(t).subscribe(e=>console.debug("deleted map ",e),e=>console.error(e),()=>{this.idsToUnlink=[],this.grid.reload()})})})},new((c=void 0)||(c=Promise))((function(e,o){function r(e){try{n(a.next(e))}catch(t){o(t)}}function i(e){try{n(a.throw(e))}catch(t){o(t)}}function n(t){var a;t.done?e(t.value):(a=t.value,a instanceof c?a:new c((function(e){e(a)}))).then(r,i)}n((a=a.apply(t,[])).next())}));var t,c,a}openConjoinedDialog(){this.conjoinedDialog.open({size:"sm"}).subscribe(e=>{e&&this.grid.reload()})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(so.a),b.Lb(i.a),b.Lb(Nc.a),b.Lb(jn.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-record-conjoined"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(hs,!0),b.Ic(fs,!0),b.Ic(us,!0)),2&e&&(b.yc(c=b.gc())&&(t.grid=c.first),b.yc(c=b.gc())&&(t.conjoinedDialog=c.first),b.yc(c=b.gc())&&(t.confirmUnlink=c.first))},inputs:{recordId:"recordId"},decls:12,vars:7,consts:[[3,"peerRecord","modifyAll"],["conjoinedDialog",""],[6,"dialogTitle","dialogBody"],["confirmUnlink",""],[1,"mt-3"],["idlClass","bpbcm","persistKey","catalog.record.conjoined",1,"mt-3",3,"dataSource","sortable"],["conjoinedGrid",""],[3,"disabled","onClick",6,"label"]],template:function(e,t){1&e&&(b.Mb(0,"eg-conjoined-items-dialog",0,1),b.Rb(2,"eg-confirm-dialog",2,3),b.Xb(4,gs),b.Qb(),b.Rb(5,"div",4),b.Rb(6,"eg-grid",5,6),b.Rb(8,"eg-grid-toolbar-button",7),b.Xb(9,ps),b.fc("onClick",(function(){return t.openConjoinedDialog()})),b.Qb(),b.Rb(10,"eg-grid-toolbar-action",7),b.Xb(11,ms),b.fc("onClick",(function(e){return t.unlink(e)})),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.oc("peerRecord",t.recordId)("modifyAll",!0),b.xb(2),b.Zb(t.idsToUnlink.length),b.Wb(4),b.xb(4),b.oc("dataSource",t.gridDataSource)("sortable",!0),b.xb(2),b.oc("disabled",!t.hasPerm),b.xb(2),b.oc("disabled",!t.hasPerm))},directives:[yo.a,C.a,bo.a,os.a,Xo.a],encapsulation:2}),e})();var ys,xs;function vs(e,t){1&e&&(b.Rb(0,"div",3),b.Rb(1,"div",4),b.Rb(2,"div",5),b.Rb(3,"div",6),b.Rb(4,"span",7),b.Vb(5,ys),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}function Cs(e,t){1&e&&(b.Rb(0,"div"),b.Rb(1,"div",8),b.Rb(2,"div",9),b.Rb(3,"div",10),b.Rb(4,"span"),b.Vb(5,xs),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}ys=$localize`:␟ec967aea6202d50552ab385751214fcb816e7218␟3926189656918144187:Searching..`,xs=$localize`:␟6b90aaee4294ccb5e34a4413ebe3f4649d70167f␟5773175567567821732:No Maching Items Were Found`;const Qs=function(e){return{"border-primary":e}};function Is(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",19),b.Rb(2,"div",13),b.Rb(3,"div",20),b.Mc(4),b.Qb(),b.Rb(5,"div"),b.Rb(6,"a",21),b.Mc(7),b.Qb(),b.Qb(),b.Rb(8,"div"),b.Rb(9,"a",22),b.Mc(10),b.Qb(),b.Qb(),b.Qb(),b.Rb(11,"div",23),b.Mb(12,"img",24),b.Qb(),b.Qb(),b.Ob()),2&e){const e=b.hc(),t=e.index,c=e.$implicit,a=b.hc().$implicit,o=b.hc(3);b.xb(1),b.oc("ngClass",b.uc(10,Qs,o.isCenter(a,t))),b.xb(3),b.Rc(" ",c.prefix().label()," ",c.label()," ",c.suffix().label()," @ ",o.orgName(c.owning_lib())," "),b.xb(2),b.qc("routerLink","/staff/catalog/record/",c._bibSummary.id,""),b.xb(1),b.Oc(" ",c._bibSummary.display.title," "),b.xb(2),b.oc("queryParams",o.getAuthorSearchParams(c._bibSummary)),b.xb(1),b.Oc(" ",c._bibSummary.display.author," "),b.xb(2),b.qc("src","/opac/extras/ac/jacket/small/r/",c._bibSummary.id,"",b.Ec)}}function _s(e,t){if(1&e&&(b.Pb(0),b.Kc(1,Is,13,12,"ng-container",1),b.Ob()),2&e){const e=t.$implicit;b.xb(1),b.oc("ngIf",e._bibSummary)}}function Ss(e,t){if(1&e&&(b.Rb(0,"div",17),b.Kc(1,_s,2,1,"ng-container",18),b.Qb()),2&e){const e=t.$implicit,c=b.hc(3);b.xb(1),b.oc("ngForOf",c.resultSlice(e))}}function Ts(e,t){if(1&e&&(b.Pb(0),b.Kc(1,Ss,2,1,"div",16),b.Ob()),2&e){const e=b.hc(2);b.xb(1),b.oc("ngForOf",e.rowIndexList)}}function ks(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",11),b.Rb(1,"div",12),b.Mb(2,"div",13),b.Rb(3,"div"),b.Rb(4,"button",14),b.fc("click",(function(){return b.Bc(e),b.hc().prevPage()})),b.Mc(5,"Back"),b.Qb(),b.Rb(6,"button",15),b.fc("click",(function(){return b.Bc(e),b.hc().nextPage()})),b.Mc(7,"Next"),b.Qb(),b.Qb(),b.Qb(),b.Kc(8,Ts,2,1,"ng-container",1),b.Rb(9,"div",12),b.Mb(10,"div",13),b.Rb(11,"div"),b.Rb(12,"button",14),b.fc("click",(function(){return b.Bc(e),b.hc().prevPage()})),b.Mc(13,"Back"),b.Qb(),b.Rb(14,"button",15),b.fc("click",(function(){return b.Bc(e),b.hc().nextPage()})),b.Mc(15,"Next"),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(8),b.oc("ngIf",e.results&&e.results.length)}}let $s=(()=>{class e{constructor(e,t,c,a,o,r,i,n){this.router=e,this.route=t,this.org=c,this.pcrud=a,this.cat=o,this.bib=r,this.catUrl=i,this.staffCat=n,this.rowCount=5,this.rowIndexList=[],this.colCount=3,this.results=[]}ngOnInit(){this.searchContext=this.staffCat.searchContext,this.bibSummary&&(this.searchContext=this.staffCat.cloneContext(this.searchContext));for(let t=0;t<this.rowCount;t++)this.rowIndexList.push(t);let e=Promise.resolve();this.bibSummary&&(e=this.getBrowseCallnumber()),e.then(e=>{this.routeSub=this.route.queryParamMap.subscribe(e=>this.browseByUrl(e))})}ngOnDestroy(){this.routeSub.unsubscribe()}getBrowseCallnumber(){let e=this.searchContext.searchOrg.id();return"f"===this.searchContext.searchOrg.ou_type().can_have_vols()&&(e=this.org.descendants(this.searchContext.searchOrg,!0)),this.pcrud.search("acn",{record:this.bibSummary.id,owning_lib:e},{limit:1}).toPromise().then(e=>this.browseCn=e?e.label():this.bibSummary.bibCallNumber)}browseByUrl(e){this.catUrl.applyUrlParams(this.searchContext,e),this.getBrowseResults()}getBrowseResults(){const e=this.searchContext.cnBrowseSearch;e.limit=this.rowCount*this.colCount,this.browseCn&&(e.value=this.browseCn),e.isSearchable()&&(this.results=[],this.cat.cnBrowse(this.searchContext).subscribe(e=>this.processResults(e)))}processResults(e){this.results=e,this.searchContext.global?this.searchContext.org.root().ou_type().depth():this.searchContext.searchOrg.ou_type().depth();const t=this.results.map(e=>e.record().id()),c=[];this.bib.getBibSummaries(t.filter((e,t,c)=>c.indexOf(e)===t),this.searchContext.searchOrg.id(),this.searchContext.isStaff).subscribe(e=>{const t=this.results.filter(t=>Number(t.record().id())===e.id);c.push(e.record),t.forEach(t=>t._bibSummary=e)})}browseIsDone(){return this.searchContext.searchState===g.c.COMPLETE}browseIsActive(){return this.searchContext.searchState===g.c.SEARCHING}browseHasResults(){return this.browseIsDone()&&this.results.length>0}prevPage(){this.searchContext.cnBrowseSearch.offset--,this.bibSummary?this.getBrowseResults():this.staffCat.cnBrowse()}nextPage(){this.searchContext.cnBrowseSearch.offset++,this.bibSummary?this.getBrowseResults():this.staffCat.cnBrowse()}navigateToRecord(e){const t=this.catUrl.toUrlParams(this.searchContext);this.router.navigate(["/staff/catalog/record/"+e.id],{queryParams:t})}resultSlice(e){const t=e*this.colCount;return this.results.slice(t,t+this.colCount)}isCenter(e,t){return Math.floor(this.rowCount*this.colCount/2)===e*this.colCount+t}orgName(e){return this.org.get(e).shortname()}getAuthorSearchParams(e){return this.staffCat.getAuthorSearchParams(e)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(r.a),b.Lb(i.a),b.Lb(Nc.a),b.Lb(n.a),b.Lb(Mc.a),b.Lb(s.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-cn-browse-results"]],inputs:{bibSummary:"bibSummary",rowCount:"rowCount"},decls:3,vars:3,consts:[["class","row",4,"ngIf"],[4,"ngIf"],["id","staff-catalog-browse-results-container",4,"ngIf"],[1,"row"],[1,"col-lg-6","offset-lg-3","pt-3"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","active","w-100"],[1,"sr-only"],[1,"row","pt-3"],[1,"col-lg-6","offset-lg-3"],[1,"alert","alert-warning"],["id","staff-catalog-browse-results-container"],[1,"row","mb-2","d-flex"],[1,"flex-1"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","ml-3",3,"click"],["class","row mb-3",4,"ngFor","ngForOf"],[1,"row","mb-3"],[4,"ngFor","ngForOf"],[1,"col-lg-4","pt-2","d-flex","border",3,"ngClass"],[1,"font-weight-bold"],["queryParamsHandling","merge",3,"routerLink"],["routerLink","/staff/catalog/search",3,"queryParams"],[1,"ml-2"],[3,"src"]],template:function(e,t){1&e&&(b.Kc(0,vs,6,0,"div",0),b.Kc(1,Cs,6,0,"div",1),b.Kc(2,ks,16,1,"div",2)),2&e&&(b.oc("ngIf",t.browseIsActive()),b.xb(1),b.oc("ngIf",t.browseIsDone()&&!t.browseHasResults()),b.xb(1),b.oc("ngIf",t.browseHasResults()))},directives:[u.v,u.u,u.s,r.f],encapsulation:2}),e})();var ws=c("jhN1");function Ms(e,t){1&e&&(b.Rb(0,"div",2),b.Rb(1,"div"),b.Mb(2,"img",3),b.Qb(),b.Qb())}function Ns(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"iframe",4),b.fc("load",(function(){return b.Bc(e),b.hc().handleLoad()})),b.Qb(),b.Ob()}if(2&e){const e=b.hc();b.xb(1),b.oc("src",e.url,b.Dc)}}let Os=(()=>{class e{constructor(e,t){this.sanitizer=e,this.renderer=t}set recordId(e){e&&(e+"").match(/^\d+$/)?(this._recordId=e,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(`/eg/opac/record/${e}?readonly=1`)):(this._recordId=null,this.url=null)}get recordId(){return this._recordId}handleLoad(){const e=this.renderer.selectRootElement("#opac-iframe");e.style.height=50+e.contentWindow.document.body.offsetHeight+"px",this.loaded=!0}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(ws.b),b.Lb(b.D))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-opac-record-detail"]],inputs:{recordId:"recordId"},decls:2,vars:2,consts:[["class","m-3 p-3 d-flex justify-content-center",4,"ngIf"],[4,"ngIf"],[1,"m-3","p-3","d-flex","justify-content-center"],["src","/images/progressbar_green.gif"],["id","opac-iframe",1,"w-100",3,"src","load"]],template:function(e,t){1&e&&(b.Kc(0,Ms,3,0,"div",0),b.Kc(1,Ns,2,1,"ng-container",1)),2&e&&(b.oc("ngIf",!t.loaded),b.xb(1),b.oc("ngIf",t.url))},directives:[u.v],encapsulation:2}),e})();const zs=["recordTabs"],Ps=["marcEditor"],Ls=["holdingsMaint"],As=["pendingChangesDialog"],Bs=["dialogTitle",$localize`:␟f894e7a4728d4d02afeaa5891f754af3a9c4eb45␟1733377437659896047:Unsaved Changes Confirmation`];var Es;Es=$localize`:␟4bbab2a67828f5bc387f46a9e33eb1b316ab4665␟6398483646371730954:Set Default View`;const Ds=["title",$localize`:␟8438cc248ffb2d58055670782dc893a27a741bc2␟6800646407313608680:Item Table`],Fs=["title",$localize`:␟ea24d46edb5cf242c837b0c30fa48e836a9debd3␟7401408585573769247:MARC Edit`],Vs=["title",$localize`:␟fe8f623b7eca80bb13376905859627862b2e22c3␟1268293833023686375:MARC View`],Ks=["title",$localize`:␟9830fd823147afcc7ffb24018cfd42612c666e56␟4305313550625921198:View Holds`],Xs=["title",$localize`:␟d875ccf5ff281d683a8333b45deee27a34d1ef38␟2894992761987054993:Monograph Parts`],Gs=["title",$localize`:␟8797ca1cc22189746ad7347aad5b1b2ff96c9fe9␟3292592493609530007:Holdings View`],Hs=["title",$localize`:␟601ceb7899efa6229c5a4317ff02d93b6f71e159␟6267583962306748826:Conjoined Items`],qs=["title",$localize`:␟b9eacc9896094e2bec84e875a25e959f36448f85␟1380690145177345961:Shelf Browse`],Us=["title",$localize`:␟d3bd4c16efa9e2ec41c90212512434d2bde4b018␟9039828918082604066:Patron View`],js=["prefix",$localize`:␟1d883f5e257d8585eedcb823bd562f8af4efe9df␟2618235011685825700:Bib ${"\ufffd0\ufffd"}:INTERPOLATION: - ${"\ufffd1\ufffd"}:INTERPOLATION_1:`];function Ys(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"eg-title",27),b.Xb(2,js),b.Qb(),b.Ob()),2&e){const e=b.hc();b.xb(1),b.Zb(e.summary.record.tcn_value())(e.summary.display.title),b.Wb(2)}}function Ws(e,t){if(1&e&&b.Mb(0,"eg-catalog-copies",28),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}function Zs(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",29),b.Rb(1,"eg-marc-editor",30,31),b.fc("recordSaved",(function(){return b.Bc(e),b.hc().handleMarcRecordSaved()})),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(1),b.oc("recordId",e.recordId)}}function Js(e,t){if(1&e&&b.Mb(0,"eg-marc-html",32),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}const el=function(){return{name:"request_time",dir:"asc"}},tl=function(e){return[e]};function cl(e,t){if(1&e&&b.Mb(0,"eg-holds-grid",33),2&e){const e=b.hc();b.oc("recordId",e.recordId)("defaultSort",b.uc(4,tl,b.tc(3,el)))("initialPickupLib",e.currentSearchOrg())}}function al(e,t){if(1&e&&b.Mb(0,"eg-catalog-record-parts",28),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}function ol(e,t){if(1&e&&b.Mb(0,"eg-holdings-maintenance",28,34),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}function rl(e,t){if(1&e&&b.Mb(0,"eg-catalog-record-conjoined",28),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}function il(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",35),b.Mb(2,"eg-catalog-cn-browse-results",5),b.Qb(),b.Ob()),2&e){const e=b.hc(2);b.xb(2),b.oc("bibSummary",e.summary)}}function nl(e,t){if(1&e&&b.Kc(0,il,3,1,"ng-container",0),2&e){const e=b.hc();b.oc("ngIf",e.summary)}}function sl(e,t){if(1&e&&b.Mb(0,"eg-opac-record-detail",28),2&e){const e=b.hc();b.oc("recordId",e.recordId)}}let ll=(()=>{class e{constructor(e,t,c,a,o,r,i,n,s){this.router=e,this.route=t,this.pcrud=c,this.auth=a,this.bib=o,this.cat=r,this.staffCat=i,this.holdings=n,this.store=s}ngOnInit(){this.searchContext=this.staffCat.searchContext,this.defaultTab=this.store.getLocalItem("eg.cat.default_record_tab")||"item_table",this.route.paramMap.subscribe(e=>{this.recordTab=e.get("tab"),this.recordId=+e.get("id"),this.searchContext=this.staffCat.searchContext,this.recordTab||(this.recordTab=this.defaultTab||"item_table"),this.loadRecord()})}setDefaultTab(){this.defaultTab=this.recordTab,this.store.setLocalItem("eg.cat.default_record_tab",this.recordTab)}beforeTabChange(e){e.preventDefault(),this.canDeactivate().then(t=>{t&&(this.recordTab=e.nextId,this.routeToTab())})}canDeactivate(e){return this.marcEditor&&this.marcEditor.changesPending()?(this.marcEditor.clearPendingChanges(),e?(e.preventDefault(),void(e.returnValue=!0)):this.pendingChangesDialog.open().toPromise()):Promise.resolve(!0)}routeToTab(){this.router.navigate([`/staff/catalog/record/${this.recordId}/${this.recordTab}`],{queryParamsHandling:"merge"})}loadRecord(){this.staffCat.currentDetailRecordSummary&&this.recordId===this.staffCat.currentDetailRecordSummary.id?this.summary=this.staffCat.currentDetailRecordSummary:(this.summary=null,this.bib.getBibSummary(this.recordId,this.searchContext.searchOrg.id(),this.searchContext.searchOrg.ou_type().depth()).toPromise().then(e=>{this.summary=this.staffCat.currentDetailRecordSummary=e}))}summaryForDisplay(){if(!this.summary)return null;const e=this.summary,t=this.searchContext;return 0===Object.keys(e.displayHighlights).length&&t.highlightData[e.id]&&(e.displayHighlights=t.highlightData[e.id]),this.summary}currentSearchOrg(){return this.staffCat&&this.staffCat.searchContext?this.staffCat.searchContext.searchOrg:null}handleMarcRecordSaved(){this.staffCat.currentDetailRecordSummary=null,this.loadRecord()}addHoldingsRequested(){this.holdingsMaint&&this.holdingsMaint.holdingsGrid?this.holdingsMaint.openHoldingAdd(this.holdingsMaint.holdingsGrid.context.getSelectedRows(),!0,!0):this.holdings.spawnAddHoldingsUi(this.recordId,null,[{owner:this.auth.user().ws_ou()}])}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(r.a),b.Lb(Nc.a),b.Lb(ne.a),b.Lb(Mc.a),b.Lb(n.a),b.Lb(d),b.Lb(go.a),b.Lb(y.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-record"]],viewQuery:function(e,t){var c;1&e&&(b.Ic(zs,!0),b.Sc(Ps,!0),b.Sc(Ls,!0),b.Sc(As,!0)),2&e&&(b.yc(c=b.gc())&&(t.recordTabs=c.first),b.yc(c=b.gc())&&(t.marcEditor=c.first),b.yc(c=b.gc())&&(t.holdingsMaint=c.first),b.yc(c=b.gc())&&(t.pendingChangesDialog=c.first))},hostBindings:function(e,t){1&e&&b.fc("beforeunload",(function(e){return t.canDeactivate(e)}),!1,b.Ac)},decls:47,vars:7,consts:[[4,"ngIf"],["dialogBody","Unsaved changes will be lost.  Continue navigation?",6,"dialogTitle"],["pendingChangesDialog",""],["id","staff-catalog-record-container"],["id","staff-catalog-bib-summary-container",1,"mt-1"],[3,"bibSummary"],[1,"row","ml-0","mr-0"],["id","staff-catalog-bib-navigation"],[3,"recordId","recordTab"],[1,"flex-1"],[3,"recordId","addHoldingsRequested"],["id","staff-catalog-bib-tabs-container",1,"mt-3"],[1,"row"],[1,"col-lg-12","text-right"],[1,"btn","btn-secondary","btn-sm",3,"disabled","click"],[3,"activeId","tabChange"],["recordTabs",""],["id","item_table",6,"title"],["ngbTabContent",""],["id","marc_edit",6,"title"],["id","marc_html",6,"title"],["id","holds",6,"title"],["id","monoparts",6,"title"],["id","holdings",6,"title"],["id","conjoined",6,"title"],["id","cnbrowse",6,"title"],["id","catalog",6,"title"],[6,"prefix"],[3,"recordId"],[1,"mt-3"],[3,"recordId","recordSaved"],["marcEditor",""],["recordType","bib",3,"recordId"],["preFetchSetting","catalog.record.holds.prefetch","printTemplate","holds_for_bib","persistKey","cat.catalog.wide_holds",3,"recordId","defaultSort","initialPickupLib"],["holdingsMaint",""],[1,"mt-2"]],template:function(e,t){1&e&&(b.Kc(0,Ys,3,2,"ng-container",0),b.Rb(1,"eg-confirm-dialog",1,2),b.Xb(3,Bs),b.Qb(),b.Rb(4,"div",3),b.Rb(5,"div",4),b.Mb(6,"eg-bib-summary",5),b.Qb(),b.Rb(7,"div",6),b.Rb(8,"div",7),b.Mb(9,"eg-catalog-record-pagination",8),b.Qb(),b.Mb(10,"div",9),b.Rb(11,"div",7),b.Rb(12,"eg-catalog-record-actions",10),b.fc("addHoldingsRequested",(function(){return t.addHoldingsRequested()})),b.Qb(),b.Qb(),b.Qb(),b.Rb(13,"div",11),b.Rb(14,"div",12),b.Rb(15,"div",13),b.Rb(16,"button",14),b.fc("click",(function(){return t.setDefaultTab()})),b.Vb(17,Es),b.Qb(),b.Qb(),b.Qb(),b.Rb(18,"ngb-tabset",15,16),b.fc("tabChange",(function(e){return t.beforeTabChange(e)})),b.Rb(20,"ngb-tab",17),b.Xb(21,Ds),b.Kc(22,Ws,1,1,"ng-template",18),b.Qb(),b.Rb(23,"ngb-tab",19),b.Xb(24,Fs),b.Kc(25,Zs,3,1,"ng-template",18),b.Qb(),b.Rb(26,"ngb-tab",20),b.Xb(27,Vs),b.Kc(28,Js,1,1,"ng-template",18),b.Qb(),b.Rb(29,"ngb-tab",21),b.Xb(30,Ks),b.Kc(31,cl,1,6,"ng-template",18),b.Qb(),b.Rb(32,"ngb-tab",22),b.Xb(33,Xs),b.Kc(34,al,1,1,"ng-template",18),b.Qb(),b.Rb(35,"ngb-tab",23),b.Xb(36,Gs),b.Kc(37,ol,2,1,"ng-template",18),b.Qb(),b.Rb(38,"ngb-tab",24),b.Xb(39,Hs),b.Kc(40,rl,1,1,"ng-template",18),b.Qb(),b.Rb(41,"ngb-tab",25),b.Xb(42,qs),b.Kc(43,nl,1,1,"ng-template",18),b.Qb(),b.Rb(44,"ngb-tab",26),b.Xb(45,Us),b.Kc(46,sl,1,1,"ng-template",18),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.oc("ngIf",t.summary),b.xb(6),b.oc("bibSummary",t.summaryForDisplay()),b.xb(3),b.oc("recordId",t.recordId)("recordTab",t.recordTab),b.xb(3),b.oc("recordId",t.recordId),b.xb(4),b.oc("disabled",t.recordTab==t.defaultTab),b.xb(2),b.oc("activeId",t.recordTab))},directives:[u.v,C.a,Mi.a,Gi,mn,m.W,m.T,m.U,Oc.a,Gn,oo.a,qn.a,Un.a,ds,wi,Rs,$s,Os],encapsulation:2}),e})(),bl=(()=>{class e{constructor(e,t,c,a,o,r,i,n){this.router=e,this.store=t,this.org=c,this.net=a,this.auth=o,this.cat=r,this.staffCat=i,this.basket=n}resolve(e,t){return console.debug("CatalogResolver:resolve()"),Promise.all([this.cat.fetchCcvms(),this.cat.fetchCmfs(),this.fetchSettings(),this.basket.getRecordIds()])}fetchSettings(){return this.store.getItemBatch(["eg.search.search_lib","eg.search.pref_lib","eg.search.adv_pane","eg.catalog.results.count","cat.holdings_show_empty_org","cat.holdings_show_empty","cat.marcedit.stack_subfields","cat.marcedit.flateditor","cat.holdings_show_copies","cat.holdings_show_vols","opac.staff_saved_search.size","eg.catalog.search_templates","opac.staff_saved_search.size","opac.search.enable_bookplate_search","eg.staffcat.exclude_electronic"]).then(e=>{this.staffCat.defaultSearchOrg=this.org.get(e["eg.search.search_lib"]),this.staffCat.prefOrg=this.org.get(e["eg.search.pref_lib"]),this.staffCat.defaultTab=e["eg.search.adv_pane"],e["eg.catalog.results.count"]&&(this.staffCat.defaultSearchLimit=Number(e["eg.catalog.results.count"])),this.staffCat.enableBookplates=e["opac.search.enable_bookplate_search"],this.staffCat.showExcludeElectronic=!0===e["eg.staffcat.exclude_electronic"]})}}return e.\u0275fac=function(t){return new(t||e)(b.cc(r.c),b.cc(x.a),b.cc(i.a),b.cc(ie.b),b.cc(ne.a),b.cc(n.a),b.cc(d),b.cc(h.a))},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac}),e})();var dl=c("hdyx"),hl=c("9rfo");const fl=["combobox"],ul=["placeholder",$localize`:␟ddb2551bcd26a70b12fdc6ae43e895ef334ef1fb␟308344097186443310:Profile Group`];let gl=(()=>{class e{constructor(e,t,c){this.org=e,this.auth=t,this.pcrud=c,this.cboxEntries=[],this.profiles={},this.propagateChange=e=>{},this.propagateTouch=()=>{},this.profileChange=new b.n}ngOnInit(){this.collectGroups().then(e=>this.sortGroups(e))}collectGroups(){return this.useDisplayEntries?this.pcrud.search("pgtde",{org:this.org.ancestors(this.auth.user().ws_ou(),!0)},{flesh:1,flesh_fields:{pgtde:["grp"]}},{atomic:!0}).toPromise().then(e=>{if(0===e.length)return this.fetchPgt();let t=this.org.get(e[0].org());e.forEach(e=>{const c=this.org.get(e.org());t.ou_type().depth()<c.ou_type().depth()&&(t=c)}),e=e.filter(e=>e.org()===t.id());const c=[];return e.forEach(e=>{const t=e.grp();t._display=e,c.push(t)}),c}):this.fetchPgt()}fetchPgt(){return this.pcrud.retrieveAll("pgt",{},{atomic:!0}).toPromise()}grpLabel(e,t){let c=t,a=0;do{const t=c._display?c._display.parent():c.parent();if(!t)break;c=e.filter(e=>e.id()===t)[0],a++}while(c);return"\u2007".repeat(a)+t.name()}sortGroups(e,t){t||(t=e.filter(e=>null===e.parent())[0]),this.profiles[t.id()]=t,this.cboxEntries.push({id:t.id(),label:this.grpLabel(e,t)}),e.filter(e=>e.parent()===t.id()).sort((e,t)=>e._display?e._display.position()<t._display.position()?-1:1:e.name()<t.name()?-1:1).forEach(t=>this.sortGroups(e,t))}writeValue(e){const t=e?e.id():null;this.cbox?this.cbox.selectedId=t:this.initialValue=t}registerOnChange(e){this.propagateChange=e}registerOnTouched(e){this.propagateTouch=e}propagateCboxChange(e){if(e){const t=this.profiles[e.id];this.propagateChange(t),this.profileChange.emit(t)}else this.profileChange.emit(null),this.propagateChange(null)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(i.a),b.Lb(ne.a),b.Lb(Nc.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-profile-select"]],viewQuery:function(e,t){var c;1&e&&b.Sc(fl,!0),2&e&&b.yc(c=b.gc())&&(t.cbox=c.first)},inputs:{useDisplayEntries:"useDisplayEntries"},outputs:{profileChange:"profileChange"},features:[b.wb([{provide:p.r,useExisting:Object(b.S)(()=>e),multi:!0}])],decls:3,vars:2,consts:[[3,"startId","entries","onChange",6,"placeholder"],["combobox",""]],template:function(e,t){1&e&&(b.Rb(0,"eg-combobox",0,1),b.Xb(2,ul),b.fc("onChange",(function(e){return t.propagateCboxChange(e)})),b.Qb()),2&e&&b.oc("startId",t.initialValue)("entries",t.cboxEntries)},directives:[hl.a],encapsulation:2}),e})();const pl=["searchGrid"],ml=["aria-label",$localize`:␟166b2cc65003221ff5f3ec05d5baca41e6821396␟4407559560004943843:Last Name`,"placeholder",$localize`:␟166b2cc65003221ff5f3ec05d5baca41e6821396␟4407559560004943843:Last Name`],Rl=["aria-label",$localize`:␟c83b838d845690bcb897f775f53b5316535306dc␟6028371114637047813:First Name`,"placeholder",$localize`:␟c83b838d845690bcb897f775f53b5316535306dc␟6028371114637047813:First Name`],yl=["aria-label",$localize`:␟e82f6e4c34cdbb18b0d9a753ebcfe8b3e9f43e4c␟8955767596926635588:Middle Name`,"placeholder",$localize`:␟e82f6e4c34cdbb18b0d9a753ebcfe8b3e9f43e4c␟8955767596926635588:Middle Name`],xl=["aria-label",$localize`:␟299e9c4a9e1693b429c3e2b7fa0231c1ed7f3dd4␟4816767784445044140:Name Keywords`,"placeholder",$localize`:␟299e9c4a9e1693b429c3e2b7fa0231c1ed7f3dd4␟4816767784445044140:Name Keywords`];var vl;vl=$localize`:␟7e892ba15f2c6c17e83510e273b3e10fc32ea016␟4580988005648117665:Search`;const Cl=["title",$localize`:␟c9f9b7401367dd4c0ba4aa53672ebcad57f84f56␟629459648209899236:Toggle Expanded Form Display`],Ql=["label",$localize`:␟45cc8ca94b5a50842a9a8ef804a5ab089a38ae5c␟8040881171107393560:ID`],Il=["label",$localize`:␟c8b3949fa0abc839acb537a326f2b9267d70cf1f␟5691966639616932851:Card`],_l=["label",$localize`:␟994363f08f9fbfa3b3994ff7b35c6904fdff18d8␟4915431133669985304:Profile`],Sl=["label",$localize`:␟e7430636aa25afef9ee7561e493ab11124b826ea␟4212720883106184788:Home Library`],Tl=["label",$localize`:␟ca5f52f1dad1f8a54935512271342eb73f803b5d␟4948663886508626048:Created On`],kl=["label",$localize`:␟6ec424063beefaa050881b2b496dd9481c1a3b17␟4811465148841358923:Mailing:Street 1`],$l=["label",$localize`:␟25d58179c7ad614972ebe4231d9c0814a24ba0d2␟8826756640068257852:Mailing:Street 2`],wl=["label",$localize`:␟bb220bda52b8e53f3d46ffc4fd5a71f1aca2a238␟5396391505138748581:Mailing:City`],Ml=["label",$localize`:␟26b5d05d1213cd5e526b7dec6a7c335a8ea0aa57␟3837003981531802520:Mailing:County`],Nl=["label",$localize`:␟2627cf68a63c8cc592cb392956beceebcd7a02bf␟3116745638800897438:Mailing:State`],Ol=["label",$localize`:␟43df2bcea84dbc087f875d389731768750c9fa3f␟2898068560742810285:Mailing:Zip`],zl=["label",$localize`:␟0b0b7e991db5373f5e448996364c90a430b8d88d␟7445875450809247362:Billing:Street 1`],Pl=["label",$localize`:␟f561b5eaf6a90b4c7ef4e32dca6a35ada32d8ec7␟284982815252010503:Billing:Street 2`],Ll=["label",$localize`:␟d54805ac7966985982e64cfb7c94e91c641fc670␟141667063610530376:Billing:City`],Al=["label",$localize`:␟82bbb57ad8973318753fc6e74874469928992570␟6447051492251347771:Billing:County`],Bl=["label",$localize`:␟4c0007b17ea7ddba105f3762e69baa65204ad8da␟1741078962482037464:Billing:State`],El=["label",$localize`:␟522f303fe4a0500c11af4762af71c65dd794d531␟3450680078518148003:Billing:Zip`];function Dl(e,t){1&e&&(b.Rb(0,"span",33),b.Mc(1,"arrow_drop_down"),b.Qb())}function Fl(e,t){1&e&&(b.Rb(0,"span",33),b.Mc(1,"arrow_drop_up"),b.Qb())}const Vl=["aria-label",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`,"placeholder",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`],Kl=["aria-label",$localize`:␟fbaaeb297e70b9a800acf841b9d26c19d60651ef␟1965206604774400:Alias`,"placeholder",$localize`:␟fbaaeb297e70b9a800acf841b9d26c19d60651ef␟1965206604774400:Alias`],Xl=["aria-label",$localize`:␟08c74dc9762957593b91f6eb5d65efdfc975bf48␟5248717555542428023:Username`,"placeholder",$localize`:␟08c74dc9762957593b91f6eb5d65efdfc975bf48␟5248717555542428023:Username`],Gl=["aria-label",$localize`:␟244aae9346da82b0922506c2d2581373a15641cc␟4768749765465246664:Email`,"placeholder",$localize`:␟244aae9346da82b0922506c2d2581373a15641cc␟4768749765465246664:Email`];var Hl;Hl=$localize`:␟16e421994f97b2181ecf8abf629bf042bc8ea490␟2213211565500516002:Clear Form`;const ql=["aria-label",$localize`:␟2fd8db76f566a3b06a4ef0ae25ec1373d6006b05␟2819172393980939852:Identification`,"placeholder",$localize`:␟2fd8db76f566a3b06a4ef0ae25ec1373d6006b05␟2819172393980939852:Identification`],Ul=["aria-label",$localize`:␟6934d8edd276d59e050006fe91b695ebad0218f8␟3262236020277300799:Phone`,"placeholder",$localize`:␟6934d8edd276d59e050006fe91b695ebad0218f8␟3262236020277300799:Phone`],jl=["aria-label",$localize`:␟30fdcbd028d7769dbc23d2fdc320f701529b3739␟8824163485536862122:Street 1`,"placeholder",$localize`:␟30fdcbd028d7769dbc23d2fdc320f701529b3739␟8824163485536862122:Street 1`],Yl=["aria-label",$localize`:␟66583ccf5108f39ddf9bbfa2bf0906ac323b5706␟7866630728103873535:Street 2`,"placeholder",$localize`:␟66583ccf5108f39ddf9bbfa2bf0906ac323b5706␟7866630728103873535:Street 2`],Wl=["aria-label",$localize`:␟5c7012b5a926b32d9e45fefdcc8a1a3cb6f023d0␟2314075913167237221:City`,"placeholder",$localize`:␟5c7012b5a926b32d9e45fefdcc8a1a3cb6f023d0␟2314075913167237221:City`],Zl=["aria-label",$localize`:␟873b72903b1858a9cd6c8967521030b4d7d1435b␟5911214550882917183:State`,"placeholder",$localize`:␟873b72903b1858a9cd6c8967521030b4d7d1435b␟5911214550882917183:State`],Jl=["aria-label",$localize`:␟3ca1af595e64e45afd925ec28a8a7aa398d7b22a␟1141427761455134615:Post Code`,"placeholder",$localize`:␟3ca1af595e64e45afd925ec28a8a7aa398d7b22a␟1141427761455134615:Post Code`],eb=["placeholder",$localize`:␟e7430636aa25afef9ee7561e493ab11124b826ea␟4212720883106184788:Home Library`],tb=["aria-label",$localize`:␟a7349dca02a013935fbe4bcd4b07b9754d1d8908␟5005351852439288543:Guardian`,"placeholder",$localize`:␟a7349dca02a013935fbe4bcd4b07b9754d1d8908␟5005351852439288543:Guardian`],cb=["aria-label",$localize`:␟e4daa01a19536484ec7c45840ae1a7324297f6a8␟5128097297071315723:DOB Year`,"placeholder",$localize`:␟e4daa01a19536484ec7c45840ae1a7324297f6a8␟5128097297071315723:DOB Year`],ab=["aria-label",$localize`:␟d0d3c8ea6aaf70c9f72a0ffd32a426b9ef1df29e␟5934240320730772286:DOB Month`,"placeholder",$localize`:␟d0d3c8ea6aaf70c9f72a0ffd32a426b9ef1df29e␟5934240320730772286:DOB Month`],ob=["aria-label",$localize`:␟d72854f6602f76532442f6539c7c43bf3b1914d5␟1992773184953675659:DOB Day`,"placeholder",$localize`:␟d72854f6602f76532442f6539c7c43bf3b1914d5␟1992773184953675659:DOB Day`],rb=["aria-label",$localize`:␟2cd1c2e05c0142cd64ca325894651cd40cee5a46␟1709289572931484960:Database ID`,"placeholder",$localize`:␟2cd1c2e05c0142cd64ca325894651cd40cee5a46␟1709289572931484960:Database ID`];var ib;function nb(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Rb(3,"input",4),b.Xb(4,Vl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.barcode=t})),b.Qb(),b.Qb(),b.Rb(5,"div",2),b.Rb(6,"input",4),b.Xb(7,Kl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.alias=t})),b.Qb(),b.Qb(),b.Rb(8,"div",2),b.Rb(9,"input",4),b.Xb(10,Xl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.usrname=t})),b.Qb(),b.Qb(),b.Rb(11,"div",2),b.Rb(12,"input",4),b.Xb(13,Gl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.email=t})),b.Qb(),b.Qb(),b.Rb(14,"div",2),b.Rb(15,"button",34),b.fc("click",(function(){return b.Bc(e),b.hc().clear()})),b.Vb(16,Hl),b.Qb(),b.Qb(),b.Mb(17,"div",2),b.Qb(),b.Rb(18,"div",1),b.Rb(19,"div",2),b.Rb(20,"input",4),b.Xb(21,ql),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.ident=t})),b.Qb(),b.Qb(),b.Rb(22,"div",2),b.Rb(23,"input",4),b.Xb(24,Ul),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.phone=t})),b.Qb(),b.Qb(),b.Rb(25,"div",2),b.Rb(26,"input",4),b.Xb(27,jl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.street1=t})),b.Qb(),b.Qb(),b.Rb(28,"div",2),b.Rb(29,"input",4),b.Xb(30,Yl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.street2=t})),b.Qb(),b.Qb(),b.Rb(31,"div",2),b.Rb(32,"input",4),b.Xb(33,Wl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.city=t})),b.Qb(),b.Qb(),b.Mb(34,"div",2),b.Qb(),b.Rb(35,"div",1),b.Rb(36,"div",2),b.Rb(37,"input",4),b.Xb(38,Zl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.state=t})),b.Qb(),b.Qb(),b.Rb(39,"div",2),b.Rb(40,"input",4),b.Xb(41,Jl),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.post_code=t})),b.Qb(),b.Qb(),b.Rb(42,"div",2),b.Rb(43,"eg-profile-select",35),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc().search.profile=t})),b.Qb(),b.Qb(),b.Rb(44,"div",2),b.Rb(45,"eg-org-select",36),b.Xb(46,eb),b.fc("onChange",(function(t){return b.Bc(e),b.hc().searchOrg=t})),b.Qb(),b.Qb(),b.Rb(47,"div",2),b.Rb(48,"input",4),b.Xb(49,tb),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.guardian=t})),b.Qb(),b.Qb(),b.Mb(50,"div",2),b.Qb(),b.Rb(51,"div",1),b.Rb(52,"div",2),b.Rb(53,"input",4),b.Xb(54,cb),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.dob_year=t})),b.Qb(),b.Qb(),b.Rb(55,"div",2),b.Rb(56,"input",4),b.Xb(57,ab),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.dob_month=t})),b.Qb(),b.Qb(),b.Rb(58,"div",2),b.Rb(59,"input",4),b.Xb(60,ob),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.dob_day=t})),b.Qb(),b.Qb(),b.Rb(61,"div",2),b.Rb(62,"input",4),b.Xb(63,rb),b.fc("keyup.enter",(function(){return b.Bc(e),b.hc().go()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.id=t})),b.Qb(),b.Qb(),b.Rb(64,"div",2),b.Rb(65,"div",37),b.Rb(66,"input",38),b.fc("change",(function(){return b.Bc(e),b.hc().toggleIncludeInactive()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().search.inactive=t})),b.Qb(),b.Rb(67,"label",39),b.Vb(68,ib),b.Qb(),b.Qb(),b.Qb(),b.Mb(69,"div",2),b.Qb(),b.Ob()}if(2&e){const e=b.hc();b.xb(3),b.oc("ngModel",e.search.barcode),b.xb(3),b.oc("ngModel",e.search.alias),b.xb(3),b.oc("ngModel",e.search.usrname),b.xb(3),b.oc("ngModel",e.search.email),b.xb(8),b.oc("ngModel",e.search.ident),b.xb(3),b.oc("ngModel",e.search.phone),b.xb(3),b.oc("ngModel",e.search.street1),b.xb(3),b.oc("ngModel",e.search.street2),b.xb(3),b.oc("ngModel",e.search.city),b.xb(5),b.oc("ngModel",e.search.state),b.xb(3),b.oc("ngModel",e.search.post_code),b.xb(3),b.oc("useDisplayEntries",!0)("ngModel",e.search.profile),b.xb(2),b.oc("fallbackOrg",e.org.root()),b.xb(3),b.oc("ngModel",e.search.guardian),b.xb(5),b.oc("ngModel",e.search.dob_year),b.xb(3),b.oc("ngModel",e.search.dob_month),b.xb(3),b.oc("ngModel",e.search.dob_day),b.xb(3),b.oc("ngModel",e.search.id),b.xb(4),b.oc("ngModel",e.search.inactive)}}ib=$localize`:␟4ecbeec9e99096bf1fc786728b14a373e0398968␟340991785973427363: Include Inactive ?`;const sb=["family_name ASC","first_given_name ASC","second_given_name ASC","dob DESC"],lb=["card","settings","standing_penalties","addresses","billing_address","mailing_address","stat_cat_entries","waiver_entries","usr_activity","notes","profile"],bb="eg.circ.patron.search.show_extras",db="eg.circ.patron.search.include_inactive";let hb=(()=>{class e{constructor(e,t,c,a,o){this.renderer=e,this.net=t,this.org=c,this.auth=a,this.store=o,this.search={},this.profileGroups=[],this.patronsSelected=new b.n,this.dataSource=new lo.c,this.dataSource.getRows=(e,t)=>this.getRows(e,t)}ngOnInit(){this.searchOrg=this.org.root(),this.store.getItemBatch([bb,db]).then(e=>{this.expandForm=e[bb],this.search.inactive=e[db]})}ngAfterViewInit(){this.renderer.selectRootElement("#focus-this-input").focus()}toggleExpandForm(){this.expandForm=!this.expandForm,this.expandForm?this.store.setItem(bb,!0):this.store.removeItem(bb)}toggleIncludeInactive(){this.search.inactive?this.store.setItem(db,!0):this.store.removeItem(db)}rowsSelected(e){this.patronsSelected.emit([].concat(e))}getSelected(){return this.searchGrid?this.searchGrid.context.getSelectedRows():[]}go(){this.searchGrid.reload()}clear(){this.search={profile:null}}getRows(e,t){let c;return c=this.search.id?this.searchById():this.searchByForm(e,t),c.pipe(Object(no.a)(e=>this.localFleshUser(e)))}localFleshUser(e){return e.home_ou(this.org.get(e.home_ou())),e}searchByForm(e,t){if(!this.compileSearch())return Object(ro.a)();const c=this.compileSort(t);return this.net.request("open-ils.actor","open-ils.actor.patron.search.advanced.fleshed",this.auth.token(),this.compileSearch(),e.limit,c,null,this.searchOrg.id(),lb,e.offset)}searchById(){return this.net.request("open-ils.actor","open-ils.actor.user.fleshed.retrieve",this.auth.token(),this.search.id,lb)}compileSort(e){return e&&0!==e.length?e.map(e=>`${e.name} ${e.dir}`):sb}compileSearch(){let e=!1;const t={};return Object.keys(this.search).forEach(c=>{t[c]=this.mapSearchField(c),t[c]&&(e=!0)}),e?t:null}isValue(e){return null!=e&&""!==e}mapSearchField(e){const t=this.search[e];if(!this.isValue(t))return null;const c={value:t,group:0};switch(e){case"name":case"inactive":delete c.group;break;case"street1":case"street2":case"city":case"state":case"post_code":c.group=1;break;case"phone":case"ident":c.group=2;break;case"card":c.group=3;break;case"profile":c.group=5,c.value=c.value.id();break;case"dob_day":case"dob_month":case"dob_year":c.group=4,c.value=c.value.replace(/\D/g,""),e.match(/year/)||(c[e].value=("0"+t).slice(-2))}return this.isValue(c.value)?c:null}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(b.D),b.Lb(ie.b),b.Lb(i.a),b.Lb(ne.a),b.Lb(x.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-patron-search"]],viewQuery:function(e,t){var c;1&e&&b.Sc(pl,!0),2&e&&b.yc(c=b.gc())&&(t.searchGrid=c.first)},outputs:{patronsSelected:"patronsSelected"},decls:64,vars:19,consts:[[1,"patron-search-form"],[1,"row","mb-2"],[1,"col-lg-2"],["type","text","id","focus-this-input",1,"form-control",3,"ngModel","keyup.enter","ngModelChange",6,"aria-label","placeholder"],["type","text",1,"form-control",3,"ngModel","keyup.enter","ngModelChange",6,"aria-label","placeholder"],[1,"btn","btn-success",3,"click"],[1,"btn","btn-outline-dark","ml-2","label-with-material-icon",3,"click",6,"title"],["class","material-icons",4,"ngIf"],[4,"ngIf"],[1,"patron-search-grid"],["idlClass","au","persistKey","circ.patron.search",3,"dataSource","showDeclaredFieldsOnly","onRowActivate"],["searchGrid",""],["path","id",6,"label"],["path","card.barcode",6,"label"],["path","profile.name",6,"label"],["path","family_name",3,"sortable","multiSortable"],["path","first_given_name",3,"sortable","multiSortable"],["path","second_given_name",3,"sortable","multiSortable"],["path","dob",3,"sortable","multiSortable"],["path","home_ou.shortname",6,"label"],["path","create_date",3,"sortable","multiSortable",6,"label"],["path","mailing_address.street1","visible","",6,"label"],["path","mailing_address.street2",6,"label"],["path","mailing_address.city",6,"label"],["path","mailing_address.county",6,"label"],["path","mailing_address.state",6,"label"],["path","mailing_address.post_code",6,"label"],["path","billing_address.street1",6,"label"],["path","billing_address.street2",6,"label"],["path","billing_address.city",6,"label"],["path","billing_address.county",6,"label"],["path","billing_address.state",6,"label"],["path","billing_address.post_code",6,"label"],[1,"material-icons"],[1,"btn","btn-warning",3,"click"],[3,"useDisplayEntries","ngModel","ngModelChange"],["persistKey","patron.search",3,"fallbackOrg","onChange",6,"placeholder"],[1,"form-check","form-check-inline"],["type","checkbox","id","include-inactive",1,"form-check-input",3,"ngModel","change","ngModelChange"],["for","include-inactive",1,"form-check-label"]],template:function(e,t){1&e&&(b.Rb(0,"div",0),b.Rb(1,"div",1),b.Rb(2,"div",2),b.Rb(3,"input",3),b.Xb(4,ml),b.fc("keyup.enter",(function(){return t.go()}))("ngModelChange",(function(e){return t.search.family_name=e})),b.Qb(),b.Qb(),b.Rb(5,"div",2),b.Rb(6,"input",4),b.Xb(7,Rl),b.fc("keyup.enter",(function(){return t.go()}))("ngModelChange",(function(e){return t.search.first_given_name=e})),b.Qb(),b.Qb(),b.Rb(8,"div",2),b.Rb(9,"input",4),b.Xb(10,yl),b.fc("keyup.enter",(function(){return t.go()}))("ngModelChange",(function(e){return t.search.second_given_name=e})),b.Qb(),b.Qb(),b.Rb(11,"div",2),b.Rb(12,"input",4),b.Xb(13,xl),b.fc("keyup.enter",(function(){return t.go()}))("ngModelChange",(function(e){return t.search.name=e})),b.Qb(),b.Qb(),b.Rb(14,"div",2),b.Rb(15,"button",5),b.fc("click",(function(){return t.go()})),b.Vb(16,vl),b.Qb(),b.Rb(17,"button",6),b.Xb(18,Cl),b.fc("click",(function(){return t.toggleExpandForm()})),b.Kc(19,Dl,2,0,"span",7),b.Kc(20,Fl,2,0,"span",7),b.Qb(),b.Qb(),b.Mb(21,"div",2),b.Qb(),b.Kc(22,nb,70,20,"ng-container",8),b.Qb(),b.Rb(23,"div",9),b.Rb(24,"eg-grid",10,11),b.fc("onRowActivate",(function(e){return t.rowsSelected(e)})),b.Rb(26,"eg-grid-column",12),b.Xb(27,Ql),b.Qb(),b.Rb(28,"eg-grid-column",13),b.Xb(29,Il),b.Qb(),b.Rb(30,"eg-grid-column",14),b.Xb(31,_l),b.Qb(),b.Mb(32,"eg-grid-column",15),b.Mb(33,"eg-grid-column",16),b.Mb(34,"eg-grid-column",17),b.Mb(35,"eg-grid-column",18),b.Rb(36,"eg-grid-column",19),b.Xb(37,Sl),b.Qb(),b.Rb(38,"eg-grid-column",20),b.Xb(39,Tl),b.Qb(),b.Rb(40,"eg-grid-column",21),b.Xb(41,kl),b.Qb(),b.Rb(42,"eg-grid-column",22),b.Xb(43,$l),b.Qb(),b.Rb(44,"eg-grid-column",23),b.Xb(45,wl),b.Qb(),b.Rb(46,"eg-grid-column",24),b.Xb(47,Ml),b.Qb(),b.Rb(48,"eg-grid-column",25),b.Xb(49,Nl),b.Qb(),b.Rb(50,"eg-grid-column",26),b.Xb(51,Ol),b.Qb(),b.Rb(52,"eg-grid-column",27),b.Xb(53,zl),b.Qb(),b.Rb(54,"eg-grid-column",28),b.Xb(55,Pl),b.Qb(),b.Rb(56,"eg-grid-column",29),b.Xb(57,Ll),b.Qb(),b.Rb(58,"eg-grid-column",30),b.Xb(59,Al),b.Qb(),b.Rb(60,"eg-grid-column",31),b.Xb(61,Bl),b.Qb(),b.Rb(62,"eg-grid-column",32),b.Xb(63,El),b.Qb(),b.Qb(),b.Qb()),2&e&&(b.xb(3),b.oc("ngModel",t.search.family_name),b.xb(3),b.oc("ngModel",t.search.first_given_name),b.xb(3),b.oc("ngModel",t.search.second_given_name),b.xb(3),b.oc("ngModel",t.search.name),b.xb(7),b.oc("ngIf",!t.expandForm),b.xb(1),b.oc("ngIf",t.expandForm),b.xb(2),b.oc("ngIf",t.expandForm),b.xb(2),b.oc("dataSource",t.dataSource)("showDeclaredFieldsOnly",!0),b.xb(8),b.oc("sortable",!0)("multiSortable",!0),b.xb(1),b.oc("sortable",!0)("multiSortable",!0),b.xb(1),b.oc("sortable",!0)("multiSortable",!0),b.xb(1),b.oc("sortable",!0)("multiSortable",!0),b.xb(3),b.oc("sortable",!0)("multiSortable",!0))},directives:[p.c,p.t,p.w,u.v,bo.a,Go.a,gl,R.a,p.a],encapsulation:2}),e})();const fb=["searchForm"];var ub;ub=$localize`:␟9a2b3de3e69cb5950d5daff1e7baeb984549cfee␟3036151888301781096:Patron Search`;const gb=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var pb,mb;function Rb(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",1),b.Rb(1,"h4",2),b.Rb(2,"span"),b.Vb(3,ub),b.Qb(),b.Qb(),b.Rb(4,"button",3),b.Xb(5,gb),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Rb(6,"span",4),b.Mc(7,"\xd7"),b.Qb(),b.Qb(),b.Qb(),b.Rb(8,"div",5),b.Rb(9,"eg-patron-search",6,7),b.fc("patronsSelected",(function(t){return b.Bc(e),b.hc().patronsSelected(t)})),b.Qb(),b.Qb(),b.Rb(11,"div",8),b.Pb(12),b.Rb(13,"button",9),b.fc("click",(function(){return b.Bc(e),b.hc().close()})),b.Vb(14,pb),b.Qb(),b.Rb(15,"button",10),b.fc("click",(function(){b.Bc(e);const t=b.zc(10);return b.hc().close(t.getSelected())})),b.Vb(16,mb),b.Qb(),b.Ob(),b.Qb()}if(2&e){const e=b.zc(10);b.xb(15),b.oc("disabled",!e||0===e.getSelected().length)}}pb=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,mb=$localize`:␟9ca82952a6bc860b5391d5975322d8af8ceddfa4␟3797570084942068182:Select`;let yb=(()=>{class e extends v.a{constructor(e){super(e),this.modal=e}ngOnInit(){}patronsSelected(e){this.close(e)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(m.s))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-patron-search-dialog"]],viewQuery:function(e,t){var c;1&e&&b.Sc(fb,!0),2&e&&b.yc(c=b.gc())&&(t.searchForm=c.first)},features:[b.ub],decls:2,vars:0,consts:[["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[3,"patronsSelected"],["searchForm",""],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"]],template:function(e,t){1&e&&b.Kc(0,Rb,17,1,"ng-template",null,0,b.Lc)},directives:[hb],encapsulation:2}),e})();var xb=c("LTyc");const vb=["patronSearch"],Cb=["title",$localize`:␟8ad25dc98999845f40864f3cd7de0793d8ea0565␟4956120964290957178:Search for Patron`];var Qb,Ib,_b,Sb,Tb,kb,$b,wb,Mb,Nb,Ob,zb,Pb,Lb,Ab,Bb,Eb,Db,Fb,Vb,Kb,Xb,Gb;function Hb(e,t){if(1&e&&(b.bc(0,Vb,1),b.Mb(1,"small"),b.Yb()),2&e){const e=b.hc();b.xb(1),b.Zb(e.user.family_name())(e.user.first_given_name()),b.Wb(0)}}function qb(e,t){if(1&e){const e=b.Sb();b.Rb(0,"li",27),b.Rb(1,"div",28),b.Rb(2,"div",12),b.Rb(3,"input",49),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc().notifySms=t})),b.Qb(),b.Rb(4,"label",14),b.Vb(5,Kb),b.Qb(),b.Qb(),b.Qb(),b.Rb(6,"div",28),b.Rb(7,"div",15),b.Rb(8,"div",30),b.Rb(9,"span",31),b.Vb(10,Xb),b.Qb(),b.Qb(),b.Rb(11,"input",50),b.fc("ngModelChange",(function(t){return b.Bc(e),b.hc().smsValue=t})),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(3),b.oc("ngModel",e.notifySms),b.xb(8),b.oc("disabled",!e.notifySms)("ngModel",e.smsValue)}}Qb=$localize`:␟8ad25dc98999845f40864f3cd7de0793d8ea0565␟4956120964290957178:Search for Patron`,Ib=$localize`:␟77fd024cefe7b7acf24cb99ee2ae084c5f3dec6f␟8383780172065075451: Place hold for patron by barcode: `,_b=$localize`:␟eb70a63307727702ff3dfc8e0c7d1ce0f78fb698␟3790186598950358901: Place hold for this staff account: `,Sb=$localize`:␟bcc978b08ec3cb66116a5a07067152633c1d7439␟5676808587185036490:Pickup Location: `,Tb=$localize`:␟728ebb04fbdfec152d83b35b1257c857021026fb␟1827146382106703067:Suspend Hold`,kb=$localize`:␟8bcabdf6b16cad0313a86c7e940c5e3ad7f9f8ab␟5851560788527570644:Notifications`,$b=$localize`:␟5639b2886fc9303c24b13257f496e65954dc9f5b␟8262613416180044964:Notify by Email`,wb=$localize`:␟ec984ab36f1da5f75ba43f9bd4b866ca9c7e6493␟4879517228803151475:Email Address`,Mb=$localize`:␟27e2698f26d22e52d9f633740413eede70457165␟448450481597401718:Notify by Phone`,Nb=$localize`:␟db654f91d847f34e71ffb99268ff3a1807913421␟8194554728555410336:Phone Number`,Ob=$localize`:␟ea46f35a556442c9ec49aa9b5f543d75fe244696␟8485535637477753309:Place Hold(s)`,zb=$localize`:␟7722a92a1fc887570b4f4d8a7bb916f067f32028␟7513076467032912668:Format`,Pb=$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`,Lb=$localize`:␟d7293b61e9088c66421df2e367e0ccc00346cf9f␟7071470734400948493:Author`,Ab=$localize`:␟4a6349fab642dd11764bc101dd27c27d7cdea3d2␟339729126805226016:Part`,Bb=$localize`:␟115508ef944d0bdb066e511220b8679efd7fb4b2␟6100860029551607069:Call Number`,Eb=$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`,Db=$localize`:␟b38c1041bf71a1c822961a719964a759d91d3818␟558458027509410914:Holds Status`,Fb=$localize`:␟8226821567f097b9faa3aa687d0919d84e5d80cf␟1740011261887912974:Override`,Vb=$localize`:␟6efe75c24a53b6c57877b6ad58969b744e4eb8c9␟8849043914668115087:Place Hold ${"\ufffd*6:1\ufffd\ufffd#1:1\ufffd"}:START_SMALL_TEXT: (${"\ufffd0:1\ufffd"}:INTERPOLATION:, ${"\ufffd1:1\ufffd"}:INTERPOLATION_1:) ${"\ufffd/#1:1\ufffd\ufffd/*6:1\ufffd"}:CLOSE_SMALL_TEXT:`,Kb=$localize`:␟b1013a2799c2f99dea9ff8f81ce9e3a843b60c08␟2725880380098677476:Notify by SMS`,Xb=$localize`:␟d7d13a5c619817af20221426fa615abd860393e6␟5036004804456368723:SMS Number`,Gb=$localize`:␟d7e077515491b0f5a3b71070e2db8755183030f5␟2796988493219471622:SMS Carrier`;const Ub=["placeholder",$localize`:␟97e9081557e5ae0fd6cd285dfcb3324c86bc4451␟9166421043673328704:SMS Carriers`];function jb(e,t){if(1&e&&(b.Rb(0,"li",27),b.Rb(1,"div",28),b.Rb(2,"label"),b.Vb(3,Gb),b.Qb(),b.Qb(),b.Rb(4,"div",28),b.Rb(5,"eg-combobox",51),b.Xb(6,Ub),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc();b.xb(5),b.oc("disabled",!e.notifySms)("entries",e.smsCarriers)}}function Yb(e,t){1&e&&(b.bc(0,ad,1),b.Nb(1),b.Yb())}function Wb(e,t){1&e&&(b.bc(0,ad,2),b.Nb(1),b.Yb())}function Zb(e,t){1&e&&(b.bc(0,ad,3),b.Nb(1),b.Yb())}function Jb(e,t){1&e&&(b.bc(0,ad,4),b.Nb(1),b.Yb())}function ed(e,t){1&e&&(b.bc(0,ad,5),b.Nb(1),b.Yb())}function td(e,t){1&e&&(b.bc(0,ad,6),b.Nb(1),b.Yb())}function cd(e,t){1&e&&(b.bc(0,ad,7),b.Nb(1),b.Yb())}var ad,od,rd,id,nd,sd,ld,bd,dd,hd,fd,ud,gd;function pd(e,t){1&e&&(b.bc(0,ad,8),b.Nb(1),b.Yb())}function md(e,t){if(1&e&&(b.Rb(0,"span",52),b.Rb(1,"span"),b.Vb(2,od),b.Qb(),b.Rb(3,"span",53),b.Rb(4,"a",54),b.Rb(5,"button",55),b.Vb(6,rd),b.Qb(),b.Qb(),b.Qb(),b.Rb(7,"span",53),b.Rb(8,"a",56),b.Rb(9,"button",55),b.Vb(10,id),b.Qb(),b.Qb(),b.Qb(),b.Rb(11,"span",53),b.Rb(12,"a",57),b.Rb(13,"button",55),b.Vb(14,nd),b.Qb(),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc();b.xb(5),b.oc("disabled","C"===e.holdType),b.xb(4),b.oc("disabled","R"===e.holdType),b.xb(4),b.oc("disabled","F"===e.holdType)}}function Rd(e,t){1&e&&(b.Rb(0,"span",58),b.Vb(1,sd),b.Qb())}function yd(e,t){if(1&e&&(b.Pb(0),b.Mb(1,"img",65),b.Ob()),2&e){const e=t.$implicit,c=b.hc(3);b.xb(1),b.pc("alt",c.iconFormatLabel(e)),b.pc("title",c.iconFormatLabel(e)),b.qc("src","/images/format_icons/icon_format/",e,".png",b.Ec)}}function xd(e,t){if(1&e&&(b.Rb(0,"option",69),b.Mc(1),b.Qb()),2&e){const e=t.$implicit;b.pc("value",e.id()),b.xb(1),b.Nc(e.label())}}function vd(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"select",66),b.fc("change",(function(t){b.Bc(e);const c=b.hc(2).$implicit;return b.hc().setPart(c,t)})),b.Rb(2,"option",67),b.Vb(3,ld),b.Qb(),b.Kc(4,xd,2,2,"option",68),b.Qb(),b.Ob()}if(2&e){const e=b.hc(2).$implicit;b.xb(4),b.oc("ngForOf",e.holdMeta.parts)}}function Cd(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"span"),b.Mc(2),b.Qb(),b.Ob()),2&e){const e=b.hc(3).$implicit;b.xb(2),b.Nc(e.holdMeta.part.label())}}function Qd(e,t){1&e&&(b.Pb(0),b.Rb(1,"span"),b.Vb(2,bd),b.Qb(),b.Ob())}function Id(e,t){if(1&e&&(b.Pb(0),b.Kc(1,Cd,3,1,"ng-container",3),b.Kc(2,Qd,3,0,"ng-container",3),b.Ob()),2&e){const e=b.hc(2).$implicit;b.xb(1),b.oc("ngIf",e.holdMeta.part),b.xb(1),b.oc("ngIf",!e.holdMeta.part)}}function _d(e,t){if(1&e&&(b.Pb(0),b.Mc(1),b.Ob()),2&e){const e=b.hc(2).$implicit;b.xb(1),b.Oc(" ",e.holdMeta.callNum.label()," ")}}function Sd(e,t){if(1&e&&(b.Pb(0),b.Mc(1),b.Ob()),2&e){const e=b.hc(2).$implicit;b.xb(1),b.Oc(" ",e.holdMeta.copy.barcode()," ")}}function Td(e,t){1&e&&(b.Pb(0),b.Rb(1,"div",70),b.Vb(2,dd),b.Qb(),b.Ob())}function kd(e,t){1&e&&(b.Pb(0),b.Rb(1,"div",71),b.Vb(2,hd),b.Qb(),b.Ob())}function $d(e,t){1&e&&(b.Pb(0),b.Rb(1,"div",72),b.Vb(2,fd),b.Qb(),b.Ob())}function wd(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",73),b.Mc(2),b.Qb(),b.Ob()),2&e){const e=b.hc(3).$implicit;b.xb(1),b.pc("title",e.lastRequest.result.evt.textcode),b.xb(1),b.Oc(" ",e.lastRequest.result.evt.textcode," ")}}function Md(e,t){if(1&e&&(b.Pb(0),b.Kc(1,$d,3,0,"ng-container",3),b.Kc(2,wd,3,2,"ng-container",3),b.Ob()),2&e){const e=b.hc(2).$implicit;b.xb(1),b.oc("ngIf",e.lastRequest.result.success),b.xb(1),b.oc("ngIf",!e.lastRequest.result.success)}}function Nd(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",74),b.fc("click",(function(){b.Bc(e);const t=b.hc(2).$implicit;return b.hc().override(t)})),b.Mc(2,"Override"),b.Qb(),b.Ob()}}function Od(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",77),b.Rb(2,"input",78),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.$implicit;return b.hc(3).$implicit.selectedFormats.formats[a.code()]=c})),b.Qb(),b.Mb(3,"img",79),b.Rb(4,"label",80),b.Mc(5),b.Qb(),b.Qb(),b.Ob()}if(2&e){const e=t.$implicit,c=b.hc(3).$implicit,a=b.hc();b.xb(2),b.oc("disabled",1==c.holdMeta.metarecord_filters.formats.length)("ngModel",c.selectedFormats.formats[e.code()]),b.xb(1),b.pc("alt",a.iconFormatLabel(e.code())),b.pc("title",a.iconFormatLabel(e.code())),b.qc("src","/images/format_icons/icon_format/",e.code(),".png",b.Ec),b.xb(2),b.Oc(" ",e.search_label()||e.value()," ")}}function zd(e,t){if(1&e&&(b.Rb(0,"div",75),b.Rb(1,"div",46),b.Rb(2,"label"),b.Vb(3,ud),b.Qb(),b.Qb(),b.Rb(4,"div",76),b.Kc(5,Od,6,6,"ng-container",61),b.Qb(),b.Qb()),2&e){const e=b.hc(2).$implicit;b.xb(5),b.oc("ngForOf",e.holdMeta.metarecord_filters.formats)}}function Pd(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",77),b.Rb(2,"input",78),b.fc("ngModelChange",(function(c){b.Bc(e);const a=t.$implicit;return b.hc(3).$implicit.selectedFormats.langs[a.code()]=c})),b.Qb(),b.Rb(3,"label",80),b.Mc(4),b.Qb(),b.Qb(),b.Ob()}if(2&e){const e=t.$implicit,c=b.hc(3).$implicit;b.xb(2),b.oc("disabled",1==c.holdMeta.metarecord_filters.langs.length)("ngModel",c.selectedFormats.langs[e.code()]),b.xb(2),b.Oc(" ",e.search_label()||e.value()," ")}}function Ld(e,t){if(1&e&&(b.Rb(0,"div",75),b.Rb(1,"div",46),b.Rb(2,"label"),b.Vb(3,gd),b.Qb(),b.Qb(),b.Rb(4,"div",76),b.Kc(5,Pd,5,3,"ng-container",61),b.Qb(),b.Qb()),2&e){const e=b.hc(2).$implicit;b.xb(5),b.oc("ngForOf",e.holdMeta.metarecord_filters.langs)}}function Ad(e,t){if(1&e&&(b.Rb(0,"div",38),b.Rb(1,"div",1),b.Rb(2,"div",46),b.Kc(3,yd,2,3,"ng-container",61),b.Qb(),b.Rb(4,"div",47),b.Rb(5,"a",62),b.Mc(6),b.Qb(),b.Qb(),b.Rb(7,"div",46),b.Mc(8),b.Qb(),b.Rb(9,"div",47),b.Kc(10,vd,5,1,"ng-container",3),b.Kc(11,Id,3,2,"ng-container",3),b.Qb(),b.Rb(12,"div",47),b.Kc(13,_d,2,1,"ng-container",63),b.Qb(),b.Rb(14,"div",46),b.Kc(15,Sd,2,1,"ng-container",63),b.Qb(),b.Rb(16,"div",47),b.Kc(17,Td,3,0,"ng-container",3),b.Kc(18,kd,3,0,"ng-container",3),b.Kc(19,Md,3,2,"ng-container",3),b.Qb(),b.Rb(20,"div",46),b.Kc(21,Nd,3,0,"ng-container",3),b.Qb(),b.Qb(),b.Kc(22,zd,6,1,"div",64),b.Kc(23,Ld,6,1,"div",64),b.Qb()),2&e){const e=b.hc().$implicit,t=b.hc(),c=b.zc(106);b.xb(3),b.oc("ngForOf",e.holdMeta.bibSummary.attributes.icon_format),b.xb(2),b.qc("routerLink","/staff/catalog/record/",e.holdMeta.bibId,""),b.xb(1),b.Oc(" ",e.holdMeta.bibSummary.display.title," "),b.xb(2),b.Nc(e.holdMeta.bibSummary.display.author),b.xb(2),b.oc("ngIf",e.holdMeta.parts.length),b.xb(1),b.oc("ngIf",0==e.holdMeta.parts.length),b.xb(2),b.oc("ngIf",e.holdMeta.callNum)("ngIfElse",c),b.xb(2),b.oc("ngIf",e.holdMeta.copy)("ngIfElse",c),b.xb(2),b.oc("ngIf",!e.lastRequest&&!e.processing),b.xb(1),b.oc("ngIf",e.processing),b.xb(1),b.oc("ngIf",e.lastRequest),b.xb(2),b.oc("ngIf",t.canOverride(e)),b.xb(1),b.oc("ngIf",t.hasMetaFilters(e)),b.xb(1),b.oc("ngIf",t.hasMetaFilters(e))}}function Bd(e,t){if(1&e&&(b.Rb(0,"div",59),b.Kc(1,Ad,24,16,"div",60),b.Qb()),2&e){const e=t.$implicit;b.xb(1),b.oc("ngIf",e.holdMeta)}}ad=$localize`:␟22a4f972cf1ce8860f6b764753b9a2f7efda6eaa␟2636156555596710669:Placing ${"\ufffd*94:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER:METARECORD${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*95:2\ufffd\ufffd#1:2\ufffd"}:START_TAG_NG_CONTAINER_1:TITLE${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*96:3\ufffd\ufffd#1:3\ufffd"}:START_TAG_NG_CONTAINER_2:CALL NUMBER${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*97:4\ufffd\ufffd#1:4\ufffd"}:START_TAG_NG_CONTAINER_3:FORCE ITEM${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*98:5\ufffd\ufffd#1:5\ufffd"}:START_TAG_NG_CONTAINER_4:ITEM${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*99:6\ufffd\ufffd#1:6\ufffd"}:START_TAG_NG_CONTAINER_5:RECALL${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*100:7\ufffd\ufffd#1:7\ufffd"}:START_TAG_NG_CONTAINER_6:ISSUANCE${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*101:8\ufffd\ufffd#1:8\ufffd"}:START_TAG_NG_CONTAINER_7:PARTS${"[\ufffd/#1:1\ufffd\ufffd/*94:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*95:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*96:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*97:4\ufffd|\ufffd/#1:5\ufffd\ufffd/*98:5\ufffd|\ufffd/#1:6\ufffd\ufffd/*99:6\ufffd|\ufffd/#1:7\ufffd\ufffd/*100:7\ufffd|\ufffd/#1:8\ufffd\ufffd/*101:8\ufffd]"}:CLOSE_TAG_NG_CONTAINER: hold on record(s) `,ad=b.ac(ad),od=$localize`:␟1f0b6276455bce0d1b25a4206d46fa07c6eb796a␟628227756695019991:Item-Level Hold Options:`,rd=$localize`:␟d54f94f5ab6c50a7f0875b70eaef40fa69b8b09e␟4517968900220954994:Item Hold`,id=$localize`:␟9f4a16f9b00ac16fddf52a71665a3c1c3614969b␟8770388272426866599:Recall Hold`,nd=$localize`:␟977bc7f1360a36dedf059937eeae505ffe4d9241␟7888978596466065368:Force Item Hold`,sd=$localize`:␟c816029b91f7a2030f83def482a9b67305bb86bb␟8762533048263722301:ANY`,ld=$localize`:␟b7a4058d149d199d094dd327beb0db86dc82dc9c␟7263025910380236464:Any Part`,bd=$localize`:␟84a36cb75660b736773fe36ffa3d54f0f0fe363e␟6811901802533648897:N/A`,dd=$localize`:␟d1dda82eb31f67bd3dc25771d5cc1b597caa7dec␟3868420354113245697:Hold Pending`,hd=$localize`:␟55ce669b540c5602d02d33281689c101cce84b47␟6581724905054268021:Hold Processing...`,fd=$localize`:␟be7d5cd422a62288f06e324e2bfcf04fc75e4c7c␟1036139699620036848:Hold Succeeded`,ud=$localize`:␟c32569bd606159c75669e5af5f80488175eed56d␟7445493758951042884:Formats: `,gd=$localize`:␟535611d373528d940e4a7e41869e0a4d9f51b6bd␟4347460585157861935:Languages: `;class Ed{constructor(e){this.holdTarget=e,this.processing=!1,this.selectedFormats={formats:{},langs:{}}}}let Dd=(()=>{class e{constructor(e,t,c,a,o,r,i,n,s,l,b,d,h,f){this.router=e,this.route=t,this.renderer=c,this.evt=a,this.net=o,this.org=r,this.auth=i,this.pcrud=n,this.bib=s,this.cat=l,this.staffCat=b,this.holds=d,this.patron=h,this.perm=f,this.holdContexts=[],this.smsCarriers=[]}ngOnInit(){this.route.paramMap.subscribe(e=>this.holdType=e.get("type")),this.holdType=this.route.snapshot.params.type,this.holdTargets=this.route.snapshot.queryParams.target,this.holdFor=this.route.snapshot.queryParams.holdFor||"patron",this.staffCat.holdForBarcode&&(this.holdFor="patron",this.userBarcode=this.staffCat.holdForBarcode),Array.isArray(this.holdTargets)||(this.holdTargets=[this.holdTargets]),this.holdTargets=this.holdTargets.map(e=>Number(e)),this.requestor=this.auth.user(),this.pickupLib=this.auth.user().ws_ou(),this.holdContexts=this.holdTargets.map(e=>new Ed(e)),("staff"===this.holdFor||this.userBarcode)&&this.holdForChanged(),this.getTargetMeta(),this.org.settings("sms.enable").then(e=>{this.smsEnabled=e["sms.enable"],this.smsEnabled&&this.pcrud.search("csc",{active:"t"},{order_by:{csc:"name"}}).subscribe(e=>{this.smsCarriers.push({id:e.id(),label:e.name()})})}),setTimeout(()=>this.renderer.selectRootElement("#patron-barcode").focus())}getTargetMeta(){this.holds.getHoldTargetMeta(this.holdType,this.holdTargets).subscribe(e=>{this.holdContexts.filter(t=>t.holdTarget===e.target).forEach(t=>{t.holdMeta=e,this.mrFiltersToSelectors(t)})})}mrFiltersToSelectors(e){if("M"!==this.holdType)return;const t=e.holdMeta;t.metarecord_filters&&(t.metarecord_filters.formats&&t.metarecord_filters.formats.forEach(t=>e.selectedFormats.formats[t.code()]=!0),t.metarecord_filters.langs&&t.metarecord_filters.langs.forEach(t=>e.selectedFormats.langs[t.code()]=!0))}mrSelectorsToFilters(e){const t=e.holdMeta,c=e.selectedFormats,a=Object.keys(c.formats).filter(e=>Boolean(c.formats[e])),o=Object.keys(c.langs).filter(e=>Boolean(c.langs[e])),r={};if(a.length>0&&(r[0]=[],a.forEach(e=>{const c=t.metarecord_filters.formats.filter(t=>t.code()===e)[0];r[0].push({_attr:c.ctype(),_val:c.code()})})),o.length>0&&(r[1]=[],o.forEach(e=>{const c=t.metarecord_filters.langs.filter(t=>t.code()===e)[0];r[1].push({_attr:c.ctype(),_val:c.code()})})),Object.keys(r).length>0){const t={};return t[e.holdTarget]=JSON.stringify(r),t}return null}holdForChanged(){this.user=null,"patron"===this.holdFor?this.userBarcode&&this.userBarcodeChanged():(this.currentUserBarcode="_"+this.requestor.id(),this.getUser(this.requestor.id()))}activeDateSelected(e){this.activeDate=e}userBarcodeChanged(){this.userBarcode!==this.currentUserBarcode&&(this.resetForm(),this.userBarcode?(this.user=null,this.currentUserBarcode=this.userBarcode,this.getUser()):this.user=null)}getUser(e){(e?this.patron.getById(e,{flesh:1,flesh_fields:{au:["settings"]}}):this.patron.getByBarcode(this.userBarcode)).then(e=>{this.user=e,this.applyUserSettings()})}resetForm(){this.notifyEmail=!0,this.notifyPhone=!0,this.phoneValue="",this.pickupLib=this.requestor.ws_ou()}applyUserSettings(){this.user&&this.user.settings()&&(this.phoneValue=this.user.day_phone()||this.user.evening_phone(),this.user.id()!==this.requestor.id()&&(this.pickupLib=this.user.home_ou()),this.user.settings().forEach(e=>{const t=e.name(),c=e.value();if(""!==c&&null!==c)switch(t){case"opac.hold_notify":this.notifyPhone=Boolean(c.match(/phone/)),this.notifyEmail=Boolean(c.match(/email/)),this.notifySms=Boolean(c.match(/sms/));break;case"opac.default_pickup_location":this.pickupLib=c}}),this.user.email()||(this.notifyEmail=!1),this.phoneValue||(this.notifyPhone=!1))}placeHolds(e){if(e||(e=0),!this.holdTargets[e])return void(this.placeHoldsClicked=!1);this.placeHoldsClicked=!0;const t=this.holdTargets[e],c=this.holdContexts.filter(e=>e.holdTarget===t)[0];this.placeOneHold(c).then(()=>this.placeHolds(e+1))}placeOneHold(e,t){e.processing=!0;const c=this.mrSelectorsToFilters(e);let a=this.holdType,o=e.holdTarget;return"T"===a&&e.holdMeta.part&&(a="P",o=e.holdMeta.part.id()),console.debug(`Placing ${a}-type hold on ${o}`),this.holds.placeHold({holdTarget:o,holdType:a,recipient:this.user.id(),requestor:this.requestor.id(),pickupLib:this.pickupLib,override:t,notifyEmail:this.notifyEmail,notifyPhone:this.notifyPhone?this.phoneValue:null,notifySms:this.notifySms?this.smsValue:null,smsCarrier:this.notifySms?this.smsCarrier:null,thawDate:this.suspend?this.activeDate:null,frozen:this.suspend,holdableFormats:c}).toPromise().then(t=>{if(e.lastRequest=t,e.processing=!1,!t.result.success&&(console.debug("hold failed with: ",t),!t.override&&t.result.evt)){const c=t.result.evt.textcode+".override";return this.perm.hasWorkPermHere(c).then(t=>e.canOverride=t[c])}},t=>{e.processing=!1,console.error(t)})}override(e){this.placeOneHold(e,!0)}canOverride(e){return e.lastRequest&&!e.lastRequest.result.success&&e.canOverride}iconFormatLabel(e){return this.cat.iconFormatLabel(e)}hasMetaFilters(e){return"M"===this.holdType&&e.holdMeta.metarecord_filters&&(e.holdMeta.metarecord_filters.langs.length>1||e.holdMeta.metarecord_filters.formats.length>1)}searchPatrons(){this.patronSearch.open({size:"xl"}).toPromise().then(e=>{if(!e||0===e.length)return;const t=e[0];this.user=t,this.userBarcode=this.currentUserBarcode=t.card().barcode(),t.home_ou(this.org.get(t.home_ou()).id()),this.applyUserSettings()})}isItemHold(){return"C"===this.holdType||"R"===this.holdType||"F"===this.holdType}setPart(e,t){const c=t.target.value;e.holdMeta.part=c?e.holdMeta.parts.filter(e=>+e.id()==+c)[0]:null}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.c),b.Lb(r.a),b.Lb(b.D),b.Lb(xo.a),b.Lb(ie.b),b.Lb(i.a),b.Lb(ne.a),b.Lb(Nc.a),b.Lb(Mc.a),b.Lb(n.a),b.Lb(d),b.Lb(dl.a),b.Lb(l.a),b.Lb(jn.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var c;1&e&&b.Sc(vb,!0),2&e&&b.yc(c=b.gc())&&(t.patronSearch=c.first)},decls:126,vars:29,consts:[["patronSearch",""],[1,"row"],[1,"col-lg-4"],[4,"ngIf"],[1,"col-lg-2","text-right"],[1,"btn","btn-outline-dark","btn-sm",3,"click"],[1,"material-icons","mat-icon-in-button","align-middle",6,"title"],[1,"align-middle"],["autocomplete","off",1,"form","form-validated","common-form",3,"keydown.enter"],[1,"col-lg-6","common-form","striped-odd"],[1,"row","mt-2"],[1,"col-lg-6"],[1,"form-check"],["type","radio","name","holdFor","value","patron",1,"form-check-input",3,"ngModel","change","ngModelChange"],[1,"form-check-label"],[1,"input-group"],["type","text","name","userBarcode","id","patron-barcode",1,"form-control",3,"disabled","ngModel","keyup.enter","ngModelChange","change"],[1,"input-group-append"],[1,"btn","btn-outline-dark",3,"click"],["type","radio","name","holdFor","value","staff",1,"form-check-input",3,"ngModel","change","ngModelChange"],[1,"col-lg-6","font-weight-bold"],[3,"applyOrgId"],["type","checkbox","name","suspend",1,"form-check-input",3,"ngModel","ngModelChange"],[3,"disabled","onChangeAsISO"],[1,"card"],[1,"card-header"],[1,"list-group","list-group-flush"],[1,"list-group-item","d-flex"],[1,"flex-1"],["type","checkbox","name","notifyEmail",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","name","userEmail",1,"form-control",3,"disabled","value"],["type","checkbox","name","notifyPhone",1,"form-check-input",3,"ngModel","ngModelChange"],["type","text","name","phoneValue",1,"form-control",3,"disabled","ngModel","ngModelChange"],["class","list-group-item d-flex",4,"ngIf"],[1,"col-lg-3"],[1,"btn","btn-success",3,"disabled","click"],[1,"col-lg-12"],[1,"row","pt-3","ml-1","mr-1","d-flex"],[1,""],[1,"font-weight-bold"],["class","pl-3",4,"ngIf"],["anyValue",""],[1,"hold-records-list","common-form","striped-even"],[1,"row","mt-2","ml-1","mr-1","font-weight-bold"],[1,"col-lg-1"],[1,"col-lg-2"],["class","row mt-1 ml-1 mr-1",4,"ngFor","ngForOf"],["type","checkbox","name","notifySms",1,"form-check-input",3,"ngModel","ngModelChange"],["type","text","name","smsValue",1,"form-control",3,"disabled","ngModel","ngModelChange"],[3,"disabled","entries",6,"placeholder"],[1,"pl-3"],[1,"pl-2"],["routerLink","/staff/catalog/hold/C","queryParamsHandling","merge"],[1,"btn","btn-outline-primary",3,"disabled"],["routerLink","/staff/catalog/hold/R","queryParamsHandling","merge"],["routerLink","/staff/catalog/hold/F","queryParamsHandling","merge"],[1,"font-italic"],[1,"row","mt-1","ml-1","mr-1"],["class","col-lg-12",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"routerLink"],[4,"ngIf","ngIfElse"],["class","row","style","background-color:inherit; border:none",4,"ngIf"],[1,"pr-1",3,"alt","title","src"],[1,"form-control",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"alert","alert-info","p-1","ml-2"],[1,"alert","alert-primary","p-1","ml-2"],[1,"alert","alert-success","p-1","ml-2"],[1,"alert","alert-danger","p-1","ml-2",3,"title"],[1,"btn","btn-info",3,"click"],[1,"row",2,"background-color","inherit","border","none"],[1,"col-lg-11","d-flex"],[1,"form-check","ml-3"],["type","checkbox",1,"form-check-input",3,"disabled","ngModel","ngModelChange"],[1,"ml-1",3,"alt","title","src"],[1,"form-check-label","ml-1"]],template:function(e,t){1&e&&(b.Mb(0,"eg-patron-search-dialog",null,0),b.Rb(2,"div",1),b.Rb(3,"div",2),b.Rb(4,"h3"),b.bc(5,Vb),b.Kc(6,Hb,2,2,"small",3),b.Yb(),b.Qb(),b.Qb(),b.Rb(7,"div",4),b.Rb(8,"button",5),b.fc("click",(function(){return t.searchPatrons()})),b.Rb(9,"span",6),b.Xb(10,Cb),b.Mc(11,"search"),b.Qb(),b.Rb(12,"span",7),b.Vb(13,Qb),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(14,"form",8),b.fc("keydown.enter",(function(e){return e.preventDefault()})),b.Rb(15,"div",1),b.Rb(16,"div",9),b.Rb(17,"div",10),b.Rb(18,"div",11),b.Rb(19,"div",12),b.Rb(20,"input",13),b.fc("change",(function(){return t.holdForChanged()}))("ngModelChange",(function(e){return t.holdFor=e})),b.Qb(),b.Rb(21,"label",14),b.Vb(22,Ib),b.Qb(),b.Qb(),b.Qb(),b.Rb(23,"div",11),b.Rb(24,"div",15),b.Rb(25,"input",16),b.fc("keyup.enter",(function(){return t.userBarcodeChanged()}))("ngModelChange",(function(e){return t.userBarcode=e}))("change",(function(){return t.userBarcodeChanged()})),b.Qb(),b.Rb(26,"div",17),b.Rb(27,"button",18),b.fc("click",(function(){return t.userBarcodeChanged()})),b.Mc(28,"Submit"),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(29,"div",10),b.Rb(30,"div",11),b.Rb(31,"div",12),b.Rb(32,"input",19),b.fc("change",(function(){return t.holdForChanged()}))("ngModelChange",(function(e){return t.holdFor=e})),b.Qb(),b.Rb(33,"label",14),b.Vb(34,_b),b.Qb(),b.Qb(),b.Qb(),b.Rb(35,"div",20),b.Mc(36),b.Qb(),b.Qb(),b.Rb(37,"div",10),b.Rb(38,"div",11),b.Rb(39,"label"),b.Vb(40,Sb),b.Qb(),b.Qb(),b.Rb(41,"div",11),b.Mb(42,"eg-org-select",21),b.Qb(),b.Qb(),b.Rb(43,"div",10),b.Rb(44,"div",11),b.Rb(45,"div",12),b.Rb(46,"input",22),b.fc("ngModelChange",(function(e){return t.suspend=e})),b.Qb(),b.Rb(47,"label",14),b.Vb(48,Tb),b.Qb(),b.Qb(),b.Qb(),b.Rb(49,"div",11),b.Rb(50,"eg-date-select",23),b.fc("onChangeAsISO",(function(e){return t.activeDateSelected(e)})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(51,"div",11),b.Rb(52,"div",24),b.Rb(53,"div",25),b.Rb(54,"h4"),b.Vb(55,kb),b.Qb(),b.Qb(),b.Rb(56,"ul",26),b.Rb(57,"li",27),b.Rb(58,"div",28),b.Rb(59,"div",12),b.Rb(60,"input",29),b.fc("ngModelChange",(function(e){return t.notifyEmail=e})),b.Qb(),b.Rb(61,"label",14),b.Vb(62,$b),b.Qb(),b.Qb(),b.Qb(),b.Rb(63,"div",28),b.Rb(64,"div",15),b.Rb(65,"div",30),b.Rb(66,"span",31),b.Vb(67,wb),b.Qb(),b.Qb(),b.Mb(68,"input",32),b.Qb(),b.Qb(),b.Qb(),b.Rb(69,"li",27),b.Rb(70,"div",28),b.Rb(71,"div",12),b.Rb(72,"input",33),b.fc("ngModelChange",(function(e){return t.notifyPhone=e})),b.Qb(),b.Rb(73,"label",14),b.Vb(74,Mb),b.Qb(),b.Qb(),b.Qb(),b.Rb(75,"div",28),b.Rb(76,"div",15),b.Rb(77,"div",30),b.Rb(78,"span",31),b.Vb(79,Nb),b.Qb(),b.Qb(),b.Rb(80,"input",34),b.fc("ngModelChange",(function(e){return t.phoneValue=e})),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Kc(81,qb,12,3,"li",35),b.Kc(82,jb,7,2,"li",35),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(83,"div",10),b.Rb(84,"div",36),b.Rb(85,"button",37),b.fc("click",(function(){return t.placeHolds()})),b.Vb(86,Ob),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Rb(87,"div",1),b.Rb(88,"div",38),b.Mb(89,"hr"),b.Qb(),b.Qb(),b.Rb(90,"div",39),b.Rb(91,"div",40),b.Rb(92,"span",41),b.bc(93,ad),b.Kc(94,Yb,2,0,"ng-container",3),b.Kc(95,Wb,2,0,"ng-container",3),b.Kc(96,Zb,2,0,"ng-container",3),b.Kc(97,Jb,2,0,"ng-container",3),b.Kc(98,ed,2,0,"ng-container",3),b.Kc(99,td,2,0,"ng-container",3),b.Kc(100,cd,2,0,"ng-container",3),b.Kc(101,pd,2,0,"ng-container",3),b.Yb(),b.Qb(),b.Qb(),b.Mb(102,"div",28),b.Rb(103,"div"),b.Kc(104,md,15,3,"span",42),b.Qb(),b.Qb(),b.Kc(105,Rd,2,0,"ng-template",null,43,b.Lc),b.Rb(107,"div",44),b.Rb(108,"div",45),b.Rb(109,"div",46),b.Vb(110,zb),b.Qb(),b.Rb(111,"div",47),b.Vb(112,Pb),b.Qb(),b.Rb(113,"div",46),b.Vb(114,Lb),b.Qb(),b.Rb(115,"div",47),b.Vb(116,Ab),b.Qb(),b.Rb(117,"div",47),b.Vb(118,Bb),b.Qb(),b.Rb(119,"div",46),b.Vb(120,Eb),b.Qb(),b.Rb(121,"div",47),b.Vb(122,Db),b.Qb(),b.Rb(123,"div",46),b.Vb(124,Fb),b.Qb(),b.Qb(),b.Kc(125,Bd,2,1,"div",48),b.Qb()),2&e&&(b.xb(6),b.oc("ngIf",t.user),b.xb(14),b.oc("ngModel",t.holdFor),b.xb(5),b.oc("disabled","patron"!=t.holdFor)("ngModel",t.userBarcode),b.xb(7),b.oc("ngModel",t.holdFor),b.xb(4),b.Nc(t.requestor.usrname()),b.xb(6),b.oc("applyOrgId",t.pickupLib),b.xb(4),b.oc("ngModel",t.suspend),b.xb(4),b.oc("disabled",!t.suspend),b.xb(10),b.oc("disabled",!t.user||!t.user.email())("ngModel",t.notifyEmail),b.xb(8),b.pc("value",t.user?t.user.email():""),b.oc("disabled",!0),b.xb(4),b.oc("ngModel",t.notifyPhone),b.xb(8),b.oc("disabled",!t.notifyPhone)("ngModel",t.phoneValue),b.xb(1),b.oc("ngIf",t.smsEnabled),b.xb(1),b.oc("ngIf",t.smsEnabled),b.xb(3),b.oc("disabled",!t.user||t.placeHoldsClicked),b.xb(9),b.oc("ngIf","M"==t.holdType),b.xb(1),b.oc("ngIf","T"==t.holdType),b.xb(1),b.oc("ngIf","V"==t.holdType),b.xb(1),b.oc("ngIf","F"==t.holdType),b.xb(1),b.oc("ngIf","C"==t.holdType),b.xb(1),b.oc("ngIf","R"==t.holdType),b.xb(1),b.oc("ngIf","I"==t.holdType),b.xb(1),b.oc("ngIf","P"==t.holdType),b.xb(3),b.oc("ngIf",t.isItemHold()),b.xb(21),b.oc("ngForOf",t.holdContexts))},directives:[yb,u.v,p.J,p.u,p.v,p.B,p.c,p.t,p.w,R.a,p.a,xb.a,u.u,hl.a,r.f,p.y,p.I],encapsulation:2}),e})();var Fd,Vd,Kd;function Xd(e,t){1&e&&(b.Rb(0,"div",3),b.Rb(1,"div",4),b.Rb(2,"div",5),b.Rb(3,"div",6),b.Rb(4,"span",7),b.Vb(5,Fd),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}function Gd(e,t){1&e&&(b.Rb(0,"div"),b.Rb(1,"div",8),b.Rb(2,"div",9),b.Rb(3,"div",10),b.Rb(4,"span"),b.Vb(5,Vd),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Qb())}function Hd(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"a",21),b.Mc(2),b.Qb(),b.Ob()),2&e){const e=b.hc(2).$implicit,t=b.hc(2);b.xb(1),b.oc("queryParams",t.searchByBrowseEntryParams(e)),b.xb(1),b.Pc(" ",e.value," (",e.sources,") ")}}function qd(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"span"),b.Mc(2),b.Qb(),b.Ob()),2&e){const e=b.hc(2).$implicit;b.xb(2),b.Nc(e.value)}}function Ud(e,t){1&e&&(b.bc(0,Kd,1),b.Nb(1),b.Yb())}function jd(e,t){1&e&&(b.bc(0,Kd,2),b.Nb(1),b.Yb())}function Yd(e,t){1&e&&(b.bc(0,Kd,3),b.Nb(1),b.Yb())}function Wd(e,t){1&e&&(b.bc(0,Kd,4),b.Nb(1),b.Yb())}function Zd(e,t){if(1&e&&(b.Rb(0,"div",3),b.Rb(1,"div",22),b.bc(2,Kd),b.Rb(3,"span",23),b.Kc(4,Ud,2,0,"ng-container",1),b.Kc(5,jd,2,0,"ng-container",1),b.Kc(6,Yd,2,0,"ng-container",1),b.Kc(7,Wd,2,0,"ng-container",1),b.Qb(),b.Mb(8,"a",24),b.Yb(),b.Qb(),b.Qb()),2&e){const e=t.$implicit,c=b.hc(4);b.xb(4),b.oc("ngIf",!e.type||"variant"==e.type),b.xb(1),b.oc("ngIf","broader"==e.type),b.xb(1),b.oc("ngIf","narrower"==e.type),b.xb(1),b.oc("ngIf","other"==e.type),b.xb(1),b.oc("queryParams",c.newBrowseFromHeadingParams(e)),b.Zb(e.heading)(e.target_count),b.Wb(2)}}function Jd(e,t){if(1&e&&(b.Rb(0,"div",18),b.Rb(1,"div",19),b.Rb(2,"div",20),b.Kc(3,Hd,3,3,"ng-container",1),b.Kc(4,qd,3,1,"ng-container",1),b.Kc(5,Zd,9,7,"div",16),b.Qb(),b.Qb(),b.Qb()),2&e){const e=b.hc().$implicit;b.xb(3),b.oc("ngIf",e.sources>0),b.xb(1),b.oc("ngIf",0==e.sources),b.xb(1),b.oc("ngForOf",e.compiledHeadings)}}function eh(e,t){if(1&e&&(b.Rb(0,"div",3),b.Kc(1,Jd,6,3,"div",17),b.Qb()),2&e){const e=t.$implicit;b.xb(1),b.oc("ngIf",e.value)}}function th(e,t){if(1&e){const e=b.Sb();b.Rb(0,"div",11),b.Rb(1,"div",12),b.Rb(2,"div",13),b.Rb(3,"button",14),b.fc("click",(function(){return b.Bc(e),b.hc().prevPage()})),b.Mc(4,"Back"),b.Qb(),b.Rb(5,"button",15),b.fc("click",(function(){return b.Bc(e),b.hc().nextPage()})),b.Mc(6,"Next"),b.Qb(),b.Qb(),b.Qb(),b.Kc(7,eh,2,1,"div",16),b.Rb(8,"div",12),b.Rb(9,"div",13),b.Rb(10,"button",14),b.fc("click",(function(){return b.Bc(e),b.hc().prevPage()})),b.Mc(11,"Back"),b.Qb(),b.Rb(12,"button",15),b.fc("click",(function(){return b.Bc(e),b.hc().nextPage()})),b.Mc(13,"Next"),b.Qb(),b.Qb(),b.Qb(),b.Qb()}if(2&e){const e=b.hc();b.xb(7),b.oc("ngForOf",e.results)}}Fd=$localize`:␟ec967aea6202d50552ab385751214fcb816e7218␟3926189656918144187:Searching..`,Vd=$localize`:␟6b90aaee4294ccb5e34a4413ebe3f4649d70167f␟5773175567567821732:No Maching Items Were Found`,Kd=$localize`:␟2e272cf934e9c35f23d2cf7fa9eaa8f2921cb0d4␟4561357499037848734:${"\ufffd#3\ufffd"}:START_TAG_SPAN:${"\ufffd*4:1\ufffd\ufffd#1:1\ufffd"}:START_TAG_NG_CONTAINER: See ${"[\ufffd/#1:1\ufffd\ufffd/*4:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*6:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*7:4\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*5:2\ufffd\ufffd#1:2\ufffd"}:START_TAG_NG_CONTAINER_1: Broader term ${"[\ufffd/#1:1\ufffd\ufffd/*4:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*6:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*7:4\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*6:3\ufffd\ufffd#1:3\ufffd"}:START_TAG_NG_CONTAINER_2: Narrower term ${"[\ufffd/#1:1\ufffd\ufffd/*4:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*6:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*7:4\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd*7:4\ufffd\ufffd#1:4\ufffd"}:START_TAG_NG_CONTAINER_3: Related term ${"[\ufffd/#1:1\ufffd\ufffd/*4:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*5:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*6:3\ufffd|\ufffd/#1:4\ufffd\ufffd/*7:4\ufffd]"}:CLOSE_TAG_NG_CONTAINER:${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN:${"\ufffd#8\ufffd"}:START_LINK: ${"\ufffd0\ufffd"}:INTERPOLATION: (${"\ufffd1\ufffd"}:INTERPOLATION_1:) ${"\ufffd/#8\ufffd"}:CLOSE_LINK:`,Kd=b.ac(Kd);let ch=(()=>{class e{constructor(e,t,c,a){this.route=e,this.cat=t,this.catUrl=c,this.staffCat=a}ngOnInit(){this.searchContext=this.staffCat.searchContext,this.routeSub=this.route.queryParamMap.subscribe(e=>this.browseByUrl(e))}ngOnDestroy(){this.routeSub.unsubscribe()}browseByUrl(e){this.catUrl.applyUrlParams(this.searchContext,e);const t=this.searchContext.browseSearch;"keyword"===t.fieldClass&&(t.fieldClass="title"),t.isSearchable()&&(this.results=[],this.cat.browse(this.searchContext).subscribe(e=>this.addResult(e)))}addResult(e){e.compiledHeadings=[];const t={};e.sees.forEach(c=>{c.control_set&&c.headings.forEach(c=>{const a=c[Object.keys(c)[0]][0],o=e.list_authorities.filter(e=>Number(e)===Number(a.target))[0];a.target&&a.main_entry&&a.target_count&&!o&&!t[a.target]&&(t[a.target]=!0,e.compiledHeadings.push({heading:a.heading,target:a.target,target_count:a.target_count,type:a.type}))})}),this.results.push(e)}browseIsDone(){return this.searchContext.searchState===g.c.COMPLETE}browseIsActive(){return this.searchContext.searchState===g.c.SEARCHING}browseHasResults(){return this.browseIsDone()&&this.results.length>0}prevPage(){const e=this.results[0];e&&(this.searchContext.browseSearch.pivot=e.pivot_point,this.staffCat.browse())}nextPage(){const e=this.results[this.results.length-1];e&&(this.searchContext.browseSearch.pivot=e.pivot_point,this.staffCat.browse())}searchByBrowseEntryParams(e){const t=this.searchContext.clone();return t.browseSearch.reset(),t.termSearch.hasBrowseEntry=e.browse_entry+","+e.fields,this.catUrl.toUrlParams(t)}newBrowseFromHeadingParams(e){const t=this.searchContext.clone();return t.browseSearch.value=e.heading,this.catUrl.toUrlParams(t)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(r.a),b.Lb(n.a),b.Lb(s.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-catalog-browse-results"]],decls:3,vars:3,consts:[["class","row",4,"ngIf"],[4,"ngIf"],["id","staff-catalog-browse-results-container",4,"ngIf"],[1,"row"],[1,"col-lg-6","offset-lg-3","pt-3"],[1,"progress"],["role","progressbar","aria-valuenow","100","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-striped","active","w-100"],[1,"sr-only"],[1,"row","pt-3"],[1,"col-lg-6","offset-lg-3"],[1,"alert","alert-warning"],["id","staff-catalog-browse-results-container"],[1,"row","mb-2"],[1,"col-lg-3"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-primary","ml-3",3,"click"],["class","row",4,"ngFor","ngForOf"],["class","col-lg-12 card tight-card mb-2 bg-light",4,"ngIf"],[1,"col-lg-12","card","tight-card","mb-2","bg-light"],[1,"col-lg-8"],[1,"card-body"],["routerLink","/staff/catalog/search",3,"queryParams"],[1,"col-lg-10","offset-lg-1"],[1,"font-italic"],["routerLink","/staff/catalog/browse",3,"queryParams"]],template:function(e,t){1&e&&(b.Kc(0,Xd,6,0,"div",0),b.Kc(1,Gd,6,0,"div",1),b.Kc(2,th,14,1,"div",2)),2&e&&(b.oc("ngIf",t.browseIsActive()),b.xb(1),b.oc("ngIf",t.browseIsDone()&&!t.browseHasResults()),b.xb(1),b.oc("ngIf",t.browseHasResults()))},directives:[u.v,u.u,r.f],encapsulation:2}),e})();const ah=["searchForm"],oh=["bannerText",$localize`:␟93df42f16268240c7618bc964dceac5105b3f4a8␟2551770919821310290:Staff Catalog`];let rh=(()=>{class e{constructor(e){this.staffCat=e}ngOnInit(){this.staffCat.createContext(),this.searchForm.searchTab="browse"}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var c;1&e&&b.Ic(ah,!0),2&e&&b.yc(c=b.gc())&&(t.searchForm=c.first)},decls:5,vars:0,consts:[[6,"bannerText"],["searchForm",""]],template:function(e,t){1&e&&(b.Rb(0,"eg-staff-banner",0),b.Xb(1,oh),b.Qb(),b.Mb(2,"eg-catalog-search-form",null,1),b.Mb(4,"eg-catalog-browse-results"))},directives:[f.a,_c,ch],encapsulation:2}),e})();const ih=["searchForm"],nh=["bannerText",$localize`:␟93df42f16268240c7618bc964dceac5105b3f4a8␟2551770919821310290:Staff Catalog`];let sh=(()=>{class e{constructor(e){this.staffCat=e}ngOnInit(){this.staffCat.createContext(),this.searchForm.searchTab="cnbrowse"}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var c;1&e&&b.Ic(ih,!0),2&e&&b.yc(c=b.gc())&&(t.searchForm=c.first)},decls:5,vars:0,consts:[[6,"bannerText"],["searchForm",""]],template:function(e,t){1&e&&(b.Rb(0,"eg-staff-banner",0),b.Xb(1,nh),b.Qb(),b.Mb(2,"eg-catalog-search-form",null,1),b.Mb(4,"eg-catalog-cn-browse-results"))},directives:[f.a,_c,$s],encapsulation:2}),e})(),lh=(()=>{class e{canDeactivate(e){return!e.canDeactivate||e.canDeactivate()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=b.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var bh=c("ib0n");const dh=["successMsg"],hh=["failMsg"],fh=["text",$localize`:␟a84f83ff9819786c833bf432ecedc70d2f9c879f␟5505504997073746600:Setting Update Succeeded`],uh=["text",$localize`:␟5ff3534814cbf2aaf4201e18d05a3a7728ff6b9a␟3530616072501174474:Setting Update Failed`];var gh,ph,mh,Rh,yh,xh,vh,Ch,Qh,Ih;gh=$localize`:␟0f38f8c1a6a55ef23755a97974069ee06ad34ee1␟6783242207057721108: Default Search Library `,ph=$localize`:␟447e4d3ca3dc867c10c51a506f16eb6bc32262e6␟6217599562593785479: The default search library setting determines what library is searched from the advanced search screen and portal page by default. Manual selection of a search library will override it. One recommendation is to set the search library to the highest point you would normally want to search. `,mh=$localize`:␟61d8355a1a6178a34db463bb53ae29e9b97c43db␟274674750655180029: Preferred Library `,Rh=$localize`:␟9cef71639bef2ca7dcf64be2ae98227d0b2c324e␟1439315177160995376: The preferred library is used to show copies and URIs regardless of the library searched. One recommendation is to set this to your workstation library so that local copies show up first in search results. `,yh=$localize`:␟f04c8f1e162a22eae4cc6fba98fd1cee6e18b511␟2037791906609736246: Default Search Pane `,xh=$localize`:␟a48dfe6bf51ec0145d6e1f4f325f4620ff718b54␟6663842782934960288: Focus this search tab by default when opening new catalog pages. `,vh=$localize`:␟e623ddf740712cc685456b1eed329b5bba81b057␟5024593074214935340: Search Results Per Page `,Ch=$localize`:␟06e1c4c910aa2347b90e28e6050948afae552a0e␟4880846436502821352: The number of search results to display per page. `,Qh=$localize`:␟2e722e91db10e31f8956ac67f8e216e2670bb561␟8326122911836932604: Exclude Electronic Resources `,Ih=$localize`:␟4b6dd6861d77451b16932fd4a1cc8b970de3c2ae␟8954959306530591483: Add the 'Exclude Electronic Resources' checkbox to the main search form. `;const _h=["eg.search.search_lib","eg.search.pref_lib","eg.search.adv_pane","eg.catalog.results.count","eg.staffcat.exclude_electronic"],Sh=[{path:"",component:wc,resolve:{catResolver:bl},children:[{path:"search",component:ao},{path:"record/:id",component:ll},{path:"hold/:type",component:Dd},{path:"record/:id/:tab",component:ll,canDeactivate:[lh]}]},{path:"browse",component:rh,resolve:{catResolver:bl}},{path:"cnbrowse",component:sh,resolve:{catResolver:bl}},{path:"prefs",component:(()=>{class e{constructor(e,t,c){this.store=e,this.toast=t,this.staffCat=c,this.settings={}}ngOnInit(){this.staffCat.createContext(),this.store.getItemBatch(_h).then(e=>this.settings=e)}orgChanged(e,t){const c="eg.search.search_lib"===t?"defaultSearchOrg":"prefOrg";this.updateValue(t,e?e.id():null).then(e=>this.staffCat[c]=e)}paneChanged(e){this.updateValue("eg.search.adv_pane",e?e.id:null).then(e=>this.staffCat.defaultTab=e)}countChanged(){this.updateValue("eg.catalog.results.count",this.settings["eg.catalog.results.count"]||null).then(e=>{this.staffCat.searchContext.pager.limit=e||20})}checkboxChanged(e){const t=this.settings[e];this.updateValue(e,t||null),"eg.staffcat.exclude_electronic"===e&&(this.staffCat.showExcludeElectronic=t)}updateValue(e,t){return(null===t?this.store.removeItem(e):this.store.setItem(e,t)).then(e=>this.toast.success(this.successMsg.text)).then(e=>t)}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(x.a),b.Lb(vo.a),b.Lb(d))},e.\u0275cmp=b.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var c;1&e&&(b.Sc(dh,!0),b.Sc(hh,!0)),2&e&&(b.yc(c=b.gc())&&(t.successMsg=c.first),b.yc(c=b.gc())&&(t.failMsg=c.first))},decls:57,vars:5,consts:[["searchForm",""],["bannerText","Catalog Preferences"],[6,"text"],["successMsg",""],["failMsg",""],[1,"row","border-bottom","border-secondary","p-2","m-2"],[1,"col-lg-2","offset-lg-1"],["for","default-lib-selector",1,"font-weight-bold"],[1,"col-lg-2"],["domId","default-lib-selector",3,"applyOrgId","onChange"],[1,"col-lg-6"],["for","pref-lib-selector",1,"font-weight-bold"],["domId","pref-lib-selector",3,"applyOrgId","onChange"],["for","def-pane-selector",1,"font-weight-bold"],[3,"selectedId","onChange"],["entryId","advanced","entryLabel","Keyword Search"],["entryId","numeric","entryLabel","Numeric Search"],["entryId","expert","entryLabel","MARC Search"],["entryId","browse","entryLabel","Browse"],["entryId","cnbrowse","entryLabel","Shelf Browse"],["type","number","min","1","max","100",1,"form-control",3,"ngModel","ngModelChange","change"],[1,"checkbox","pl-3","pt-2"],["type","checkbox",3,"ngModel","change","ngModelChange"],[1,"pl-1"]],template:function(e,t){1&e&&(b.Mb(0,"eg-catalog-search-form",null,0),b.Mb(2,"eg-staff-banner",1),b.Rb(3,"eg-string",2,3),b.Xb(5,fh),b.Qb(),b.Rb(6,"eg-string",2,4),b.Xb(8,uh),b.Qb(),b.Rb(9,"div",5),b.Rb(10,"div",6),b.Rb(11,"label",7),b.Vb(12,gh),b.Qb(),b.Qb(),b.Rb(13,"div",8),b.Rb(14,"eg-org-select",9),b.fc("onChange",(function(e){return t.orgChanged(e,"eg.search.search_lib")})),b.Qb(),b.Qb(),b.Rb(15,"div",10),b.Vb(16,ph),b.Qb(),b.Qb(),b.Rb(17,"div",5),b.Rb(18,"div",6),b.Rb(19,"label",11),b.Vb(20,mh),b.Qb(),b.Qb(),b.Rb(21,"div",8),b.Rb(22,"eg-org-select",12),b.fc("onChange",(function(e){return t.orgChanged(e,"eg.search.pref_lib")})),b.Qb(),b.Qb(),b.Rb(23,"div",10),b.Vb(24,Rh),b.Qb(),b.Qb(),b.Rb(25,"div",5),b.Rb(26,"div",6),b.Rb(27,"label",13),b.Vb(28,yh),b.Qb(),b.Qb(),b.Rb(29,"div",8),b.Rb(30,"eg-combobox",14),b.fc("onChange",(function(e){return t.paneChanged(e)})),b.Mb(31,"eg-combobox-entry",15),b.Mb(32,"eg-combobox-entry",16),b.Mb(33,"eg-combobox-entry",17),b.Mb(34,"eg-combobox-entry",18),b.Mb(35,"eg-combobox-entry",19),b.Qb(),b.Qb(),b.Rb(36,"div",10),b.Vb(37,xh),b.Qb(),b.Qb(),b.Rb(38,"div",5),b.Rb(39,"div",6),b.Rb(40,"label",11),b.Vb(41,vh),b.Qb(),b.Qb(),b.Rb(42,"div",8),b.Rb(43,"input",20),b.fc("ngModelChange",(function(e){return t.settings["eg.catalog.results.count"]=e}))("change",(function(){return t.countChanged()})),b.Qb(),b.Qb(),b.Rb(44,"div",10),b.Vb(45,Ch),b.Qb(),b.Qb(),b.Rb(46,"div",5),b.Rb(47,"div",6),b.Rb(48,"label",11),b.Vb(49,Qh),b.Qb(),b.Qb(),b.Rb(50,"div",8),b.Rb(51,"div",21),b.Rb(52,"label"),b.Rb(53,"input",22),b.fc("change",(function(){return t.checkboxChanged("eg.staffcat.exclude_electronic")}))("ngModelChange",(function(e){return t.settings["eg.staffcat.exclude_electronic"]=e})),b.Qb(),b.Mb(54,"span",23),b.Qb(),b.Qb(),b.Qb(),b.Rb(55,"div",10),b.Vb(56,Ih),b.Qb(),b.Qb()),2&e&&(b.xb(14),b.oc("applyOrgId",t.settings["eg.search.search_lib"]),b.xb(8),b.oc("applyOrgId",t.settings["eg.search.pref_lib"]),b.xb(8),b.oc("selectedId",t.settings["eg.search.adv_pane"]),b.xb(13),b.oc("ngModel",t.settings["eg.catalog.results.count"]),b.xb(10),b.oc("ngModel",t.settings["eg.staffcat.exclude_electronic"]))},directives:[_c,f.a,_.a,R.a,hl.a,bh.a,p.z,p.c,p.t,p.w,p.a],encapsulation:2}),e})(),resolve:{catResolver:bl}}];let Th=(()=>{class e{}return e.\u0275mod=b.Jb({type:e}),e.\u0275inj=b.Ib({factory:function(t){return new(t||e)},providers:[bl],imports:[[r.g.forChild(Sh)],r.g]}),e})();var kh=c("idTy"),$h=c("fkVb");let wh=(()=>{class e{}return e.\u0275mod=b.Jb({type:e}),e.\u0275inj=b.Ib({factory:function(t){return new(t||e)},providers:[],imports:[[o.a]]}),e})();var Mh=c("Y/mG"),Nh=c("9u+K");let Oh=(()=>{class e{}return e.\u0275mod=b.Jb({type:e}),e.\u0275inj=b.Ib({factory:function(t){return new(t||e)},providers:[d],imports:[[o.a,a.a,Th,kh.a,$h.a,wh,Mh.a,Nh.a]]}),e})()}}]);