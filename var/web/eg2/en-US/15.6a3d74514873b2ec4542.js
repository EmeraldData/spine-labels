(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"NF/O":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var a=i("fXoL");class c{constructor(e){this.record=new MARC21.Record({marcxml:e,delimiter:"$"}),this.breakerText=this.record.toBreaker(),this.fixedFieldChange=new a.n}get leader(){return this.record.leader}set leader(e){this.record.leader=e}get fields(){return this.record.fields}set fields(e){this.record.fields=e}toXml(){return this.record.toXmlString()}toBreaker(){return this.record.toBreaker()}recordType(){return this.record.recordType()}absorbBreakerChanges(){this.record=new MARC21.Record({marcbreaker:this.breakerText,delimiter:"$"})}extractFixedField(e){return this.record.extractFixedField(e)}setFixedField(e,t){const i=this.record.setFixedField(e,t);return this.fixedFieldChange.emit(e),i}stampFieldIds(){this.fields.forEach(e=>this.stampFieldId(e))}stampFieldId(e){e.fieldId||(e.fieldId=Math.floor(1e7*Math.random())),void 0===e.isCtrlField&&(e.isCtrlField=e.isControlfield())}field(e,t){return this.record.field(e,t)}appendFields(...e){this.record.appendFields.apply(this.record,e),this.stampFieldIds()}insertFieldsBefore(e,...t){this.record.insertFieldsBefore.apply(this.record,[e].concat(t)),this.stampFieldIds()}insertFieldsAfter(e,...t){this.record.insertFieldsAfter.apply(this.record,[e].concat(t)),this.stampFieldIds()}insertOrderedFields(...e){this.record.insertOrderedFields.apply(this.record,e),this.stampFieldIds()}generate008(){return this.record.generate008()}deleteFields(...e){this.record.deleteFields.apply(this.record,e)}getField(e){return this.fields.filter(t=>t.fieldId===e)[0]}getPreviousField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].fieldId===e)return this.fields[t-1]}getNextField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].fieldId===e)return this.fields[t+1]}newField(e){const t=new MARC21.Field(e);return this.stampFieldId(t),t}cloneField(e){const t={tag:e.tag};return e.isControlfield()?t.data=e.data:(t.ind1=e.ind1,t.ind2=e.ind2,t.subfields=this.cloneSubfields(e.subfields)),this.newField(t)}cloneSubfields(e){const t=[];return e.forEach(e=>t.push([].concat(e))),t}subfield(e,t){return this.record.subfield(e,t)}}},eklK:function(e,t,i){"use strict";i.r(t),i.d(t,"CourseReservesModule",(function(){return ta}));var a,c=i("tNs6"),r=i("MZHd"),s=i("GLCv"),l=i("tyNb"),o=i("wBwE"),d=i("iA0r"),n=i("+MQy"),b=i("9Zsr"),u=i("MWGh"),f=i("UUQ6"),g=i("tNQm"),h=i("YRS1"),m=i("A9LY"),p=i("8PDw"),v=i("VRyK"),R=i("rRT/"),C=i("Osig"),S=i("EQDH"),x=i("cm5s"),Q=i("fXoL"),y=i("1kSV"),M=i("ofXK"),I=i("QGNW"),F=i("t7hH"),_=i("3Pt+"),T=i("9rfo"),w=i("3r+m"),$=i("NF/O"),L=i("r7vI"),z=i("ib0n");a=$localize`:␟010339e6584e1c44f5aa721080c96cf7bb471761␟6907807228975360219:Form`;const N=["entryLabel",$localize`:␟0168afa02c0d4ce6e146869c996c380281b372a7␟8811654603887222317:<None selected>`];var D,k;function X(e,t){if(1&e&&(Q.Pb(0),Q.Rb(1,"div",3),Q.Rb(2,"label",13),Q.Mc(3),Q.Qb(),Q.Qb(),Q.Rb(4,"div",4),Q.Mb(5,"input",14),Q.Qb(),Q.Ob()),2&e){const e=Q.hc().$implicit,t=Q.hc().$implicit,i=Q.hc(2);Q.xb(2),Q.rc("for","",i.idPrefix,"-",i.editorFieldIdentifier(t,e),""),Q.xb(1),Q.Oc(" ",i.subfieldLabels[i.editorFieldIdentifier(t,e)]," "),Q.xb(2),Q.rc("id","",i.idPrefix,"-",i.editorFieldIdentifier(t,e),""),Q.pc("formControlName",i.editorFieldIdentifier(t,e))}}function A(e,t){if(1&e&&(Q.Rb(0,"div",2),Q.Kc(1,X,6,6,"ng-container",0),Q.Qb()),2&e){const e=t.$implicit;Q.xb(1),Q.oc("ngIf",!e[1])}}function O(e,t){if(1&e&&(Q.Pb(0),Q.Kc(1,A,2,1,"div",12),Q.Ob()),2&e){const e=t.$implicit;Q.xb(1),Q.oc("ngForOf",e.subfields)}}function E(e,t){if(1&e&&(Q.Pb(0),Q.Mc(1),Q.Ob()),2&e){const e=Q.hc(2);Q.xb(1),Q.Nc(e.buttonLabel)}}function P(e,t){1&e&&(Q.Pb(0),Q.Vb(1,k),Q.Ob())}function V(e,t){if(1&e){const e=Q.Sb();Q.Pb(0),Q.Rb(1,"form",1),Q.Rb(2,"div",2),Q.Rb(3,"div",3),Q.Vb(4,a),Q.Qb(),Q.Rb(5,"div",4),Q.Rb(6,"eg-combobox",5,6),Q.Rb(8,"eg-combobox-entry",7),Q.Xb(9,N),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(10,"div",2),Q.Rb(11,"div",3),Q.Vb(12,D),Q.Qb(),Q.Rb(13,"div",4),Q.Mb(14,"eg-combobox",8,9),Q.Qb(),Q.Qb(),Q.Kc(16,O,2,1,"ng-container",10),Q.Rb(17,"button",11),Q.fc("click",(function(){return Q.Bc(e),Q.hc().emitXml()})),Q.Kc(18,E,2,1,"ng-container",0),Q.Kc(19,P,2,0,"ng-container",0),Q.Qb(),Q.Qb(),Q.Ob()}if(2&e){const e=Q.hc();Q.xb(1),Q.oc("formGroup",e.editor),Q.xb(5),Q.oc("entries",e.marcForms)("selectedId",e.defaultMarcForm),Q.xb(8),Q.oc("entries",e.marcTypes),Q.xb(2),Q.oc("ngForOf",e.fields),Q.xb(2),Q.oc("ngIf",e.buttonLabel),Q.xb(1),Q.oc("ngIf",!e.buttonLabel)}}D=$localize`:␟f61c6867295f3b53d23557021f2f4e0aa1d0b8fc␟8650499415827640724:Type`,k=$localize`:␟52c9a103b812f258bcddc3d90a6e3f46871d25fe␟3768927257183755959:Save`;let B=(()=>{class e{constructor(e,t){this.net=e,this.tagTable=t,this.xmlRecordEvent=new Q.n,this.fields=[],this.fieldIndex=0,this.subfieldLabels={}}ngOnInit(){this.idPrefix="marc-simplified-editor-"+Math.floor(1e5*Math.random()),this.editor=new _.j({marcForm:new _.g,marcType:new _.g}),this.addField=e=>{e.fieldId=this.fieldIndex,this.fields.push(e),e.subfields.forEach(t=>{this.editor.addControl(this.editorFieldIdentifier(e,t),new _.g(null,[]))}),this.fieldIndex++},this.editorFieldIdentifier=(e,t)=>e.tag+t[0],this.net.request("open-ils.cat","open-ils.cat.biblio.fixed_field_values.by_rec_type","BKS","Form").subscribe(e=>{this.marcForms=e.Form.map(e=>({id:e[0],label:e[1]}))}),this.net.request("open-ils.cat","open-ils.cat.biblio.fixed_field_values.by_rec_type","BKS","Type").subscribe(e=>{this.marcTypes=e.Type.map(e=>({id:e[0],label:e[1]}))})}ngAfterViewInit(){this.tagTable.loadTags({marcRecordType:"biblio",ffType:"BKS"}).then(e=>{this.fields.forEach(t=>{t.subfields.forEach(i=>{this.subfieldLabels[this.editorFieldIdentifier(t,i)]=e.getSubfieldLabel(t.tag,i[0])})})})}emitXml(){const e=new $.a('<record xmlns="http://www.loc.gov/MARC21/slim"></record>');this.fields.forEach(e=>{e.subfields.forEach(t=>{""===t[1]&&(t[1]=this.editor.get(this.editorFieldIdentifier(e,t)).value)})}),e.fields=this.fields;const t=e.newField({tag:"008",data:e.generate008()});e.insertOrderedFields(t),e.setFixedField("Type",this.appropriateMarcType),e.setFixedField("Form",this.appropriateMarcForm),this.xmlRecordEvent.emit(e.toXml())}get appropriateMarcType(){return this.editor.get("marcType").value?this.editor.get("marcType").value.id:"a"}get appropriateMarcForm(){return this.editor.get("marcForm").value?this.editor.get("marcForm").value.id:this.defaultMarcForm?this.defaultMarcForm:" "}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(C.b),Q.Lb(L.a))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-marc-simplified-editor"]],inputs:{buttonLabel:"buttonLabel",defaultMarcForm:"defaultMarcForm"},outputs:{xmlRecordEvent:"xmlRecordEvent"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-lg-3"],[1,"col-lg-9"],["formControlName","marcForm",3,"entries","selectedId"],["formCombobox",""],["entryId"," ",6,"entryLabel"],["formControlName","marcType","selectedId","a",3,"entries"],["typeCombobox",""],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],["class","row",4,"ngFor","ngForOf"],[3,"for"],[3,"id","formControlName"]],template:function(e,t){1&e&&Q.Kc(0,V,20,7,"ng-container",0),2&e&&Q.oc("ngIf",t.editor&&t.subfieldLabels&&t.marcForms&&t.marcTypes)},directives:[M.v,_.J,_.u,_.k,T.a,_.t,_.i,z.a,M.u,_.c],encapsulation:2}),e})(),K=(()=>{class e{constructor(e){this.editor=e,this.tag="a",this.ind1=" ",this.ind2=" ",this.subfieldIndex=1}ngOnInit(){this.marcVersion={tag:this.tag,subfields:[],authValid:!1,authChecked:!1,isCtrlField:!1,isControlfield:()=>!1,indicator:e=>1===e?this.ind1:this.ind2,deleteExactSubfields:(...e)=>0},this.addSubfield=(e,t)=>{this.marcVersion.subfields.push([e,t||"",this.subfieldIndex]),this.subfieldIndex+=1}}ngAfterViewInit(){this.editor.addField(this.marcVersion)}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(B,1))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-marc-simplified-editor-field"]],inputs:{tag:"tag",ind1:"ind1",ind2:"ind2"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})(),U=(()=>{class e{constructor(e){this.field=e}ngOnInit(){this.field.addSubfield(this.code,this.defaultValue)}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(K,1))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-marc-simplified-editor-subfield"]],inputs:{code:"code",defaultValue:"defaultValue"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();const G=["editDialog"],q=["materialsGrid"],W=["materialDeleteFailedString"],j=["materialDeleteSuccessString"],Z=["materialAddSuccessString"],J=["materialAddFailedString"],H=["materialEditSuccessString"],Y=["materialEditFailedString"],ee=["materialAddDifferentLibraryString"],te=["text",$localize`:␟d576732792e90cbdfeb47903767d245121c71fbd␟2956587270277429487:Disassociation of Course Material failed or was not allowed`],ie=["text",$localize`:␟2e67e3df37ce4e99fdcb11b3372e9b083f023bc8␟5998181818214266321:Disassociation of Course Material succeeded`],ae=["text",$localize`:␟093cabeb42c629e6a91b7247f0ddebb18826b0c8␟3036437680272065244:Association of Course Material succeeded`],ce=["text",$localize`:␟e00f90ae72f2a9a739498c42437bce05ea005ea2␟6874201161169545188:Association of Course Material failed or was not allowed`],re=["text",$localize`:␟576560ae34907ed6c3d5fe4139aa2bbbda3fb2b6␟1122336509019722909:Update of Course Material succeeded`],se=["text",$localize`:␟87dfcc0573575dc3550650d6f6914e1cd1405947␟5626422674186531147:Update of Course Material failed or was not allowed`],le=["text",$localize`:␟cb734c1c45beb03180d646bad1fdb5ecae0910c4␟7448865328754652118:Material exists at a different library`];var oe,de,ne;oe=$localize`:␟45115178f0211d9ca4a7f78929cd8fc6e27c7540␟6103446261666052921:Course Materials`,de=$localize`:␟2ff777e376c5d7cc3a464cd64d2ba845f669ca4b␟3320741126473193507:Associate item`,ne=$localize`:␟2605ec3a5c89c633a5ff850058471e3b1cefd028␟3365641651591625125:Associate brief record`;const be=["label",$localize`:␟2e8a801b0c1e998d482eae318c975ef999fe3416␟1513762969482503855:Remove Selected`],ue=["label",$localize`:␟c525cbf6c3ff841184f81b04f0303bce644b1c51␟2886653045266158715:Edit Selected`],fe=["label",$localize`:␟45cc8ca94b5a50842a9a8ef804a5ab089a38ae5c␟8040881171107393560:ID`],ge=["label",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`],he=["label",$localize`:␟fdf7cbdc140d0aab0f0b6c06065a0fd448ed6a2e␟5701618810648052610:Title`],me=["label",$localize`:␟115508ef944d0bdb066e511220b8679efd7fb4b2␟6100860029551607069:Call Number`],pe=["label",$localize`:␟91cf7696f1ff827095be6ef51a8e8cfe548553c7␟7191542028183887855:Call Number Prefix`],ve=["label",$localize`:␟ee334107c83a4c6dc1c5fa2be7c06fc763d6f3bc␟3703469904608875490:Call Number Suffix`],Re=["label",$localize`:␟172a27bb1b7db1ef4a56779c6dcdc20a602a16e7␟3860933437516464957:Circulation Modifier`],Ce=["label",$localize`:␟0c77d47b63e66bb2f96c28dd3e19fd2a280a32a3␟4967380101942888520:Circulation Library`],Se=["label",$localize`:␟5e3e384df062924aa75d2f5ca826e1e077372153␟8734320241258430920:Shelving Location`],xe=["label",$localize`:␟06056db1c8d4fa9ca80746f967a6223f964a8f9e␟3108971652395278417:Item Status`],Qe=["label",$localize`:␟58e250f1a96d73d2895040f4658138d435baf099␟7932901008790165646:Original Circulation Modifier`],ye=["label",$localize`:␟77ed396bd801b7067f515e04ac1e3679dc3d1b59␟339382231784472670:Original Shelving Location`],Me=["label",$localize`:␟d810902832b26c7164e332215d41e95d5fe616a1␟5288167318454216809:Original Item Status`],Ie=["label",$localize`:␟0f9790eb79f6eb72b2aa42ed75472da5d8431ecd␟7612675227076281553:Relationship`],Fe=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];function _e(e,t){if(1&e){const e=Q.Sb();Q.Pb(0),Q.Rb(1,"button",43),Q.Xb(2,Fe),Q.fc("click",(function(){return Q.Bc(e),Q.hc(2).close()})),Q.Rb(3,"span",44),Q.Mc(4,"\xd7"),Q.Qb(),Q.Qb(),Q.Ob()}}var Te,we,$e,Le,ze,Ne;Te=$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`,we=$localize`:␟0f9790eb79f6eb72b2aa42ed75472da5d8431ecd␟7612675227076281553:Relationship`,$e=$localize`:␟db9a98729c93803ae77186ecbecdace7bce50e21␟3786241089788710399: Add Material `,Le=$localize`:␟e9e5aafd3c804d8556196d9978942045b5657ae5␟285095168500929286:The following fields will be applied to the material added, and reverted once the course is no longer associated with the material.`,ze=$localize`:␟115508ef944d0bdb066e511220b8679efd7fb4b2␟6100860029551607069:Call Number`,Ne=$localize`:␟172a27bb1b7db1ef4a56779c6dcdc20a602a16e7␟3860933437516464957:Circulation Modifier`;const De=["placeholder",$localize`:␟f9f517a0905f0aceab18235ac7a3415f09e63a55␟4837841669818632232:Circulation Modifier...`];var ke;ke=$localize`:␟06056db1c8d4fa9ca80746f967a6223f964a8f9e␟3108971652395278417:Item Status`;const Xe=["placeholder",$localize`:␟f30fd53adaeda944bd842f44f422cbe296835f21␟3288319011752417012:Item Status...`];var Ae,Oe;function Ee(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",45),Q.Rb(1,"div",46),Q.Rb(2,"div",47),Q.Rb(3,"div",48),Q.Rb(4,"label",49),Q.Vb(5,Te),Q.Qb(),Q.Qb(),Q.Rb(6,"input",50),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).barcodeInput=t}))("click",(function(t){return Q.Bc(e),t.target.select()}))("keyup.enter",(function(){Q.Bc(e);const t=Q.hc(2);return t.associateItem(t.barcodeInput,t.relationshipInput)})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(7,"div",46),Q.Rb(8,"div",47),Q.Rb(9,"div",48),Q.Rb(10,"span",51),Q.Vb(11,we),Q.Qb(),Q.Qb(),Q.Rb(12,"input",52),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).relationshipInput=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(13,"div",53),Q.Rb(14,"div",54),Q.Rb(15,"button",55),Q.fc("click",(function(){Q.Bc(e);const t=Q.hc(2);return t.associateItem(t.barcodeInput,t.relationshipInput)})),Q.Vb(16,$e),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(17,"div",56),Q.Rb(18,"div",57),Q.Rb(19,"h5"),Q.Vb(20,Le),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(21,"div",53),Q.Rb(22,"div",46),Q.Rb(23,"div",47),Q.Rb(24,"div",48),Q.Rb(25,"div",51),Q.Rb(26,"label",58),Q.Vb(27,ze),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(28,"input",59),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).tempCallNumber=t}))("input",(function(){return Q.Bc(e),Q.hc(2).isModifyingCallNumber=!0})),Q.Qb(),Q.Rb(29,"div",60),Q.Rb(30,"div",51),Q.Rb(31,"input",61),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).isModifyingCallNumber=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(32,"div",46),Q.Rb(33,"div",47),Q.Rb(34,"div",48),Q.Rb(35,"div",51),Q.Rb(36,"span"),Q.Vb(37,Ne),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(38,"eg-combobox",62),Q.Xb(39,De),Q.fc("onChange",(function(t){Q.Bc(e);const i=Q.hc(2);return i.tempCircMod=t.id,i.isModifyingCircMod=!0})),Q.Qb(),Q.Rb(40,"div",60),Q.Rb(41,"div",51),Q.Rb(42,"input",63),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).isModifyingCircMod=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(43,"div",53),Q.Rb(44,"div",46),Q.Rb(45,"div",47),Q.Rb(46,"div",48),Q.Rb(47,"div",51),Q.Rb(48,"span"),Q.Vb(49,ke),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(50,"eg-combobox",64),Q.Xb(51,Xe),Q.fc("onChange",(function(t){Q.Bc(e);const i=Q.hc(2);return i.tempStatus=t.id,i.isModifyingStatus=!0})),Q.Qb(),Q.Rb(52,"div",60),Q.Rb(53,"div",51),Q.Rb(54,"input",65),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).isModifyingStatus=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(55,"div",46),Q.Rb(56,"div",47),Q.Rb(57,"div",48),Q.Rb(58,"div",51),Q.Rb(59,"span"),Q.Vb(60,Ae),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(61,"eg-item-location-select",66),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).tempLocation=t}))("valueChange",(function(){return Q.Bc(e),Q.hc(2).isModifyingLocation=!0})),Q.Qb(),Q.Rb(62,"div",60),Q.Rb(63,"div",51),Q.Rb(64,"input",67),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).isModifyingLocation=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.hc(2),t=Q.zc(28);Q.oc("ngClass",e.isDialog()?"":"mt-3"),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12"),Q.xb(5),Q.oc("ngModel",e.barcodeInput)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(5),Q.oc("ngModel",e.relationshipInput)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(3),Q.oc("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())("disabled",!e.barcodeInput),Q.xb(7),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12"),Q.xb(6),Q.oc("ngModel",e.tempCallNumber)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(3),Q.oc("ngModel",e.isModifyingCallNumber)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(6),Q.oc("displayTemplate",t)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())("asyncSupportsEmptyTermClick",!0),Q.xb(4),Q.oc("ngModel",e.isModifyingCircMod)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(2),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12"),Q.xb(6),Q.oc("displayTemplate",t)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())("asyncSupportsEmptyTermClick",!0),Q.xb(4),Q.oc("ngModel",e.isModifyingStatus)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(6),Q.oc("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())("ngModel",e.tempLocation),Q.xb(3),Q.oc("ngModel",e.isModifyingLocation)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())}}Ae=$localize`:␟5e3e384df062924aa75d2f5ca826e1e077372153␟8734320241258430920:Shelving Location`,Oe=$localize`:␟0f9790eb79f6eb72b2aa42ed75472da5d8431ecd␟7612675227076281553:Relationship`;const Pe=["buttonLabel",$localize`:␟b189ad247e7649aa6bb134e9988ebf543124feff␟195963474117143295:Add material`],Ve=["defaultValue",$localize`:␟70121f6c810e9c70fbd321b055994bd47943605e␟4704985448805651286:This record was created using the Course Materials Module -- please edit it there`];function Be(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",46),Q.Rb(1,"div",47),Q.Rb(2,"div",48),Q.Rb(3,"span",51),Q.Vb(4,Oe),Q.Qb(),Q.Qb(),Q.Rb(5,"input",52),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).relationshipInput=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(6,"eg-marc-simplified-editor",68),Q.Xb(7,Pe),Q.fc("xmlRecordEvent",(function(t){return Q.Bc(e),Q.hc(2).associateBriefRecord(t)})),Q.Rb(8,"eg-marc-simplified-editor-field",69),Q.Mb(9,"eg-marc-simplified-editor-subfield",70),Q.Qb(),Q.Rb(10,"eg-marc-simplified-editor-field",71),Q.Mb(11,"eg-marc-simplified-editor-subfield",72),Q.Mb(12,"eg-marc-simplified-editor-subfield",73),Q.Mb(13,"eg-marc-simplified-editor-subfield",74),Q.Qb(),Q.Rb(14,"eg-marc-simplified-editor-field",75),Q.Rb(15,"eg-marc-simplified-editor-subfield",76),Q.Xb(16,Ve),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.hc(2);Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(5),Q.oc("ngModel",e.relationshipInput)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(8),Q.oc("defaultValue",e.currentCourse.owning_lib().shortname())}}var Ke,Ue,Ge,qe;function We(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",45),Q.Rb(1,"div",46),Q.Rb(2,"div",47),Q.Rb(3,"div",48),Q.Rb(4,"label",77),Q.Vb(5,Ke),Q.Qb(),Q.Qb(),Q.Rb(6,"input",78),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).bibId=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(7,"div",46),Q.Rb(8,"div",47),Q.Rb(9,"div",48),Q.Rb(10,"span",51),Q.Vb(11,Ue),Q.Qb(),Q.Qb(),Q.Rb(12,"input",79),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc(2).relationshipInput=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(13,"div",53),Q.Rb(14,"div",54),Q.Rb(15,"button",55),Q.fc("click",(function(){return Q.Bc(e),Q.hc(2).associateElectronicBibRecord()})),Q.Vb(16,Ge),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.hc(2);Q.oc("ngClass",e.isDialog()?"":"mt-3"),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(5),Q.oc("ngModel",e.bibId)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(5),Q.oc("ngModel",e.relationshipInput)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(3),Q.oc("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())}}function je(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",15),Q.Rb(1,"h4",16),Q.Vb(2,oe),Q.Qb(),Q.Kc(3,_e,5,0,"ng-container",12),Q.Qb(),Q.Rb(4,"div",17),Q.Rb(5,"div",18),Q.Rb(6,"div",17),Q.Rb(7,"ul",19,20),Q.Rb(9,"li",21),Q.Rb(10,"a",22),Q.Vb(11,de),Q.Qb(),Q.Kc(12,Ee,65,31,"ng-template",23),Q.Qb(),Q.Rb(13,"li",21),Q.Rb(14,"a",22),Q.Vb(15,ne),Q.Qb(),Q.Kc(16,Be,17,4,"ng-template",23),Q.Qb(),Q.Rb(17,"li",21),Q.Rb(18,"a",22),Q.Mc(19,"Associate electronic resource from catalog"),Q.Qb(),Q.Kc(20,We,17,8,"ng-template",23),Q.Qb(),Q.Qb(),Q.Mb(21,"div",24),Q.Qb(),Q.Rb(22,"div",25),Q.Rb(23,"eg-grid",26,27),Q.Rb(25,"eg-grid-toolbar-action",28),Q.Xb(26,be),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().deleteSelectedMaterials(t)})),Q.Qb(),Q.Rb(27,"eg-grid-toolbar-action",28),Q.Xb(28,ue),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().editSelectedMaterials(t)})),Q.Qb(),Q.Rb(29,"eg-grid-column",29),Q.Xb(30,fe),Q.Qb(),Q.Rb(31,"eg-grid-column",30),Q.Xb(32,ge),Q.Qb(),Q.Rb(33,"eg-grid-column",31),Q.Xb(34,he),Q.Qb(),Q.Rb(35,"eg-grid-column",32),Q.Xb(36,me),Q.Qb(),Q.Rb(37,"eg-grid-column",33),Q.Xb(38,pe),Q.Qb(),Q.Rb(39,"eg-grid-column",34),Q.Xb(40,ve),Q.Qb(),Q.Rb(41,"eg-grid-column",35),Q.Xb(42,Re),Q.Qb(),Q.Rb(43,"eg-grid-column",36),Q.Xb(44,Ce),Q.Qb(),Q.Rb(45,"eg-grid-column",37),Q.Xb(46,Se),Q.Qb(),Q.Rb(47,"eg-grid-column",38),Q.Xb(48,xe),Q.Qb(),Q.Rb(49,"eg-grid-column",39),Q.Xb(50,Qe),Q.Qb(),Q.Rb(51,"eg-grid-column",40),Q.Xb(52,ye),Q.Qb(),Q.Rb(53,"eg-grid-column",41),Q.Xb(54,Me),Q.Qb(),Q.Rb(55,"eg-grid-column",42),Q.Xb(56,Ie),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.zc(8),t=Q.hc(),i=Q.zc(24),a=Q.zc(26);Q.oc("ngClass",t.isDialog()?"modal-header":"alert mt-3"),Q.xb(3),Q.oc("ngIf",t.isDialog()),Q.xb(1),Q.oc("ngClass",t.isDialog()?"modal-body":""),Q.xb(2),Q.oc("ngClass",t.isDialog()?"col-md-12":"col-md-4"),Q.xb(15),Q.oc("ngbNavOutlet",e),Q.xb(1),Q.oc("ngClass",t.isDialog()?"col-md-12":"col-md-8"),Q.xb(1),Q.oc("dataSource",t.materialsDataSource)("useLocalSort",!0)("disablePaging",!0),Q.xb(6),Q.oc("index",!0)("hidden",!0),Q.xb(2),Q.oc("cellTemplate",i),Q.xb(2),Q.oc("cellTemplate",a),Q.xb(4),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(4),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0)}}function Ze(e,t){if(1&e&&(Q.Rb(0,"span"),Q.Rb(1,"a",80),Q.Mc(2),Q.Qb(),Q.Qb()),2&e){const e=Q.hc().row;Q.xb(1),Q.qc("href","/eg/staff/cat/item/",e.item().id(),"",Q.Ec),Q.xb(1),Q.Oc(" ",e.item().barcode()," ")}}function Je(e,t){1&e&&Q.Kc(0,Ze,3,2,"span",12),2&e&&Q.oc("ngIf",t.row.item())}function He(e,t){if(1&e&&(Q.Rb(0,"a",81),Q.Mc(1),Q.Qb()),2&e){const e=t.row;Q.qc("routerLink","/staff/catalog/record/",e.record().id(),""),Q.xb(1),Q.Oc(" ",e.record().wide_display_entry().title()," ")}}function Ye(e,t){1&e&&Q.Vb(0,qe),2&e&&(Q.Zb(t.result.label),Q.Wb(0))}function et(e,t){1&e&&Q.Nb(0)}function tt(e,t){if(1&e&&(Q.Pb(0),Q.Kc(1,et,1,0,"ng-container",82),Q.Ob()),2&e){Q.hc();const e=Q.zc(22);Q.xb(1),Q.oc("ngTemplateOutlet",e)}}Ke=$localize`:␟4d3193d1f15f6a577b0dc2b21615a1b77db22b79␟3995408688942766797:Bibliographic Record ID`,Ue=$localize`:␟0f9790eb79f6eb72b2aa42ed75472da5d8431ecd␟7612675227076281553:Relationship`,Ge=$localize`:␟db9a98729c93803ae77186ecbecdace7bce50e21␟3786241089788710399: Add Material `,qe=$localize`:␟e9c198a948844506f7163ec22241c774744e7b91␟324912261112345247: ${"\ufffd0\ufffd"}:INTERPOLATION:
`;const it=function(){return{linkedSearchField:"course_number"}},at=function(e){return{course:e}};let ct=(()=>{class e extends R.a{constructor(e,t,i,a,c,r,s,l,o,d){super(d),this.auth=e,this.course=t,this.event=i,this.idl=a,this.net=c,this.org=r,this.pcrud=s,this.route=l,this.toast=o,this.modal=d,this.materials=[],this.materialsDataSource=new u.c,this.materialsDataSource.getRows=(e,t)=>this.net.request("open-ils.courses","open-ils.courses.course_materials.retrieve.fleshed",{course:this.courseId})}ngOnInit(){this.associateBriefRecord=e=>this.net.request("open-ils.courses","open-ils.courses.attach.biblio_record",this.auth.token(),e,this.courseId,this.relationshipInput).subscribe(()=>{this.materialsGrid.reload(),this.materialAddSuccessString.current().then(e=>this.toast.success(e))}),this.associateElectronicBibRecord=()=>this.net.request("open-ils.courses","open-ils.courses.attach.electronic_resource",this.auth.token(),this.bibId,this.courseId,this.relationshipInput).subscribe(()=>{this.materialsGrid.reload(),this.materialAddSuccessString.current().then(e=>this.toast.success(e))})}isDialog(){return"dialog"===this.displayMode}editSelectedMaterials(e){const t=i=>{i&&this.showEditDialog(i).then(()=>t(e.shift()))};t(e.shift())}showEditDialog(e){return this.editDialog.mode="update",this.editDialog.recordId=e.id(),new Promise((t,i)=>{this.editDialog.open({size:"lg"}).subscribe(i=>{this.materialEditSuccessString.current().then(e=>this.toast.success(e)),this.pcrud.retrieve("acmcm",i).subscribe(t=>{t.course()!==this.courseId?this.materialsGrid.reload():e.relationship=t.relationship()}),t(i)},e=>{this.materialEditFailedString.current().then(e=>this.toast.danger(e)),i(e)})})}associateItem(e,t){if(e){const i={barcode:e.trim(),relationship:t,isModifyingCallNumber:this.isModifyingCallNumber,isModifyingCircMod:this.isModifyingCircMod,isModifyingLocation:this.isModifyingLocation,isModifyingStatus:this.isModifyingStatus,tempCircMod:this.tempCircMod,tempLocation:this.tempLocation,tempStatus:this.tempStatus,currentCourse:this.currentCourse};this.barcodeInput=null,this.pcrud.search("acp",{barcode:i.barcode},{flesh:3,flesh_fields:{acp:["call_number"]}}).subscribe(e=>{const t=this.course.associateMaterials(e,i);t.material.then(a=>{let c=(e=t.item).call_number().label();this.tempCallNumber&&(c=this.tempCallNumber),this.course.updateItem(e,this.currentCourse.owning_lib(),c,i.isModifyingCallNumber).then(t=>{this.materialsGrid.reload(),e.circ_lib()!==this.currentCourse.owning_lib()?this.materialAddDifferentLibraryString.current().then(e=>this.toast.warning(e)):this.materialAddSuccessString.current().then(e=>this.toast.success(e))})},e=>{this.materialAddFailedString.current().then(e=>this.toast.danger(e))})})}}deleteSelectedMaterials(e){const t=[];e.forEach(e=>{t.push(this.net.request("open-ils.courses","open-ils.courses.detach_material",this.auth.token(),e.id()))}),Object(v.a)(...t).subscribe(e=>{this.materialDeleteSuccessString.current().then(e=>this.toast.success(e))},e=>{this.materialDeleteFailedString.current().then(e=>this.toast.danger(e))}).add(()=>{this.materialsGrid.reload()})}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(p.a),Q.Lb(n.a),Q.Lb(S.a),Q.Lb(o.a),Q.Lb(C.b),Q.Lb(x.a),Q.Lb(d.a),Q.Lb(l.a),Q.Lb(h.a),Q.Lb(y.s))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-course-associate-material-dialog"]],viewQuery:function(e,t){var i;1&e&&(Q.Ic(G,!0),Q.Sc(q,!0),Q.Ic(W,!0),Q.Ic(j,!0),Q.Ic(Z,!0),Q.Ic(J,!0),Q.Ic(H,!0),Q.Ic(Y,!0),Q.Ic(ee,!0)),2&e&&(Q.yc(i=Q.gc())&&(t.editDialog=i.first),Q.yc(i=Q.gc())&&(t.materialsGrid=i.first),Q.yc(i=Q.gc())&&(t.materialDeleteFailedString=i.first),Q.yc(i=Q.gc())&&(t.materialDeleteSuccessString=i.first),Q.yc(i=Q.gc())&&(t.materialAddSuccessString=i.first),Q.yc(i=Q.gc())&&(t.materialAddFailedString=i.first),Q.yc(i=Q.gc())&&(t.materialEditSuccessString=i.first),Q.yc(i=Q.gc())&&(t.materialEditFailedString=i.first),Q.yc(i=Q.gc())&&(t.materialAddDifferentLibraryString=i.first))},inputs:{currentCourse:"currentCourse",courseId:"courseId",displayMode:"displayMode",barcodeInput:"barcodeInput",relationshipInput:"relationshipInput",tempCallNumber:"tempCallNumber",tempStatus:"tempStatus",tempLocation:"tempLocation",tempCircMod:"tempCircMod",isModifyingStatus:"isModifyingStatus",isModifyingCircMod:"isModifyingCircMod",isModifyingCallNumber:"isModifyingCallNumber",isModifyingLocation:"isModifyingLocation"},features:[Q.ub],decls:32,vars:6,consts:[[6,"text"],["materialDeleteFailedString",""],["materialDeleteSuccessString",""],["materialAddSuccessString",""],["materialAddFailedString",""],["materialEditSuccessString",""],["materialEditFailedString",""],["materialAddDifferentLibraryString",""],["dialogContent",""],["barcodeCellTemplate",""],["titleCellTemplate",""],["idlClassLabel",""],[4,"ngIf"],["idlClass","acmcm","hiddenFields","id,item,original_callnumber,original_status,original_location,original_circ_modifier,record,temporary_record",3,"fieldOptions","preloadLinkedValues"],["editDialog",""],[1,"modal-header","bg-info",3,"ngClass"],[1,"modal-title"],[3,"ngClass"],[1,"row"],["ngbNav","",1,"nav-tabs"],["associateNav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"mt-3",3,"ngClass"],[3,"dataSource","useLocalSort","disablePaging"],["materialsGrid",""],[3,"onClick",6,"label"],["path","id",3,"index","hidden",6,"label"],["name","barcode",3,"cellTemplate",6,"label"],["name","title","flex","3",3,"cellTemplate",6,"label"],["path","item.call_number.label",6,"label"],["path","item.call_number.prefix.label","hidden","",3,"hidden",6,"label"],["path","item.call_number.suffix.label","hidden","",3,"hidden",6,"label"],["path","item.circ_modifier",3,"hidden",6,"label"],["path","item.circ_lib.shortname",6,"label"],["path","item.location.name",3,"hidden",6,"label"],["path","item.status.name",3,"hidden",6,"label"],["path","original_circ_modifier.name",3,"hidden",6,"label"],["path","original_location.name",3,"hidden",6,"label"],["path","original_status.name",3,"hidden",6,"label"],["path","relationship",6,"label"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"row",3,"ngClass"],[1,"d-flex",3,"ngClass"],[1,"input-group"],[1,"input-group-prepend"],["for","associate-item-barcode",1,"input-group-text"],["type","text","id","associate-item-barcode",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange","click","keyup.enter"],[1,"input-group-text"],["type","text","placeholder-i18n","","placeholder","e.g. Required",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange"],[1,"row","mt-3"],[1,"col-lg-12","text-right"],[1,"btn","btn-primary",3,"disabled","click"],[1,"row","justify-content-center","mt-3"],[1,"col"],["for","associate-item-temp-call-number"],["type","text","label","associate-item-temp-call-number",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange","input"],[1,"input-group-append"],["type","checkbox","aria-label","Checkbox for setting a temporary Call Number",3,"ngModel","disabled","ngModelChange"],["idlClass","ccm","idlField","name",1,"flex-grow-1",3,"displayTemplate","disabled","asyncSupportsEmptyTermClick","onChange",6,"placeholder"],["type","checkbox","aria-label","Checkbox for setting a temporary Circulation Modifier",3,"ngModel","disabled","ngModelChange"],["idlClass","ccs","idlField","name",1,"flex-grow-1",3,"displayTemplate","disabled","asyncSupportsEmptyTermClick","onChange",6,"placeholder"],["type","checkbox","aria-label","Checkbox for setting a temporary Item Status",3,"ngModel","disabled","ngModelChange"],["permFilter","MANAGE_RESERVES",1,"flex-grow-1",3,"disabled","ngModel","ngModelChange","valueChange"],["type","checkbox","aria-label","Checkbox for setting a temporary Shelving Location",3,"ngModel","disabled","ngModelChange"],["defaultMarcForm","o",3,"xmlRecordEvent",6,"buttonLabel"],["tag","245","ind1","0","ind2","0"],["code","a"],["tag","856","ind1","4","ind2","0"],["code","u"],["code","y"],["code","9",3,"defaultValue"],["tag","990"],["code","a",6,"defaultValue"],["for","bib-id",1,"input-group-text"],["type","text","id","bib-id",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange"],["type","text",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange"],[1,"pl-1",3,"href"],[1,"pl-1",3,"routerLink"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(Q.Rb(0,"eg-string",0,1),Q.Xb(2,te),Q.Qb(),Q.Rb(3,"eg-string",0,2),Q.Xb(5,ie),Q.Qb(),Q.Rb(6,"eg-string",0,3),Q.Xb(8,ae),Q.Qb(),Q.Rb(9,"eg-string",0,4),Q.Xb(11,ce),Q.Qb(),Q.Rb(12,"eg-string",0,5),Q.Xb(14,re),Q.Qb(),Q.Rb(15,"eg-string",0,6),Q.Xb(17,se),Q.Qb(),Q.Rb(18,"eg-string",0,7),Q.Xb(20,le),Q.Qb(),Q.Kc(21,je,57,21,"ng-template",null,8,Q.Lc),Q.Kc(23,Je,1,1,"ng-template",null,9,Q.Lc),Q.Kc(25,He,2,2,"ng-template",null,10,Q.Lc),Q.Kc(27,Ye,1,1,"ng-template",null,11,Q.Lc),Q.Kc(29,tt,2,1,"ng-container",12),Q.Mb(30,"eg-fm-record-editor",13,14)),2&e&&(Q.xb(29),Q.oc("ngIf",!t.isDialog()),Q.xb(1),Q.oc("fieldOptions",Q.uc(4,at,Q.tc(3,it)))("preloadLinkedValues",!0))},directives:[g.a,M.v,f.a,M.s,y.u,y.w,y.x,y.v,y.y,b.a,I.a,F.a,_.c,_.t,_.w,_.a,T.a,w.a,B,K,U,l.f,M.C],encapsulation:2}),e})();const rt=["editDialog"],st=["usersGrid"],lt=["userDeleteFailedString"],ot=["userDeleteSuccessString"],dt=["userAddSuccessString"],nt=["userAddFailedString"],bt=["userEditSuccessString"],ut=["userEditFailedString"],ft=["text",$localize`:␟22f7ce5f98a8d3f376445fdff65eb725d5254c9b␟1245186155176370901:Removal of User failed or was not allowed`],gt=["text",$localize`:␟4fd5566d530419ad8814805162db69696784f782␟3015789044497571551:Removal of User succeeded`],ht=["text",$localize`:␟fe4cd5d0d02c78931a773831badcaf08b6b10747␟8672792405405276519:Addition of User succeeded`],mt=["text",$localize`:␟8a910ae9494b616029a0c8de1cbeea81eb9d405b␟6085085304905723537:Addition of User failed or was not allowed`],pt=["text",$localize`:␟7e7529cd0bda2ab595c77a9a52a01d358086c7ca␟7204238320712715026:Update of User succeeded`],vt=["text",$localize`:␟457dfc5f75a33b68d120d40f66c0573fe5db7a3b␟7743465987733751854:Update of User failed or was not allowed`];var Rt,Ct,St,xt;Rt=$localize`:␟43a14230b964025125d2b0a896fad2da1f8a6c29␟7882141725439330080:Course Users`,Ct=$localize`:␟4d4597ee3c58936bb098905299b6d49240d53ab4␟1191865578113917590:Patron Barcode`,St=$localize`:␟c36a66f2107e8da5371ebc9d15c2008dff567f46␟4145496584631696119:Role`,xt=$localize`:␟67c6d5f501e05878c21b6187cac1d0b3115db70e␟4915747246341874915: Add User `;const Qt=["label",$localize`:␟2e8a801b0c1e998d482eae318c975ef999fe3416␟1513762969482503855:Remove Selected`],yt=["label",$localize`:␟c525cbf6c3ff841184f81b04f0303bce644b1c51␟2886653045266158715:Edit Selected`],Mt=["label",$localize`:␟83c4d4d764d2e2725ab8e919ec16ac400e1f290a␟2128755808672960949:User ID`],It=["label",$localize`:␟c83b838d845690bcb897f775f53b5316535306dc␟6028371114637047813:First Name`],Ft=["label",$localize`:␟51a3cce2cd1bc422c9f2a1c586dc6f2e903f7c45␟7484692620446298558:Second Name`],_t=["label",$localize`:␟166b2cc65003221ff5f3ec05d5baca41e6821396␟4407559560004943843:Last Name`],Tt=["label",$localize`:␟9fa6655f367591ba82d05f77c1bf17a693a6615e␟2942230580917375982:Prefix`],wt=["label",$localize`:␟e0fbd6f34c5bfc2c0ec67d574747e050f250a1b3␟1629481515117078644:Preferred First Name`],$t=["label",$localize`:␟1989cf58ad4fcea4f5a4b97a9dcad9d3bf3f33ce␟5133174657853206961:Preferred Second Name`],Lt=["label",$localize`:␟b6eb6b46824eb36a2d04b2c7f7d9ec437543c451␟3672775925618720764:Preferred Family Name`],zt=["label",$localize`:␟c9bad53a4c04587cab50f1bc66f9111649dc501a␟6939299625151106926:Preferred Suffix`],Nt=["label",$localize`:␟ea23921000c2420f43488e431629943790e3b984␟905150179853267182:User Role`],Dt=["label",$localize`:␟51c59a15395fae50b2890c2efef255a0d4e69269␟8010588144112376284:Viewable on OPAC`],kt=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];function Xt(e,t){if(1&e){const e=Q.Sb();Q.Pb(0),Q.Rb(1,"button",41),Q.Xb(2,kt),Q.fc("click",(function(){return Q.Bc(e),Q.hc(2).close()})),Q.Rb(3,"span",42),Q.Mc(4,"\xd7"),Q.Qb(),Q.Qb(),Q.Ob()}}function At(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",11),Q.Rb(1,"h4",12),Q.Vb(2,Rt),Q.Qb(),Q.Kc(3,Xt,5,0,"ng-container",8),Q.Qb(),Q.Rb(4,"div",13),Q.Rb(5,"div",14),Q.Rb(6,"div",13),Q.Rb(7,"div",15),Q.Rb(8,"div",16),Q.Rb(9,"div",17),Q.Rb(10,"div",18),Q.Rb(11,"label",19),Q.Vb(12,Ct),Q.Qb(),Q.Qb(),Q.Rb(13,"input",20),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc().userBarcode=t}))("click",(function(t){return Q.Bc(e),t.target.select()}))("keyup.enter",(function(){Q.Bc(e);const t=Q.hc();return t.associateUser(t.userBarcode)})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(14,"div",16),Q.Rb(15,"div",17),Q.Rb(16,"div",18),Q.Rb(17,"label",21),Q.Vb(18,St),Q.Qb(),Q.Qb(),Q.Rb(19,"eg-combobox",22),Q.fc("ngModelChange",(function(t){return Q.Bc(e),Q.hc().userRoleInput=t})),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(20,"div",23),Q.Rb(21,"div",24),Q.Rb(22,"button",25),Q.fc("click",(function(){Q.Bc(e);const t=Q.hc();return t.associateUser(t.userBarcode)})),Q.Vb(23,xt),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(24,"div",26),Q.Rb(25,"eg-grid",27,28),Q.Rb(27,"eg-grid-toolbar-action",29),Q.Xb(28,Qt),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().deleteSelectedUsers(t)})),Q.Qb(),Q.Rb(29,"eg-grid-toolbar-action",29),Q.Xb(30,yt),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().editSelectedUsers(t)})),Q.Qb(),Q.Rb(31,"eg-grid-column",30),Q.Xb(32,Mt),Q.Qb(),Q.Rb(33,"eg-grid-column",31),Q.Xb(34,It),Q.Qb(),Q.Rb(35,"eg-grid-column",32),Q.Xb(36,Ft),Q.Qb(),Q.Rb(37,"eg-grid-column",33),Q.Xb(38,_t),Q.Qb(),Q.Rb(39,"eg-grid-column",34),Q.Xb(40,Tt),Q.Qb(),Q.Rb(41,"eg-grid-column",35),Q.Xb(42,wt),Q.Qb(),Q.Rb(43,"eg-grid-column",36),Q.Xb(44,$t),Q.Qb(),Q.Rb(45,"eg-grid-column",37),Q.Xb(46,Lt),Q.Qb(),Q.Rb(47,"eg-grid-column",38),Q.Xb(48,zt),Q.Qb(),Q.Rb(49,"eg-grid-column",39),Q.Xb(50,Nt),Q.Qb(),Q.Rb(51,"eg-grid-column",40),Q.Xb(52,Dt),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.hc();Q.oc("ngClass",e.isDialog()?"modal-header":"alert mt-3"),Q.xb(3),Q.oc("ngIf",e.isDialog()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"modal-body":""),Q.xb(2),Q.oc("ngClass",e.isDialog()?"col-md-12":"col-md-4"),Q.xb(1),Q.oc("ngClass",e.isDialog()?"":"mt-3"),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12"),Q.xb(5),Q.oc("ngModel",e.userBarcode)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(1),Q.oc("ngClass",e.isDialog()?"col-md-6":"col-md-12 mt-3"),Q.xb(5),Q.oc("ngModel",e.userRoleInput)("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived()),Q.xb(2),Q.oc("ngClass",e.isDialog()?"col-md-2":"col-md-6"),Q.xb(1),Q.oc("disabled",e.currentCourse&&"t"==e.currentCourse.is_archived())("disabled",!e.userBarcode),Q.xb(2),Q.oc("ngClass",e.isDialog()?"col-md-12":"col-md-8"),Q.xb(1),Q.oc("dataSource",e.usersDataSource)("useLocalSort",!0),Q.xb(6),Q.oc("index",!0)("hidden",!0),Q.xb(8),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0),Q.xb(2),Q.oc("hidden",!0)}}function Ot(e,t){1&e&&Q.Nb(0)}function Et(e,t){if(1&e&&(Q.Pb(0),Q.Kc(1,Ot,1,0,"ng-container",43),Q.Ob()),2&e){Q.hc();const e=Q.zc(19);Q.xb(1),Q.oc("ngTemplateOutlet",e)}}const Pt=function(){return{linkedSearchField:"course_number"}},Vt=function(e){return{course:e}};let Bt=(()=>{class e extends R.a{constructor(e,t,i,a,c,r){super(r),this.auth=e,this.course=t,this.net=i,this.pcrud=a,this.toast=c,this.modal=r,this.users=[],this.usersDataSource=new u.c}ngOnInit(){this.usersDataSource.getRows=(e,t)=>this.course.getUsers([this.courseId])}isDialog(){return"dialog"===this.displayMode}associateUser(e){if(e){const t={currentCourse:this.currentCourse,barcode:e.trim()};this.userRoleInput&&(t.role=this.userRoleInput.id),this.userBarcode=null,this.net.request("open-ils.actor","open-ils.actor.user.retrieve_id_by_barcode_or_username",this.auth.token(),e.trim()).subscribe(e=>{this.course.associateUsers(e,t).then(()=>this.usersGrid.reload())},e=>{this.userAddFailedString.current().then(e=>this.toast.danger(e))})}}editSelectedUsers(e){const t=i=>{i&&this.showEditDialog(i).then(()=>t(e.shift()))};t(e.shift())}showEditDialog(e){return this.editDialog.mode="update",this.editDialog.recordId=e.id(),new Promise((e,t)=>{this.editDialog.open({size:"lg"}).subscribe(t=>{this.userEditSuccessString.current().then(e=>this.toast.success(e)),this.usersGrid.reload(),e(t)},e=>{this.userEditFailedString.current().then(e=>this.toast.danger(e)),t(e)})})}deleteSelectedUsers(e){const t=e.map(e=>e.id());this.pcrud.search("acmcu",{course:this.courseId,id:t}).subscribe(e=>{e.isdeleted(!0),this.pcrud.autoApply(e).subscribe(e=>{console.debug("deleted: "+e),this.userDeleteSuccessString.current().then(e=>this.toast.success(e)),this.usersGrid.reload()},e=>{this.userDeleteFailedString.current().then(e=>this.toast.danger(e))})}).add(()=>this.usersGrid.reload())}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(p.a),Q.Lb(n.a),Q.Lb(C.b),Q.Lb(d.a),Q.Lb(h.a),Q.Lb(y.s))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-course-associate-users-dialog"]],viewQuery:function(e,t){var i;1&e&&(Q.Ic(rt,!0),Q.Sc(st,!0),Q.Ic(lt,!0),Q.Ic(ot,!0),Q.Ic(dt,!0),Q.Ic(nt,!0),Q.Ic(bt,!0),Q.Ic(ut,!0)),2&e&&(Q.yc(i=Q.gc())&&(t.editDialog=i.first),Q.yc(i=Q.gc())&&(t.usersGrid=i.first),Q.yc(i=Q.gc())&&(t.userDeleteFailedString=i.first),Q.yc(i=Q.gc())&&(t.userDeleteSuccessString=i.first),Q.yc(i=Q.gc())&&(t.userAddSuccessString=i.first),Q.yc(i=Q.gc())&&(t.userAddFailedString=i.first),Q.yc(i=Q.gc())&&(t.userEditSuccessString=i.first),Q.yc(i=Q.gc())&&(t.userEditFailedString=i.first))},inputs:{currentCourse:"currentCourse",courseId:"courseId",displayMode:"displayMode"},features:[Q.ub],decls:23,vars:6,consts:[[6,"text"],["userDeleteFailedString",""],["userDeleteSuccessString",""],["userAddSuccessString",""],["userAddFailedString",""],["userEditSuccessString",""],["userEditFailedString",""],["dialogContent",""],[4,"ngIf"],["idlClass","acmcu","hiddenFields","id,usr",3,"fieldOptions","preloadLinkedValues"],["editDialog",""],[1,"modal-header","bg-info",3,"ngClass"],[1,"modal-title"],[3,"ngClass"],[1,"row"],[1,"row",3,"ngClass"],[1,"d-flex",3,"ngClass"],[1,"input-group"],[1,"input-group-prepend"],["for","associate-user-barcode",1,"input-group-text"],["type","text","id","associate-user-barcode",1,"flex-grow-1",3,"ngModel","disabled","ngModelChange","click","keyup.enter"],["for","associate-user-role",1,"input-group-text"],["idlClass","acmr",3,"ngModel","disabled","ngModelChange"],[1,"row","mt-3"],[1,"text-right",3,"ngClass"],[1,"btn","btn-primary",3,"disabled","click"],[1,"mt-3",3,"ngClass"],[3,"dataSource","useLocalSort"],["usersGrid",""],[3,"onClick",6,"label"],["path","usr.id",3,"index","hidden",6,"label"],["path","usr.first_given_name",6,"label"],["path","usr.second_given_name",6,"label"],["path","usr.family_name",6,"label"],["path","usr.pref_prefix",3,"hidden",6,"label"],["path","usr.pref_first_given_name",3,"hidden",6,"label"],["path","usr.pref_second_given_name",3,"hidden",6,"label"],["path","usr.pref_family_name",3,"hidden",6,"label"],["path","usr.pref_suffix",3,"hidden",6,"label"],["path","usr_role.name",6,"label"],["path","usr_role.is_public","datatype","bool",6,"label"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(Q.Rb(0,"eg-string",0,1),Q.Xb(2,ft),Q.Qb(),Q.Rb(3,"eg-string",0,2),Q.Xb(5,gt),Q.Qb(),Q.Rb(6,"eg-string",0,3),Q.Xb(8,ht),Q.Qb(),Q.Rb(9,"eg-string",0,4),Q.Xb(11,mt),Q.Qb(),Q.Rb(12,"eg-string",0,5),Q.Xb(14,pt),Q.Qb(),Q.Rb(15,"eg-string",0,6),Q.Xb(17,vt),Q.Qb(),Q.Kc(18,At,53,24,"ng-template",null,7,Q.Lc),Q.Kc(20,Et,2,1,"ng-container",8),Q.Mb(21,"eg-fm-record-editor",9,10)),2&e&&(Q.xb(20),Q.oc("ngIf",!t.isDialog()),Q.xb(1),Q.oc("fieldOptions",Q.uc(4,Vt,Q.tc(3,Pt)))("preloadLinkedValues",!0))},directives:[g.a,M.v,f.a,M.s,_.c,_.t,_.w,T.a,b.a,I.a,F.a,M.C],encapsulation:2}),e})();var Kt=i("ufrD"),Ut=i("eXX1"),Gt=i("RAh1");const qt=["editDialog"],Wt=["grid"],jt=["successString"],Zt=["createString"],Jt=["createErrString"],Ht=["updateFailedString"],Yt=["deleteFailedString"],ei=["deleteSuccessString"],ti=["archiveFailedString"],ii=["archiveSuccessString"],ai=["courseMaterialDialog"],ci=["courseUserDialog"],ri=["bannerText",$localize`:␟d2f646c1e08fb765aabcb13e46188b5d5cc9bf05␟8734276510981280418:Course List`],si=["text",$localize`:␟49c525014e841f0cc716d34b3c513e7703c7c66a␟796489944428156516:${"\ufffd0\ufffd"}:INTERPOLATION: Update Succeeded`],li=["text",$localize`:␟6165e98126531bd55efd0c5b5a86074489bffa57␟8977504977580018262:${"\ufffd0\ufffd"}:INTERPOLATION: Was Created Successfully`],oi=["text",$localize`:␟ea1f0c0c9dfa660927abc42ca935e5166f0653c9␟5228266962228114787:Deletion of ${"\ufffd0\ufffd"}:INTERPOLATION: failed or was not allowed`],di=["text",$localize`:␟caed325de34dacaeaf28721b0fc20997a97a035d␟633962649010662179:Deletion of ${"\ufffd0\ufffd"}:INTERPOLATION: was successful`],ni=["text",$localize`:␟2bb2dd370048b3da345702528a6cb079834832ed␟4953692759057758718:Archival of ${"\ufffd0\ufffd"}:INTERPOLATION: failed or was not allowed`],bi=["text",$localize`:␟80289429b821977d766e33462ef58c7dc51184a9␟336141961441321773:Archival of ${"\ufffd0\ufffd"}:INTERPOLATION: succeeded`],ui=["text",$localize`:␟d7468ec5327ac34b0ebdc798a46d00c11c5d0ea2␟3267323809160629646:Limited Editing`];var fi,gi,hi;fi=$localize`:␟c91b3a9e87d27e86a751ccd9f639b8bfc81d30bf␟1136923534191040583:Course list`,gi=$localize`:␟69580f2c2dbf4edf7096820ba8c393367352d774␟2544569632476723854:Terms`,hi=$localize`:␟a4a7955f01b0f7d5fc042f02d1acc83272f3901a␟1241263153855974255:Course roles`;const mi=["label",$localize`:␟2ea0bc554f4a8344fa8b60658989b4451d365583␟3527992219294633151:Create ${"\ufffd0\ufffd"}:INTERPOLATION:`],pi=["label",$localize`:␟c525cbf6c3ff841184f81b04f0303bce644b1c51␟2886653045266158715:Edit Selected`],vi=["label",$localize`:␟96e678d5f4bfe1a041ecfcd34804efa5e100d5e8␟5167284364083276913:Delete Selected`],Ri=["label",$localize`:␟a25d43fbc74c04cb9f8aba1c7a4fd285edf81ac6␟5908280320669783723:Archive Selected`],Ci=["label",$localize`:␟45cc8ca94b5a50842a9a8ef804a5ab089a38ae5c␟8040881171107393560:ID`],Si=["label",$localize`:␟7da98bb60ebbb82b3593127f9736f46fd73c70a6␟3680913671695741022:Terms taught`],xi=["label",$localize`:␟0c2d0e97890355f5113f8101d505cf8374a577ad␟85622000756885614:Course Name`],Qi=["label",$localize`:␟a29c16f5cd7b7ad854d9e2f599c35e065678e3f6␟1869560719029910563:Course Number`],yi=["label",$localize`:␟9bc96804f32467ea86a967051de0f2a67ba23ee4␟2512891904429214309:Section Number`],Mi=["label",$localize`:␟0969bbbaa84fd72d53fc11f8ddbb6cf20d539f7c␟117067173023407185:Is Archived?`];function Ii(e,t){if(1&e){const e=Q.Sb();Q.Rb(0,"div",18),Q.Rb(1,"eg-grid",19,20),Q.Rb(3,"eg-grid-toolbar-button",21),Q.Xb(4,mi),Q.fc("onClick",(function(){return Q.Bc(e),Q.hc().createNew()})),Q.Qb(),Q.Rb(5,"eg-grid-toolbar-action",21),Q.Xb(6,pi),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().editSelected(t)})),Q.Qb(),Q.Rb(7,"eg-grid-toolbar-action",21),Q.Xb(8,vi),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().deleteSelected(t)})),Q.Qb(),Q.Rb(9,"eg-grid-toolbar-action",21),Q.Xb(10,Ri),Q.fc("onClick",(function(t){return Q.Bc(e),Q.hc().archiveSelected(t)})),Q.Qb(),Q.Rb(11,"eg-grid-column",22),Q.Xb(12,Ci),Q.Qb(),Q.Rb(13,"eg-grid-column",23),Q.Xb(14,Si),Q.Qb(),Q.Rb(15,"eg-grid-column",24),Q.Xb(16,xi),Q.Qb(),Q.Rb(17,"eg-grid-column",25),Q.Xb(18,Qi),Q.Qb(),Q.Rb(19,"eg-grid-column",26),Q.Xb(20,yi),Q.Qb(),Q.Rb(21,"eg-grid-column",27),Q.Xb(22,Mi),Q.Qb(),Q.Qb(),Q.Qb()}if(2&e){const e=Q.hc(),t=Q.zc(41);Q.xb(1),Q.pc("idlClass",e.idlClass),Q.oc("dataSource",e.grid_source)("sortable",!0),Q.xb(2),Q.Zb(e.tableName),Q.Wb(4),Q.xb(8),Q.oc("index",!0)("hidden",!0),Q.xb(2),Q.oc("cellTemplate",t)}}function Fi(e,t){if(1&e&&Q.Mb(0,"eg-admin-page",28),2&e){const e=Q.hc();Q.oc("defaultNewRecord",e.defaultTerm)}}function _i(e,t){1&e&&Q.Mb(0,"eg-admin-page",29)}var Ti;function wi(e,t){if(1&e&&(Q.Rb(0,"a",30),Q.Vb(1,Ti),Q.Qb()),2&e){const e=t.row,i=Q.hc();Q.oc("queryParams",i.acmtcmQueryParams(e))}}Ti=$localize`:␟61c78ee0a2d04dbc03f82ea62694f4661ac2a0cf␟2970265667265079729: Terms taught `;let $i=(()=>{class e{constructor(e,t,i,a,c,r,s){this.courseSvc=e,this.locale=t,this.auth=i,this.idl=a,this.pcrud=c,this.router=r,this.toast=s,this.idlClass="acmc",this.dialog_size="lg",this.tableName="Course",this.grid_source=new u.c,this.currentMaterials=[],this.search_value=""}ngOnInit(){this.getSource(),this.defaultTerm=this.idl.create("acmt"),this.defaultTerm.owning_lib(this.auth.user().ws_ou())}ngAfterViewInit(){this.grid.onRowActivate.subscribe(e=>{const t=e.id();this.navigateToCoursePage(t)})}acmtcmQueryParams(e){return{gridFilters:'{"course":'+e.id()+"}"}}getSource(){this.grid_source.getRows=(e,t)=>{const i={};return t.length?i[this.idlClass]=t[0].name+" "+t[0].dir:this.sortField&&(i[this.idlClass]=this.sortField),this.pcrud.retrieveAll(this.idlClass,{offset:e.offset,limit:e.limit,order_by:i},{fleshSelectors:!0})}}navigateToCoursePage(e){"number"==typeof e&&(e=[e]);const t=[];e.forEach(e=>{console.log(this.router.url),t.push([this.locale.currentLocaleCode()+this.router.url+"/"+e])}),1===e.length?this.router.navigate([this.router.url+"/"+e[0]]):t.forEach(e=>{window.open(e)})}createNew(){this.editDialog.mode="create",this.editDialog.recordId=null,this.editDialog.record=null,this.editDialog.open({size:this.dialog_size}).subscribe(e=>{this.createString.current().then(e=>this.toast.success(e)),this.grid.reload()},e=>{e.dismissed||this.createErrString.current().then(e=>this.toast.danger(e))})}editSelected(e){const t=[];e.forEach(e=>{t.push("function"==typeof e.id?e.id():e.id)}),this.navigateToCoursePage(t)}archiveSelected(e){this.courseSvc.disassociateMaterials(e).then(t=>{e.forEach(e=>{e.is_archived(!0)}),this.pcrud.update(e).subscribe(e=>{console.debug("archived: "+e),this.archiveSuccessString.current().then(e=>this.toast.success(e))},e=>{this.archiveFailedString.current().then(e=>this.toast.danger(e))},()=>{this.grid.reload()})})}deleteSelected(e){this.courseSvc.disassociateMaterials(e).then(t=>{e.forEach(e=>{e.isdeleted(!0)}),this.pcrud.autoApply(e).subscribe(e=>{console.debug("deleted: "+e),this.deleteSuccessString.current().then(e=>this.toast.success(e))},e=>{this.deleteFailedString.current().then(e=>this.toast.danger(e))},()=>this.grid.reload())})}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(n.a),Q.Lb(m.a),Q.Lb(p.a),Q.Lb(o.a),Q.Lb(d.a),Q.Lb(l.c),Q.Lb(h.a))},e.\u0275cmp=Q.Fb({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var i;1&e&&(Q.Ic(qt,!0),Q.Sc(Wt,!0),Q.Ic(jt,!0),Q.Sc(Zt,!0),Q.Sc(Jt,!0),Q.Sc(Ht,!0),Q.Ic(Yt,!0),Q.Ic(ei,!0),Q.Ic(ti,!0),Q.Ic(ii,!0),Q.Ic(ai,!0),Q.Ic(ci,!0)),2&e&&(Q.yc(i=Q.gc())&&(t.editDialog=i.first),Q.yc(i=Q.gc())&&(t.grid=i.first),Q.yc(i=Q.gc())&&(t.successString=i.first),Q.yc(i=Q.gc())&&(t.createString=i.first),Q.yc(i=Q.gc())&&(t.createErrString=i.first),Q.yc(i=Q.gc())&&(t.updateFailedString=i.first),Q.yc(i=Q.gc())&&(t.deleteFailedString=i.first),Q.yc(i=Q.gc())&&(t.deleteSuccessString=i.first),Q.yc(i=Q.gc())&&(t.archiveFailedString=i.first),Q.yc(i=Q.gc())&&(t.archiveSuccessString=i.first),Q.yc(i=Q.gc())&&(t.courseMaterialDialog=i.first),Q.yc(i=Q.gc())&&(t.courseUserDialog=i.first))},inputs:{sortField:"sortField",idlClass:"idlClass",dialog_size:"dialog_size",tableName:"tableName"},decls:42,vars:8,consts:[[6,"bannerText"],[6,"text"],["successString",""],["createString",""],["deleteFailedString",""],["deleteSuccessString",""],["archiveFailedString",""],["archiveSuccessString",""],["flairTooltip",""],["ngbNav","",1,"nav-tabs"],["courseListNav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],["idlClass","acmc","fieldOrder","course_number,name,owning_lib,section_number","hiddenFields","id,is_archived",3,"preloadLinkedValues"],["editDialog",""],["termMapLink",""],[1,"w-100","mt-2","mb-2"],[3,"idlClass","dataSource","sortable"],["grid",""],[3,"onClick",6,"label"],["path","id",3,"index","hidden",6,"label"],["name","terms_map",3,"cellTemplate",6,"label"],["name","name",6,"label"],["name","course_number",6,"label"],["name","section_number",6,"label"],["name","is_archived","datatype","bool",6,"label"],["idlClass","acmt",3,"defaultNewRecord"],["idlClass","acmr"],["routerLink","/staff/admin/local/asset/course_module_term_course_map",3,"queryParams"]],template:function(e,t){if(1&e&&(Q.Rb(0,"eg-staff-banner",0),Q.Xb(1,ri),Q.Qb(),Q.Rb(2,"eg-string",1,2),Q.Xb(4,si),Q.Qb(),Q.Rb(5,"eg-string",1,3),Q.Xb(7,li),Q.Qb(),Q.Rb(8,"eg-string",1,4),Q.Xb(10,oi),Q.Qb(),Q.Rb(11,"eg-string",1,5),Q.Xb(13,di),Q.Qb(),Q.Rb(14,"eg-string",1,6),Q.Xb(16,ni),Q.Qb(),Q.Rb(17,"eg-string",1,7),Q.Xb(19,bi),Q.Qb(),Q.Rb(20,"eg-string",1,8),Q.Xb(22,ui),Q.Qb(),Q.Rb(23,"ul",9,10),Q.Rb(25,"li",11),Q.Rb(26,"a",12),Q.Vb(27,fi),Q.Qb(),Q.Kc(28,Ii,23,7,"ng-template",13),Q.Qb(),Q.Rb(29,"li",11),Q.Rb(30,"a",12),Q.Vb(31,gi),Q.Qb(),Q.Kc(32,Fi,1,1,"ng-template",13),Q.Qb(),Q.Rb(33,"li",11),Q.Rb(34,"a",12),Q.Vb(35,hi),Q.Qb(),Q.Kc(36,_i,1,0,"ng-template",13),Q.Qb(),Q.Qb(),Q.Mb(37,"div",14),Q.Mb(38,"eg-fm-record-editor",15,16),Q.Kc(40,wi,2,1,"ng-template",null,17,Q.Lc)),2&e){const e=Q.zc(24);Q.xb(2),Q.Zb(t.tableName),Q.Wb(4),Q.xb(3),Q.Zb(t.tableName),Q.Wb(7),Q.xb(3),Q.Zb(t.tableName),Q.Wb(10),Q.xb(3),Q.Zb(t.tableName),Q.Wb(13),Q.xb(3),Q.Zb(t.tableName),Q.Wb(16),Q.xb(3),Q.Zb(t.tableName),Q.Wb(19),Q.xb(20),Q.oc("ngbNavOutlet",e),Q.xb(1),Q.oc("preloadLinkedValues",!0)}},directives:[Kt.a,g.a,y.u,y.w,y.x,y.v,y.y,f.a,b.a,Ut.a,I.a,F.a,Gt.a,l.f],encapsulation:2}),e})();const Li=["courseMaterialDialog"],zi=["courseUserDialog"],Ni=["archiveFailedString"],Di=["archiveSuccessString"];var ki,Xi,Ai,Oi,Ei;ki=$localize`:␟e852cf588968fbc1ef603c3da2ade2eca1d73eab␟4463214406331819827:${"\ufffd#9\ufffd"}:START_ITALIC_TEXT:keyboard_return${"\ufffd/#9\ufffd"}:CLOSE_ITALIC_TEXT:${"\ufffd#10\ufffd"}:START_TAG_SPAN:Return to Course List${"\ufffd/#10\ufffd"}:CLOSE_TAG_SPAN:`,Xi=$localize`:␟7a0365e79a11224ac02c4287dbead705ca436a00␟208181907611548740:Edit course`,Ai=$localize`:␟882cda8daed646b23e74b822975986ab78e517ac␟2830181822326331895:Course materials`,Oi=$localize`:␟7889d35576ec26129e4130c881b173ba31a80777␟4156928940071834654:Course users`,Ei=$localize`:␟b0ed9d88b67d01b287419d69ad84296f112ca8e1␟692523399154668298:Course terms`;const Pi=["text",$localize`:␟30f51b17122d94f0812fd934442f99ff0cdd8557␟2969796292531015370:Archival of Course failed or was not allowed`],Vi=["text",$localize`:␟5ee7c501f0b03a70c11302e7123b0fb02ec9a966␟1223297109356484551:Archival of Course succeeded`],Bi=["bannerText",$localize`:␟9402281b502ccdf147c040e8e2942b9a8b2d13af␟3220482369645129668: ${"\ufffd0\ufffd"}:INTERPOLATION:: ${"\ufffd1\ufffd"}:INTERPOLATION_1:`];function Ki(e,t){if(1&e&&(Q.Rb(0,"eg-staff-banner",17),Q.Xb(1,Bi),Q.Qb()),2&e){const e=Q.hc();Q.Zb(e.currentCourse.course_number())(e.currentCourse.name()),Q.Wb(1),Q.oc("bannerStyle","t"==e.currentCourse.is_archived()?"alert-secondary":null)("bannerIcon","t"==e.currentCourse.is_archived()?"lock":null)}}function Ui(e,t){1&e&&(Q.Rb(0,"i",7),Q.Mc(1,"block"),Q.Qb())}function Gi(e,t){if(1&e&&(Q.Rb(0,"div",1),Q.Mb(1,"div",18),Q.Rb(2,"div",19),Q.Mb(3,"eg-fm-record-editor",20),Q.Qb(),Q.Qb()),2&e){const e=Q.hc();Q.xb(3),Q.oc("preloadLinkedValues",!0)("record",e.currentCourse)}}function qi(e,t){if(1&e&&Q.Mb(0,"eg-course-associate-material-dialog",21),2&e){const e=Q.hc();Q.oc("courseId",e.courseId)("currentCourse",e.currentCourse)}}function Wi(e,t){if(1&e&&Q.Mb(0,"eg-course-associate-users-dialog",21),2&e){const e=Q.hc();Q.oc("courseId",e.courseId)("currentCourse",e.currentCourse)}}function ji(e,t){if(1&e&&Q.Mb(0,"eg-admin-page",22),2&e){const e=Q.hc();Q.oc("defaultNewRecord",e.defaultNewAcmtcm)("dataSource",e.termsDataSource)}}const Zi=[{path:":id",component:(()=>{class e{constructor(e,t,i,a,c){this.course=e,this.idl=t,this.pcrud=i,this.route=a,this.toast=c,this.termsDataSource=new u.c}ngOnInit(){this.courseId=+this.route.snapshot.paramMap.get("id"),this.course.getCourses([this.courseId]).then(e=>{this.currentCourse=e[0]}),this.defaultNewAcmtcm=this.idl.create("acmtcm"),this.defaultNewAcmtcm.course(this.courseId),this.termsDataSource.getRows=(e,t)=>{const i={};return t.length&&(i.acmtcm=t[0].name+" "+t[0].dir),this.pcrud.search("acmtcm",{course:this.courseId},{offset:e.offset,limit:e.limit,order_by:i},{fleshSelectors:!0})}}archiveCourse(){this.course.disassociateMaterials([this.currentCourse]).then(e=>{this.currentCourse.is_archived("t"),this.pcrud.update(this.currentCourse).subscribe(e=>{console.debug("archived: "+e),this.archiveSuccessString.current().then(e=>this.toast.success(e))},e=>{this.archiveFailedString.current().then(e=>this.toast.danger(e))})})}}return e.\u0275fac=function(t){return new(t||e)(Q.Lb(n.a),Q.Lb(o.a),Q.Lb(d.a),Q.Lb(l.a),Q.Lb(h.a))},e.\u0275cmp=Q.Fb({type:e,selectors:[["eg-course-page"]],viewQuery:function(e,t){var i;1&e&&(Q.Ic(Li,!0),Q.Ic(zi,!0),Q.Ic(Ni,!0),Q.Ic(Di,!0)),2&e&&(Q.yc(i=Q.gc())&&(t.courseMaterialDialog=i.first),Q.yc(i=Q.gc())&&(t.courseUserDialog=i.first),Q.yc(i=Q.gc())&&(t.archiveFailedString=i.first),Q.yc(i=Q.gc())&&(t.archiveSuccessString=i.first))},decls:36,vars:8,consts:[["class","mb-3",3,"bannerText","bannerStyle","bannerIcon",4,"ngIf"],[1,"row"],[1,"col","text-right"],[1,"btn","btn-danger",3,"disabled","click"],["class","material-icons align-middle",4,"ngIf"],[1,"align-middle"],["routerLink","/staff/admin/local/asset/course_list",1,"btn","btn-warning","ml-3"],[1,"material-icons","align-middle"],["ngbNav","",1,"nav-tabs"],["coursePageNav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mb-3",3,"ngbNavOutlet"],[6,"text"],["archiveFailedString",""],["archiveSuccessString",""],[1,"mb-3",3,"bannerStyle","bannerIcon",6,"bannerText"],[1,"col-lg-3","mt-3"],[1,"col-lg-6","mt-3"],["displayMode","inline","mode","update","hiddenFieldsList","id,is_archived","idlClass","acmc","fieldOrder","course_number,name,owning_lib,section_number",3,"preloadLinkedValues","record"],["displayMode","inline",3,"courseId","currentCourse"],["idlClass","acmtcm","readonlyFields","id","hideGridFields","id",3,"defaultNewRecord","dataSource"]],template:function(e,t){if(1&e&&(Q.Kc(0,Ki,2,4,"eg-staff-banner",0),Q.Rb(1,"div",1),Q.Rb(2,"div",2),Q.Rb(3,"button",3),Q.fc("click",(function(){return t.archiveCourse()})),Q.Kc(4,Ui,2,0,"i",4),Q.Rb(5,"span",5),Q.Mc(6,"Archive Course"),Q.Qb(),Q.Qb(),Q.Rb(7,"a",6),Q.bc(8,ki),Q.Mb(9,"i",7),Q.Mb(10,"span",5),Q.Yb(),Q.Qb(),Q.Qb(),Q.Qb(),Q.Rb(11,"ul",8,9),Q.Rb(13,"li",10),Q.Rb(14,"a",11),Q.Vb(15,Xi),Q.Qb(),Q.Kc(16,Gi,4,2,"ng-template",12),Q.Qb(),Q.Rb(17,"li",10),Q.Rb(18,"a",11),Q.Vb(19,Ai),Q.Qb(),Q.Kc(20,qi,1,2,"ng-template",12),Q.Qb(),Q.Rb(21,"li",10),Q.Rb(22,"a",11),Q.Vb(23,Oi),Q.Qb(),Q.Kc(24,Wi,1,2,"ng-template",12),Q.Qb(),Q.Rb(25,"li",10),Q.Rb(26,"a",11),Q.Vb(27,Ei),Q.Qb(),Q.Kc(28,ji,1,2,"ng-template",12),Q.Qb(),Q.Qb(),Q.Mb(29,"div",13),Q.Rb(30,"eg-string",14,15),Q.Xb(32,Pi),Q.Qb(),Q.Rb(33,"eg-string",14,16),Q.Xb(35,Vi),Q.Qb()),2&e){const e=Q.zc(12);Q.oc("ngIf",t.currentCourse),Q.xb(3),Q.oc("disabled",t.currentCourse&&"t"==t.currentCourse.is_archived()),Q.xb(1),Q.oc("ngIf",t.currentCourse&&"t"==t.currentCourse.is_archived()),Q.xb(9),Q.oc("ngbNavItem","edit"),Q.xb(4),Q.oc("ngbNavItem","courseMaterials"),Q.xb(4),Q.oc("ngbNavItem","courseUsers"),Q.xb(4),Q.oc("ngbNavItem","courseTerms"),Q.xb(4),Q.oc("ngbNavOutlet",e)}},directives:[M.v,l.f,y.u,y.w,y.x,y.v,y.y,g.a,Kt.a,f.a,ct,Bt,Gt.a],encapsulation:2}),e})()},{path:"",component:$i}];let Ji=(()=>{class e{}return e.\u0275mod=Q.Jb({type:e}),e.\u0275inj=Q.Ib({factory:function(t){return new(t||e)},imports:[[l.g.forChild(Zi)],l.g]}),e})();var Hi=i("lhs6"),Yi=i("r2N+");let ea=(()=>{class e{}return e.\u0275mod=Q.Jb({type:e}),e.\u0275inj=Q.Ib({factory:function(t){return new(t||e)},providers:[L.a],imports:[[r.a,Yi.a]]}),e})(),ta=(()=>{class e{}return e.\u0275mod=Q.Jb({type:e}),e.\u0275inj=Q.Ib({factory:function(t){return new(t||e)},providers:[],imports:[[r.a,s.a,Ji,Hi.a,ea,c.a]]}),e})()},r7vI:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var a=i("vkgz"),c=i("lJxs"),r=i("zx2A");class s{constructor(e,t){this.keySelector=e,this.flushes=t}call(e,t){return t.subscribe(new l(e,this.keySelector,this.flushes))}}class l extends r.b{constructor(e,t,i){super(e),this.keySelector=t,this.values=new Set,i&&this.add(Object(r.c)(i,new r.a(this)))}notifyNext(){this.values.clear()}notifyError(e){this._error(e)}_next(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)}_useKeySelector(e){let t;const{destination:i}=this;try{t=this.keySelector(e)}catch(a){return void i.error(a)}this._finalizeNext(t,e)}_finalizeNext(e,t){const{values:i}=this;i.has(e)||(i.add(e),this.destination.next(t))}}var o=i("OXuP"),d=i("8PDw"),n=i("Osig"),b=i("iA0r"),u=i("fXoL");class f{constructor(e,t,i,a,c){this.cache={indicators:{},sfcodes:{},sfvalues:{},ffvalues:{}},this.store=e,this.auth=t,this.net=i,this.pcrud=a,this.selector=c}load(){return Promise.all([this.loadTagTable(),this.getFfPosTable(),this.getFfValueTable()])}fromCache(e,t,i){const a=this.cache[e][t];return i?a?a[i]:void 0:a}toCache(e,t,i,a){const c=this.cache[e];return i?(c[t]||(c[t]={}),c[t][i]=a):c[t]=a,a}getFfPosTable(){const e="FFPosTable_"+this.selector.ffType;return this.ffPosTable?Promise.resolve(this.ffPosTable):(this.ffPosTable=this.store.getLocalItem(e),this.ffPosTable?Promise.resolve(this.ffPosTable):this.net.request("open-ils.fielder","open-ils.fielder.cmfpm.atomic",{query:{tag:{"!=":"006"},rec_type:this.selector.ffType}}).toPromise().then(t=>(this.store.setLocalItem(e,t),this.ffPosTable=t)))}getFfValueTable(){const e="FFValueTable_"+this.selector.ffType;return this.ffValueTable?Promise.resolve(this.ffValueTable):(this.ffValueTable=this.store.getLocalItem(e),this.ffValueTable?Promise.resolve(this.ffValueTable):this.net.request("open-ils.cat","open-ils.cat.biblio.fixed_field_values.by_rec_type",this.selector.ffType).toPromise().then(t=>(this.store.setLocalItem(e,t),this.ffValueTable=t)))}loadTagTable(){const e=this.selector,t=`current_tag_table_${e.marcFormat}_${e.marcRecordType}`;return this.tagMap=this.store.getLocalItem(t),this.tagMap?Promise.resolve(this.tagMap):this.fetchTagTable().then(e=>(this.store.setLocalItem(t,this.tagMap),this.tagMap))}fetchTagTable(){return this.tagMap=[],this.net.request("open-ils.cat","open-ils.cat.tag_table.all.retrieve.local",this.auth.token(),this.selector.marcFormat,this.selector.marcRecordType).pipe(Object(a.a)(e=>{this.tagMap[e.tag]=e})).toPromise()}getSubfieldCodes(e){if(!e||!this.tagMap[e])return null;this.fromCache("sfcodes",e);const t=this.tagMap[e].subfields.map(e=>({value:e.code,label:`${e.code}: ${e.description}`})).sort((e,t)=>e.label<t.label?-1:1);return this.toCache("sfcodes",e,null,t)}getSubfieldLabel(e,t){if(!e||!this.tagMap[e])return null;const i=this.tagMap[e].subfields.filter(e=>e.code===t);return i.length?i[0].description:null}getFieldTags(){return this.fieldTags||(this.fieldTags=Object.keys(this.tagMap).filter(e=>Boolean(this.tagMap[e])).map(e=>({value:e,label:`${e}: ${this.tagMap[e].name}`})).sort((e,t)=>e.label<t.label?-1:1)),this.fieldTags}getSubfieldValues(e,t){if(!e||!this.tagMap[e])return[];const i=this.fromCache("sfvalues",e,t);if(i)return i;const a=[];return this.tagMap[e].subfields.filter(e=>e.code===t&&e.hasOwnProperty("value_list")).forEach(e=>{e.value_list.forEach(e=>{let t=e.description||e.code;const i=e.code||t;i!==t&&(t=`${i}: ${t}`),a.push({value:i,label:t})})}),this.toCache("sfvalues",e,t,a)}getIndicatorValues(e,t){if(!e||!this.tagMap[e])return;const i=this.fromCache("indicators",e,t);if(i)return i;let a=this.tagMap[e][t];return a?(a=a.map(e=>({value:e.code,label:`${e.code}: ${e.description}`})).sort((e,t)=>e.label<t.label?-1:1),this.toCache("indicators",e,t,a)):void 0}getFfFieldMeta(e){return this.getFfPosTable().then(t=>t.filter(t=>t.fixed_field===e&&t.rec_type===this.selector.ffType)[0])}getFfValues(e){const t=this.fromCache("ffvalues",e);if(t)return t;let i=this.ffValueTable;return i&&i[e]?(i=i[e].filter(e=>e[0].length<=e[2]).map(e=>({value:e[0],label:`${e[0]}: ${e[1]}`})).sort((e,t)=>e.label<t.label?-1:1),this.toCache("ffvalues",e,null,i)):null}}let g=(()=>{class e{constructor(e,t,i,a){this.store=e,this.auth=t,this.net=i,this.pcrud=a,this.tagTables={}}loadTags(e){if(e.marcFormat||(e.marcFormat="marc21"),this.tagTables[e.marcRecordType])return Promise.resolve(this.tagTables[e.marcRecordType]);const t=new f(this.store,this.auth,this.net,this.pcrud,e);return this.tagTables[e.marcRecordType]=t,t.load().then(e=>t)}getControlledBibTags(){return this.controlledBibTags?Promise.resolve(this.controlledBibTags):(this.controlledBibTags=[],this.pcrud.retrieveAll("acsbf",{select:["tag"]}).pipe(Object(c.a)(e=>e.tag()),e=>e.lift(new s(void 0,void 0)),Object(c.a)(e=>this.controlledBibTags.push(e))).toPromise().then(e=>this.controlledBibTags))}}return e.\u0275fac=function(t){return new(t||e)(u.cc(o.a),u.cc(d.a),u.cc(n.b),u.cc(b.a))},e.\u0275prov=u.Hb({token:e,factory:e.\u0275fac}),e})()}}]);