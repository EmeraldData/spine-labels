(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/r9j":function(e,t,i){"use strict";i.d(t,"a",(function(){return xe}));var c=i("wBwE"),o=i("cm5s"),s=(i("DMNx"),i("r7vI")),n=i("fXoL"),a=i("FSVw");const r=["fieldLabel",$localize`:␟f61c6867295f3b53d23557021f2f4e0aa1d0b8fc␟8650499415827640724:Type`],d=["fieldLabel",$localize`:␟fc14a5e55da26c3716100389de27ad98cbd07b6b␟6035590988694933546:ELvl`],l=["fieldLabel",$localize`:␟6834fa6b43d1ecbdf147c48dd9c4d72f1484571d␟9155608366859514313:Source`],b=["fieldLabel",$localize`:␟e0f66e9853809bbdf41a088de112b2d3ae985d7a␟6691158702291469699:Audn`],f=["fieldLabel",$localize`:␟2d1098adfc2a03dbf9ad7a4807071b6b452dfbd4␟8224682376165664159:Ctrl`],u=["fieldLabel",$localize`:␟e1aec84065674ec135a8130e92920c00c3a4de11␟6343977257565555289:Lang`],h=["fieldLabel",$localize`:␟603bb75f81adba39913cb0fb1e2c5ec0c9fa2bff␟4880237343053184520:BLvl`],g=["fieldLabel",$localize`:␟010339e6584e1c44f5aa721080c96cf7bb471761␟6907807228975360219:Form`],p=["fieldLabel",$localize`:␟1796465dcb1a338fe46c314ba922d798d4964156␟239718415516962444:Conf`],m=["fieldLabel",$localize`:␟f696ad2774e559c9e7fce8d80191c77d9c6979b7␟6227439482668921969:Biog`],x=["fieldLabel",$localize`:␟46ec152b297eb6e046d269715f063a169707608a␟6974227276245579910:MRec`],R=["fieldLabel",$localize`:␟c566d64e809a31d9967add664751cfd601ecaea7␟415644605460214087:Ctry`],v=["fieldLabel",$localize`:␟44431c475a4340cc5931957165d13472840be8c5␟2724334767708737143:s_l`],y=["fieldLabel",$localize`:␟a087ac574d49e2409e84527b02578730e6c21f80␟8024696176371167855:Cont`],Q=["fieldLabel",$localize`:␟c5c87cfa26458cefd0b1cc8d8ff8535527e48560␟2146522073798919525:GPub`],C=["fieldLabel",$localize`:␟12d4cb9dd3ef6ed05edd43072b0a397e45342e04␟3688165027236963226:LitF`],L=["fieldLabel",$localize`:␟761968e59eb6ed75189dfde77c7506381c121ce2␟4359040890615067982:Indx`],T=["fieldLabel",$localize`:␟6deabc3eae9aaca7b22711e86a2bd28857b55a94␟8382405637519769348:Alph`],k=["fieldLabel",$localize`:␟66ade66df48a514c827a56c370f2db0c88907970␟8578534456929968335:Desc`],I=["fieldLabel",$localize`:␟5431d1d75c5f98ab2b6a383a3c39dbea3bf16a74␟6557681337292165568:Ills`],S=["fieldLabel",$localize`:␟f0e7f4ff874a06a1ed47152dcb5d18f2058beeaf␟698695453331923512:Fest`],M=["fieldLabel",$localize`:␟d453ed5975362abb08ba03b4e5f7507cddea184c␟6122040466295044433:DtSt`],w=["fieldLabel",$localize`:␟7a49362ea2293972ef5b80db3664470ece89777a␟7286810828516807348:Date1`],F=["fieldLabel",$localize`:␟65af5c2706e2190dae7ee6a434df008dbdc06aa7␟4927549183070692852:Date2`],$=["fieldLabel",$localize`:␟c517aaae09fbd4f614f7011c835c47c8e5a0c487␟7339531537867989268:SrTp`],O=["fieldLabel",$localize`:␟5000e683f44c3ace656d5211eddcfcd33a0a7977␟330749717970078740:Regl`],z=["fieldLabel",$localize`:␟d1ee4e322d1b5cd9a744769ecf4d70bab5392f30␟478150550009847288:Orig`],B=["fieldLabel",$localize`:␟62da942930373743793d1183b3e65eb4ddbd3b00␟1476705182802840874:Freq`],P=["fieldLabel",$localize`:␟99f1a9cd3220c9c51074060165dcb5c7ca42d9c4␟6355448092756801905:EntW`],_=["fieldLabel",$localize`:␟ecf092dca43f017b56dc8e1c913a69a6ad17a53d␟1287307276046721113:TrAr`],N=["fieldLabel",$localize`:␟4a6349fab642dd11764bc101dd27c27d7cdea3d2␟339729126805226016:Part`],X=["fieldLabel",$localize`:␟b99dfe3fdcdf9d76db7f5bb63bdaff4be73b8e6f␟5504294718997045193:LTxt`],D=["fieldLabel",$localize`:␟6a1057f8ecc14a2d92279f4f8e973d2acfa2be33␟954985046009039348:FMus`],A=["fieldLabel",$localize`:␟595883e436123ffaef0ca71320cb70d2ece119d1␟1302180592649933802:AccM`],V=["fieldLabel",$localize`:␟140cc3249b56770d8aadcc65aaf3d3b4d44e073f␟3813629674792983727:Comp`],E=["fieldLabel",$localize`:␟c785326c7b609b1a417c4a875fd96145948d1b70␟6863487164629845459:SpFm`],K=["fieldLabel",$localize`:␟4c99d80c68143f7bd9c61896951d698408b14c42␟4124581389584669368:Relf`],q=["fieldLabel",$localize`:␟845040d4bf06327ad6989614839d3aa10434ef85␟3078700395699921507:Proj`],j=["fieldLabel",$localize`:␟1dac828c0a6ea2cf1900c6723819d737eb31c23f␟5907508363616911677:CrTp`],U=["fieldLabel",$localize`:␟670a32892e35dd0a4c3b51ca7ab0440d484b4668␟82423361031588852:TMat`],H=["fieldLabel",$localize`:␟b24f1cd32cbc1ec9537af28c4fe1b8204097714b␟8497528947328199741:Time`],W=["fieldLabel",$localize`:␟4e04bcbdb7cbe6bc30c79af31dd999aa43025469␟1061540398514258404:Tech`],Z=["fieldLabel",$localize`:␟48139a8f408fb79f24e82673e89e23c2ac314f23␟8455204924704616723:File`],G=["fieldLabel",$localize`:␟46c8df6a684c9fa8c13c150b2093e6312654f691␟555989664405583582:Type_tbmfhd`],Y=["fieldLabel",$localize`:␟83cd3a7200a5dc69830c6426afd8aedb32470fe8␟1533430040515928324:ELvl_tbmfhd`],J=["fieldLabel",$localize`:␟efb0549acf72af2d1f722f0bd19787e6657c4b49␟4157576126145593905:Item_tbmfhd`],ee=["fieldLabel",$localize`:␟b9c9e0267fcfe580736593450cda5f93f8e80af0␟1894513264551556610:GeoDiv`],te=["fieldLabel",$localize`:␟6715b30341a5ee1d9a880a5eaa79927d416882a1␟6177316864864450040:Roman`],ie=["fieldLabel",$localize`:␟6181efa0ecca1ea54729aa6e3c02982f5907a4cc␟4617750124863202178:CatLang`],ce=["fieldLabel",$localize`:␟1142d1e241e766713838ec7055c1b912ef9a0d7f␟6599752784987327249:Kind`],oe=["fieldLabel",$localize`:␟2489eefea00931942b91f4a1ae109514b591e2e1␟4645345687322304891:Rules`],se=["fieldLabel",$localize`:␟0b7ec2a8ffd3fb93112bbb0246fb17b5f8d7298a␟5354425113256040759:Subj`],ne=["fieldLabel",$localize`:␟f2602159bf76864fa86ee0cd8e1ce2370f27c88b␟7707176955005055131:Series`],ae=["fieldLabel",$localize`:␟c49f4dddafac5d2ef884ab5d52f52f4928815ea2␟2366574179529910605:SerNum`],re=["fieldLabel",$localize`:␟460b5615b79204d5ac304cc4bac04112afdebada␟2913113750511474740:NameUse`],de=["fieldLabel",$localize`:␟13cb68369ba77e2e33e0e7603f0bf1962f1dfe2a␟6065000109545097136:SubjUse`],le=["fieldLabel",$localize`:␟5055ecf0fc415d9737cf2fc5173b8216d6f16de4␟3889783784646314446:SerUse`],be=["fieldLabel",$localize`:␟1c284d3b15819e9610cf7595275cb9952492a006␟6195542057697444627:TypeSubd`],fe=["fieldLabel",$localize`:␟b67135ad6b9d981d8ab24d854cf7b3cabfef9baa␟3531977011957040242:GovtAgn`],ue=["fieldLabel",$localize`:␟b4481505461d2fcba4d28bc7841ee5e21d6acb68␟3623346507845353635:RefStatus`],he=["fieldLabel",$localize`:␟cd7b8a5ffecf2a320ac81d4caf7278d7281fd756␟2206092107169689788:UpdStatus`],ge=["fieldLabel",$localize`:␟cff1428d10d59d14e45edec3c735a27b5482db59␟8953033926734869941:Name`],pe=["fieldLabel",$localize`:␟81b97b8ea996ad1e4f9fca8415021850214884b1␟5611592591303869712:Status`],me=["fieldLabel",$localize`:␟d933c5b1106318dfbe5b6ac839dc03e3caefc4c4␟85990745567234286:ModRec`];let xe=(()=>{class e{constructor(e,t,i){this.idl=e,this.org=t,this.tagTable=i}get record(){return this.context.record}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(c.a),n.Lb(o.a),n.Lb(s.a))},e.\u0275cmp=n.Fb({type:e,selectors:[["eg-fixed-fields-editor"]],inputs:{context:"context"},decls:204,vars:64,consts:[[1,"row","p-0"],[1,"col-lg-2"],["fieldCode","Type",3,"context",6,"fieldLabel"],["fieldCode","ELvl",3,"context",6,"fieldLabel"],["fieldCode","Source",3,"context",6,"fieldLabel"],["fieldCode","Audn",3,"context",6,"fieldLabel"],["fieldCode","Ctrl",3,"context",6,"fieldLabel"],["fieldCode","Lang",3,"context",6,"fieldLabel"],["fieldCode","BLvl",3,"context",6,"fieldLabel"],["fieldCode","Form",3,"context",6,"fieldLabel"],["fieldCode","Conf",3,"context",6,"fieldLabel"],["fieldCode","Biog",3,"context",6,"fieldLabel"],["fieldCode","MRec",3,"context",6,"fieldLabel"],["fieldCode","Ctry",3,"context",6,"fieldLabel"],["fieldCode","s_l",3,"context",6,"fieldLabel"],["fieldCode","Cont",3,"context",6,"fieldLabel"],["fieldCode","GPub",3,"context",6,"fieldLabel"],["fieldCode","LitF",3,"context",6,"fieldLabel"],["fieldCode","Indx",3,"context",6,"fieldLabel"],["fieldCode","Alph",3,"context",6,"fieldLabel"],["fieldCode","Desc",3,"context",6,"fieldLabel"],["fieldCode","Ills",3,"context",6,"fieldLabel"],["fieldCode","Fest",3,"context",6,"fieldLabel"],["fieldCode","DtSt",3,"context",6,"fieldLabel"],["fieldCode","Date1",3,"context",6,"fieldLabel"],["fieldCode","Date2",3,"context",6,"fieldLabel"],["fieldCode","SrTp",3,"context",6,"fieldLabel"],["fieldCode","Regl",3,"context",6,"fieldLabel"],["fieldCode","Orig",3,"context",6,"fieldLabel"],["fieldCode","Freq",3,"context",6,"fieldLabel"],["fieldCode","EntW",3,"context",6,"fieldLabel"],["fieldCode","TrAr",3,"context",6,"fieldLabel"],["fieldCode","Part",3,"context",6,"fieldLabel"],["fieldCode","LTxt",3,"context",6,"fieldLabel"],["fieldCode","FMus",3,"context",6,"fieldLabel"],["fieldCode","AccM",3,"context",6,"fieldLabel"],["fieldCode","Comp",3,"context",6,"fieldLabel"],["fieldCode","SpFm",3,"context",6,"fieldLabel"],["fieldCode","Relf",3,"context",6,"fieldLabel"],["fieldCode","Proj",3,"context",6,"fieldLabel"],["fieldCode","CrTp",3,"context",6,"fieldLabel"],["fieldCode","TMat",3,"context",6,"fieldLabel"],["fieldCode","Time",3,"context",6,"fieldLabel"],["fieldCode","Tech",3,"context",6,"fieldLabel"],["fieldCode","File",3,"context",6,"fieldLabel"],["fieldCode","Type_tbmfhd",3,"context",6,"fieldLabel"],["fieldCode","ELvl_tbmfhd",3,"context",6,"fieldLabel"],["fieldCode","Item_tbmfhd",3,"context",6,"fieldLabel"],["fieldCode","GeoDiv",3,"context",6,"fieldLabel"],["fieldCode","Roman",3,"context",6,"fieldLabel"],["fieldCode","CatLang",3,"context",6,"fieldLabel"],["fieldCode","Kind",3,"context",6,"fieldLabel"],["fieldCode","Rules",3,"context",6,"fieldLabel"],["fieldCode","Subj",3,"context",6,"fieldLabel"],["fieldCode","Series",3,"context",6,"fieldLabel"],["fieldCode","SerNum",3,"context",6,"fieldLabel"],["fieldCode","NameUse",3,"context",6,"fieldLabel"],["fieldCode","SubjUse",3,"context",6,"fieldLabel"],["fieldCode","SerUse",3,"context",6,"fieldLabel"],["fieldCode","TypeSubd",3,"context",6,"fieldLabel"],["fieldCode","GovtAgn",3,"context",6,"fieldLabel"],["fieldCode","RefStatus",3,"context",6,"fieldLabel"],["fieldCode","UpdStatus",3,"context",6,"fieldLabel"],["fieldCode","Name",3,"context",6,"fieldLabel"],["fieldCode","Status",3,"context",6,"fieldLabel"],["fieldCode","ModRec",3,"context",6,"fieldLabel"]],template:function(e,t){1&e&&(n.Rb(0,"div",0),n.Rb(1,"div",1),n.Rb(2,"eg-fixed-field",2),n.Xb(3,r),n.Qb(),n.Qb(),n.Rb(4,"div",1),n.Rb(5,"eg-fixed-field",3),n.Xb(6,d),n.Qb(),n.Qb(),n.Rb(7,"div",1),n.Rb(8,"eg-fixed-field",4),n.Xb(9,l),n.Qb(),n.Qb(),n.Rb(10,"div",1),n.Rb(11,"eg-fixed-field",5),n.Xb(12,b),n.Qb(),n.Qb(),n.Rb(13,"div",1),n.Rb(14,"eg-fixed-field",6),n.Xb(15,f),n.Qb(),n.Qb(),n.Rb(16,"div",1),n.Rb(17,"eg-fixed-field",7),n.Xb(18,u),n.Qb(),n.Qb(),n.Qb(),n.Rb(19,"div",0),n.Rb(20,"div",1),n.Rb(21,"eg-fixed-field",8),n.Xb(22,h),n.Qb(),n.Qb(),n.Rb(23,"div",1),n.Rb(24,"eg-fixed-field",9),n.Xb(25,g),n.Qb(),n.Qb(),n.Rb(26,"div",1),n.Rb(27,"eg-fixed-field",10),n.Xb(28,p),n.Qb(),n.Qb(),n.Rb(29,"div",1),n.Rb(30,"eg-fixed-field",11),n.Xb(31,m),n.Qb(),n.Qb(),n.Rb(32,"div",1),n.Rb(33,"eg-fixed-field",12),n.Xb(34,x),n.Qb(),n.Qb(),n.Rb(35,"div",1),n.Rb(36,"eg-fixed-field",13),n.Xb(37,R),n.Qb(),n.Qb(),n.Qb(),n.Rb(38,"div",0),n.Rb(39,"div",1),n.Rb(40,"eg-fixed-field",14),n.Xb(41,v),n.Qb(),n.Qb(),n.Rb(42,"div",1),n.Rb(43,"eg-fixed-field",15),n.Xb(44,y),n.Qb(),n.Qb(),n.Rb(45,"div",1),n.Rb(46,"eg-fixed-field",16),n.Xb(47,Q),n.Qb(),n.Qb(),n.Rb(48,"div",1),n.Rb(49,"eg-fixed-field",17),n.Xb(50,C),n.Qb(),n.Qb(),n.Rb(51,"div",1),n.Rb(52,"eg-fixed-field",18),n.Xb(53,L),n.Qb(),n.Qb(),n.Rb(54,"div",1),n.Rb(55,"eg-fixed-field",19),n.Xb(56,T),n.Qb(),n.Qb(),n.Qb(),n.Rb(57,"div",0),n.Rb(58,"div",1),n.Rb(59,"eg-fixed-field",20),n.Xb(60,k),n.Qb(),n.Qb(),n.Rb(61,"div",1),n.Rb(62,"eg-fixed-field",21),n.Xb(63,I),n.Qb(),n.Qb(),n.Rb(64,"div",1),n.Rb(65,"eg-fixed-field",22),n.Xb(66,S),n.Qb(),n.Qb(),n.Rb(67,"div",1),n.Rb(68,"eg-fixed-field",23),n.Xb(69,M),n.Qb(),n.Qb(),n.Rb(70,"div",1),n.Rb(71,"eg-fixed-field",24),n.Xb(72,w),n.Qb(),n.Qb(),n.Rb(73,"div",1),n.Rb(74,"eg-fixed-field",25),n.Xb(75,F),n.Qb(),n.Qb(),n.Qb(),n.Rb(76,"div",0),n.Rb(77,"div",1),n.Rb(78,"eg-fixed-field",26),n.Xb(79,$),n.Qb(),n.Qb(),n.Rb(80,"div",1),n.Rb(81,"eg-fixed-field",27),n.Xb(82,O),n.Qb(),n.Qb(),n.Rb(83,"div",1),n.Rb(84,"eg-fixed-field",28),n.Xb(85,z),n.Qb(),n.Qb(),n.Rb(86,"div",1),n.Rb(87,"eg-fixed-field",29),n.Xb(88,B),n.Qb(),n.Qb(),n.Rb(89,"div",1),n.Rb(90,"eg-fixed-field",30),n.Xb(91,P),n.Qb(),n.Qb(),n.Qb(),n.Rb(92,"div",0),n.Rb(93,"div",1),n.Rb(94,"eg-fixed-field",31),n.Xb(95,_),n.Qb(),n.Qb(),n.Rb(96,"div",1),n.Rb(97,"eg-fixed-field",32),n.Xb(98,N),n.Qb(),n.Qb(),n.Rb(99,"div",1),n.Rb(100,"eg-fixed-field",33),n.Xb(101,X),n.Qb(),n.Qb(),n.Rb(102,"div",1),n.Rb(103,"eg-fixed-field",34),n.Xb(104,D),n.Qb(),n.Qb(),n.Rb(105,"div",1),n.Rb(106,"eg-fixed-field",35),n.Xb(107,A),n.Qb(),n.Qb(),n.Rb(108,"div",1),n.Rb(109,"eg-fixed-field",36),n.Xb(110,V),n.Qb(),n.Qb(),n.Qb(),n.Rb(111,"div",0),n.Rb(112,"div",1),n.Rb(113,"eg-fixed-field",37),n.Xb(114,E),n.Qb(),n.Qb(),n.Rb(115,"div",1),n.Rb(116,"eg-fixed-field",38),n.Xb(117,K),n.Qb(),n.Qb(),n.Rb(118,"div",1),n.Rb(119,"eg-fixed-field",39),n.Xb(120,q),n.Qb(),n.Qb(),n.Rb(121,"div",1),n.Rb(122,"eg-fixed-field",40),n.Xb(123,j),n.Qb(),n.Qb(),n.Qb(),n.Rb(124,"div",0),n.Rb(125,"div",1),n.Rb(126,"eg-fixed-field",41),n.Xb(127,U),n.Qb(),n.Qb(),n.Rb(128,"div",1),n.Rb(129,"eg-fixed-field",42),n.Xb(130,H),n.Qb(),n.Qb(),n.Rb(131,"div",1),n.Rb(132,"eg-fixed-field",43),n.Xb(133,W),n.Qb(),n.Qb(),n.Rb(134,"div",1),n.Rb(135,"eg-fixed-field",44),n.Xb(136,Z),n.Qb(),n.Qb(),n.Qb(),n.Rb(137,"div",0),n.Rb(138,"div",1),n.Rb(139,"eg-fixed-field",45),n.Xb(140,G),n.Qb(),n.Qb(),n.Rb(141,"div",1),n.Rb(142,"eg-fixed-field",46),n.Xb(143,Y),n.Qb(),n.Qb(),n.Rb(144,"div",1),n.Rb(145,"eg-fixed-field",47),n.Xb(146,J),n.Qb(),n.Qb(),n.Rb(147,"div",1),n.Rb(148,"eg-fixed-field",48),n.Xb(149,ee),n.Qb(),n.Qb(),n.Rb(150,"div",1),n.Rb(151,"eg-fixed-field",49),n.Xb(152,te),n.Qb(),n.Qb(),n.Rb(153,"div",1),n.Rb(154,"eg-fixed-field",50),n.Xb(155,ie),n.Qb(),n.Qb(),n.Qb(),n.Rb(156,"div",0),n.Rb(157,"div",1),n.Rb(158,"eg-fixed-field",51),n.Xb(159,ce),n.Qb(),n.Qb(),n.Rb(160,"div",1),n.Rb(161,"eg-fixed-field",52),n.Xb(162,oe),n.Qb(),n.Qb(),n.Rb(163,"div",1),n.Rb(164,"eg-fixed-field",53),n.Xb(165,se),n.Qb(),n.Qb(),n.Rb(166,"div",1),n.Rb(167,"eg-fixed-field",54),n.Xb(168,ne),n.Qb(),n.Qb(),n.Rb(169,"div",1),n.Rb(170,"eg-fixed-field",55),n.Xb(171,ae),n.Qb(),n.Qb(),n.Rb(172,"div",1),n.Rb(173,"eg-fixed-field",56),n.Xb(174,re),n.Qb(),n.Qb(),n.Qb(),n.Rb(175,"div",0),n.Rb(176,"div",1),n.Rb(177,"eg-fixed-field",57),n.Xb(178,de),n.Qb(),n.Qb(),n.Rb(179,"div",1),n.Rb(180,"eg-fixed-field",58),n.Xb(181,le),n.Qb(),n.Qb(),n.Rb(182,"div",1),n.Rb(183,"eg-fixed-field",59),n.Xb(184,be),n.Qb(),n.Qb(),n.Rb(185,"div",1),n.Rb(186,"eg-fixed-field",60),n.Xb(187,fe),n.Qb(),n.Qb(),n.Rb(188,"div",1),n.Rb(189,"eg-fixed-field",61),n.Xb(190,ue),n.Qb(),n.Qb(),n.Rb(191,"div",1),n.Rb(192,"eg-fixed-field",62),n.Xb(193,he),n.Qb(),n.Qb(),n.Qb(),n.Rb(194,"div",0),n.Rb(195,"div",1),n.Rb(196,"eg-fixed-field",63),n.Xb(197,ge),n.Qb(),n.Qb(),n.Rb(198,"div",1),n.Rb(199,"eg-fixed-field",64),n.Xb(200,pe),n.Qb(),n.Qb(),n.Rb(201,"div",1),n.Rb(202,"eg-fixed-field",65),n.Xb(203,me),n.Qb(),n.Qb(),n.Qb()),2&e&&(n.xb(2),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(4),n.oc("context",t.context),n.xb(3),n.oc("context",t.context),n.xb(3),n.oc("context",t.context))},directives:[a.a],encapsulation:2}),e})()},"1kwX":function(e,t,i){"use strict";i.d(t,"a",(function(){return oe}));var c=i("fXoL"),o=i("wBwE"),s=i("EQDH"),n=i("Osig"),a=i("8PDw"),r=i("cm5s"),d=i("iA0r"),l=i("YRS1"),b=i("OsfI"),f=i("tNQm"),u=i("NF/O"),h=i("9rfo"),g=i("36iw"),p=i("DMNx"),m=i("WC/f"),x=i("/xpB"),R=i("ofXK"),v=i("3Pt+"),y=i("TxlL"),Q=i("1kSV"),C=i("D6jH"),L=i("FO7Y");const T=["sourceSelector"],k=["confirmDelete"],I=["confirmUndelete"],S=["cannotDelete"],M=["successMsg"],w=["failMsg"],F=["dialogTitle",$localize`:␟a6ecf76f074e2098ee024b6c2586a0475a2d6dd3␟6208564441860154239:Confirm Delete`,"dialogBody",$localize`:␟b82ea2b0878056551dc4baa207d52ccbdb0208f7␟8801228482518898905:Delete Record ID ${"\ufffd0\ufffd"}:INTERPOLATION:?`],$=["dialogTitle",$localize`:␟24c272e62045f41c05d5c741a2b460ee0742809a␟4012154479171438598:Confirm Undelete`,"dialogBody",$localize`:␟debe3673d601e8fc2adf2005ceba0488fe0d2ca5␟7869798830152414955:Undelete Record ID ${"\ufffd0\ufffd"}:INTERPOLATION:?`],O=["dialogBody",$localize`:␟a3eae0330f66dff603905b6d40d8698bb375c2ed␟5941742049342332956:Records with holdings attached cannot be deleted.`],z=["text",$localize`:␟d633521720f8a2e8f7a0e2271a49888c513eeaa8␟7781653605008841585:Record successfully updated`],B=["text",$localize`:␟1f22ab0919191d2575c26cfe6ebafe44d70f2a2e␟544590199973961097:Record failed to update`];var P,_,N;function X(e,t){if(1&e){const e=c.Sb();c.Pb(0),c.Rb(1,"div",17),c.Rb(2,"input",18),c.fc("ngModelChange",(function(t){return c.Bc(e),c.hc().showFastAdd=t})),c.Qb(),c.Rb(3,"label",19),c.Mc(4," Add Item "),c.Qb(),c.Qb(),c.Ob()}if(2&e){const e=c.hc();c.xb(2),c.oc("ngModel",e.showFastAdd)}}P=$localize`:␟611bee6aed4d0cb349543c29f3e480c0f0a82e1e␟7958799520390607981: Record Type ${"\ufffd0\ufffd"}:INTERPOLATION: `,_=$localize`:␟afa960379d26eb20fd22e6e10537c1c5ec74c5d1␟4319441956121197474:Save Changes`,N=$localize`:␟afa960379d26eb20fd22e6e10537c1c5ec74c5d1␟4319441956121197474:Save Changes`;const D=["placeholder",$localize`:␟115508ef944d0bdb066e511220b8679efd7fb4b2␟6100860029551607069:Call Number`],A=["placeholder",$localize`:␟d81e7544c57020f4d7355d9aa1a6aaf8f6e37962␟3011112932753861347:Barcode`];function V(e,t){if(1&e){const e=c.Sb();c.Pb(0),c.Rb(1,"div",20),c.Rb(2,"input",21),c.Xb(3,D),c.fc("ngModelChange",(function(t){return c.Bc(e),c.hc().fastItemLabel=t})),c.Qb(),c.Rb(4,"input",21),c.Xb(5,A),c.fc("ngModelChange",(function(t){return c.Bc(e),c.hc().fastItemBarcode=t})),c.Qb(),c.Qb(),c.Ob()}if(2&e){const e=c.hc();c.xb(2),c.oc("ngModel",e.fastItemLabel),c.xb(2),c.oc("ngModel",e.fastItemBarcode)}}const E=["placeholder",$localize`:␟450020c01489ab9114b8681a9a05ee07d9e9f745␟4035921914753925376:Select a Source...`];function K(e,t){if(1&e&&(c.Pb(0),c.Rb(1,"div",11),c.Rb(2,"eg-combobox",22,23),c.Xb(4,E),c.Qb(),c.Qb(),c.Ob()),2&e){const e=c.hc();c.xb(2),c.oc("entries",e.sources)}}var q,j,U,H;function W(e,t){if(1&e){const e=c.Sb();c.Rb(0,"button",26),c.fc("click",(function(){return c.Bc(e),c.hc(2).deleteRecord()})),c.Vb(1,q),c.Qb()}if(2&e){const e=c.hc(2);c.oc("disabled",e.inPlaceMode)}}function Z(e,t){if(1&e){const e=c.Sb();c.Rb(0,"button",27),c.fc("click",(function(){return c.Bc(e),c.hc(2).undeleteRecord()})),c.Vb(1,j),c.Qb()}if(2&e){const e=c.hc(2);c.oc("disabled",e.inPlaceMode)}}function G(e,t){if(1&e&&(c.Pb(0),c.Kc(1,W,2,1,"button",24),c.Kc(2,Z,2,1,"button",25),c.Ob()),2&e){const e=c.hc();c.xb(1),c.oc("ngIf",!e.record.deleted),c.xb(1),c.oc("ngIf",e.record.deleted)}}function Y(e,t){1&e&&(c.Pb(0),c.Rb(1,"div",28),c.Rb(2,"div",29),c.Mb(3,"eg-progress-inline"),c.Qb(),c.Qb(),c.Ob())}function J(e,t){if(1&e&&(c.Pb(0),c.Mb(1,"eg-marc-rich-editor",39),c.Ob()),2&e){const e=c.hc(3);c.xb(1),c.oc("context",e.context)}}function ee(e,t){if(1&e&&c.Kc(0,J,2,1,"ng-container",9),2&e){const e=c.hc(2);c.oc("ngIf",e.context&&e.context.record)}}function te(e,t){if(1&e&&(c.Pb(0),c.Mb(1,"eg-marc-flat-editor",39),c.Ob()),2&e){const e=c.hc(3);c.xb(1),c.oc("context",e.context)}}function ie(e,t){if(1&e&&c.Kc(0,te,2,1,"ng-container",9),2&e){const e=c.hc(2);c.oc("ngIf",e.context&&e.context.record)}}function ce(e,t){if(1&e){const e=c.Sb();c.Rb(0,"div",30),c.Rb(1,"div",31),c.Rb(2,"ul",32,33),c.fc("navChange",(function(t){return c.Bc(e),c.hc().tabChange(t)})),c.Rb(4,"li",34),c.Rb(5,"a",35),c.Vb(6,U),c.Qb(),c.Kc(7,ee,1,1,"ng-template",36),c.Qb(),c.Rb(8,"li",37),c.Rb(9,"a",35),c.Vb(10,H),c.Qb(),c.Kc(11,ie,1,1,"ng-template",36),c.Qb(),c.Qb(),c.Mb(12,"div",38),c.Qb(),c.Qb()}if(2&e){const e=c.zc(3),t=c.hc();c.xb(2),c.oc("activeId",t.editorTab),c.xb(2),c.oc("ngbNavItem","rich"),c.xb(8),c.oc("ngbNavOutlet",e)}}q=$localize`:␟ced2f0b2be593b3b23f73d29a257f0f7bb45a682␟3948827708061298383:Delete Record`,j=$localize`:␟591f67b2fbe18d757fc733d053381255e001ac83␟5912230745040135544:Undelete Record`,U=$localize`:␟a2e5cc98ed59ae5ba98081ba0965a2a4d19d4167␟5857384757296482678:Enhanced MARC Editor`,H=$localize`:␟8954c8e865166cdd92a52f7330f2d7c722bea6f0␟3141491731819537551:Flat Text Editor`;let oe=(()=>{class e{constructor(e,t,i,o,s,n,a,r,d){this.evt=e,this.idl=t,this.net=i,this.auth=o,this.org=s,this.pcrud=n,this.toast=a,this.holdings=r,this.store=d,this.recordType="biblio",this.initCalled=!1,this.sources=[],this.recordSaved=new c.n,this.context=new p.a,this.recordSaved.subscribe(e=>this.dataSaving=!1)}set recordId(e){this.record&&this.record.id===e||(this.initCalled?(this._pendingRecordId=null,this.fromId(e)):this._pendingRecordId=e)}get recordId(){return this.record?this.record.id:this._pendingRecordId}set recordXml(e){e&&this.fromXml(e)}get record(){return this.context.record}ngOnInit(){this.initCalled=!0,this.context.recordType=this.recordType,this.store.getItem("cat.marcedit.flateditor").then(e=>this.editorTab=e?"flat":"rich"),!this.record&&this.recordId&&this.fromId(this.recordId),"biblio"===this.recordType&&this.pcrud.retrieveAll("cbs").subscribe(e=>this.sources.push({id:+e.id(),label:e.source()}),e=>{},()=>{this.sources=this.sources.sort((e,t)=>e.label.toLowerCase()<t.label.toLowerCase()?-1:1),this.recordSource&&this.sourceSelector.applyEntryId(this.recordSource)})}changesPending(){return this.context.changesPending}clearPendingChanges(){this.context.changesPending=!1}tabChange(e){this.context.resetUndos(),"flat"===e.nextId?this.store.setItem("cat.marcedit.flateditor",!0):this.store.removeItem("cat.marcedit.flateditor")}saveRecord(){const e=this.record.toXml();this.dataSaving=!0,this.context.changesPending=!1,this.context.resetUndos();let t=null,i=null;this.sourceSelector&&this.sourceSelector.selected&&(t=this.sourceSelector.selected.label,i=this.sourceSelector.selected.id);const c={marcXml:e,bibSource:i,recordId:this.recordId};if(this.inPlaceMode)return this.recordSaved.emit(c),Promise.resolve();let o;return o=this.record.id?this.modifyRecord(e,t,i):this.createRecord(e,t),o.then(e=>e?(this.successMsg.current().then(e=>this.toast.success(e)),c.marcXml=e,c.recordId=this.recordId,this.recordSaved.emit(c),this.fastAdd(),e):null)}modifyRecord(e,t,i){return this.net.request("open-ils.cat","biblio"===this.recordType?"open-ils.cat.biblio.record.xml.update":"open-ils.cat.authority.record.overlay",this.auth.token(),this.record.id,e,t).toPromise().then(t=>{const i=this.evt.parse(t);return i?(console.error(i),this.failMsg.current().then(e=>this.toast.warning(e)),this.dataSaving=!1,null):"object"==typeof t?t.marc():e})}createRecord(e,t){return this.net.request("open-ils.cat","biblio"===this.recordType?"open-ils.cat.biblio.record.xml.create":"open-ils.cat.authority.record.import",this.auth.token(),e,t).toPromise().then(e=>{const t=this.evt.parse(e);return t?(console.error(t),this.failMsg.current().then(e=>this.toast.warning(e)),this.dataSaving=!1,null):(this.record.id=e.id(),e.marc())})}fromId(e){const t="authority"===this.recordType?"are":"bre";return this.pcrud.retrieve(t,e).toPromise().then(i=>{this.context.record=new u.a(i.marc()),this.record.id=e,this.record.deleted="t"===i.deleted(),"bre"===t&&i.source()&&this.sourceSelector.applyEntryId(+i.source())})}fromXml(e){this.context.record=new u.a(e),this.record.id=null}deleteRecord(){return this.confirmDelete.open().toPromise().then(e=>{if(!e)return;let t;return t="authority"===this.recordType?this.deleteAuthorityRecord():this.deleteBibRecord(),t.then(e=>{if(e)return this.fromId(this.record.id).then(e=>{this.recordSaved.emit({marcXml:this.record.toXml(),recordId:this.recordId})})})})}deleteAuthorityRecord(){return this.pcrud.retrieve("are",this.record.id).toPromise().then(e=>this.pcrud.remove(e).toPromise()).then(e=>null!==e)}deleteBibRecord(){return this.net.request("open-ils.cat","open-ils.cat.biblio.record_entry.delete",this.auth.token(),this.record.id).toPromise().then(e=>{const t=this.evt.parse(e);return!t||("RECORD_NOT_EMPTY"===t.textcode?this.cannotDelete.open().toPromise().then(e=>!1):(console.error(t),alert(t),!1))})}undeleteRecord(){return this.confirmUndelete.open().toPromise().then(e=>{if(!e)return;let t;return t="authority"===this.recordType?this.undeleteAuthorityRecord():this.undeleteBibRecord(),t.then(e=>{if(e)return this.fromId(this.record.id).then(e=>{this.recordSaved.emit({marcXml:this.record.toXml(),recordId:this.recordId})})})})}undeleteAuthorityRecord(){return this.pcrud.retrieve("are",this.record.id).toPromise().then(e=>(e.deleted("f"),this.pcrud.update(e).toPromise())).then(e=>null!==e)}undeleteBibRecord(){return this.net.request("open-ils.cat","open-ils.cat.biblio.record_entry.undelete",this.auth.token(),this.record.id).toPromise().then(e=>{const t=this.evt.parse(e);return!t||(console.error(t),alert(t),!1)})}fastAdd(){this.showFastAdd&&this.fastItemLabel&&this.fastItemBarcode&&this.holdings.spawnAddHoldingsUi(this.recordId,null,[{label:this.fastItemLabel,barcode:this.fastItemBarcode,fast_add:!0}])}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(s.a),c.Lb(o.a),c.Lb(n.b),c.Lb(a.a),c.Lb(r.a),c.Lb(d.a),c.Lb(l.a),c.Lb(m.a),c.Lb(b.a))},e.\u0275cmp=c.Fb({type:e,selectors:[["eg-marc-editor"]],viewQuery:function(e,t){var i;1&e&&(c.Sc(T,!0),c.Sc(k,!0),c.Sc(I,!0),c.Sc(S,!0),c.Sc(M,!0),c.Sc(w,!0)),2&e&&(c.yc(i=c.gc())&&(t.sourceSelector=i.first),c.yc(i=c.gc())&&(t.confirmDelete=i.first),c.yc(i=c.gc())&&(t.confirmUndelete=i.first),c.yc(i=c.gc())&&(t.cannotDelete=i.first),c.yc(i=c.gc())&&(t.successMsg=i.first),c.yc(i=c.gc())&&(t.failMsg=i.first))},inputs:{recordType:"recordType",recordId:"recordId",recordXml:"recordXml",recordSource:"recordSource",inPlaceMode:"inPlaceMode"},outputs:{recordSaved:"recordSaved"},decls:32,vars:11,consts:[[6,"dialogTitle","dialogBody"],["confirmDelete",""],["confirmUndelete",""],[6,"dialogBody"],["cannotDelete",""],[6,"text"],["successMsg",""],["failMsg",""],[1,"row","d-flex","p-2","m-2"],[4,"ngIf"],[1,"flex-1"],[1,"mr-2"],[1,"badge","badge-light","p-2"],[1,"pr-3","mr-3","border-right"],[1,"btn","btn-success",3,"disabled","click"],["class","row",4,"ngIf"],[1,"row","d-flex","p-2","m-2","flex-row-reverse"],[1,"form-check"],["type","checkbox","id","fast-add-item",1,"form-check-input",3,"ngModel","ngModelChange"],["for","fast-add-item",1,"form-check-label"],[1,"form-inline"],["type","text",1,"form-control","ml-2",3,"ngModel","ngModelChange",6,"placeholder"],[3,"entries",6,"placeholder"],["sourceSelector",""],["class","btn btn-warning",3,"disabled","click",4,"ngIf"],["class","btn btn-info",3,"disabled","click",4,"ngIf"],[1,"btn","btn-warning",3,"disabled","click"],[1,"btn","btn-info",3,"disabled","click"],[1,"row","mt-5"],[1,"offset-lg-3","col-lg-6"],[1,"row"],[1,"col-lg-12"],["ngbNav","",1,"nav-tabs",3,"activeId","navChange"],["editorNav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],["ngbNavItem","flat"],[3,"ngbNavOutlet"],[3,"context"]],template:function(e,t){1&e&&(c.Rb(0,"eg-confirm-dialog",0,1),c.Xb(2,F),c.Qb(),c.Rb(3,"eg-confirm-dialog",0,2),c.Xb(5,$),c.Qb(),c.Rb(6,"eg-alert-dialog",3,4),c.Xb(8,O),c.Qb(),c.Rb(9,"eg-string",5,6),c.Xb(11,z),c.Qb(),c.Rb(12,"eg-string",5,7),c.Xb(14,B),c.Qb(),c.Rb(15,"div",8),c.Kc(16,X,5,1,"ng-container",9),c.Kc(17,V,6,2,"ng-container",9),c.Mb(18,"div",10),c.Rb(19,"h3",11),c.Rb(20,"span",12),c.Vb(21,P),c.Qb(),c.Qb(),c.Kc(22,K,5,1,"ng-container",9),c.Rb(23,"div",13),c.Rb(24,"button",14),c.fc("click",(function(){return t.saveRecord()})),c.Vb(25,_),c.Qb(),c.Qb(),c.Kc(26,G,3,2,"ng-container",9),c.Qb(),c.Kc(27,Y,4,0,"ng-container",9),c.Kc(28,ce,13,3,"div",15),c.Rb(29,"div",16),c.Rb(30,"button",14),c.fc("click",(function(){return t.saveRecord()})),c.Vb(31,N),c.Qb(),c.Qb()),2&e&&(c.Zb(t.record?t.record.id:""),c.Wb(2),c.xb(3),c.Zb(t.record?t.record.id:""),c.Wb(5),c.xb(13),c.oc("ngIf","biblio"===t.recordType),c.xb(1),c.oc("ngIf",t.showFastAdd),c.xb(4),c.Zb(t.record?t.record.recordType():""),c.Wb(21),c.xb(1),c.oc("ngIf","biblio"===t.recordType),c.xb(2),c.oc("disabled",t.record&&t.record.deleted),c.xb(2),c.oc("ngIf",t.record&&t.record.id),c.xb(1),c.oc("ngIf",t.dataSaving),c.xb(1),c.oc("ngIf",!t.dataSaving),c.xb(2),c.oc("disabled",t.record&&t.record.deleted))},directives:[g.a,x.a,f.a,R.v,v.a,v.t,v.w,v.c,h.a,y.a,Q.u,Q.w,Q.x,Q.v,Q.y,C.a,L.a],encapsulation:2}),e})()},"1tmW":function(e,t,i){"use strict";i.d(t,"a",(function(){return K}));var c=i("z6cu"),o=i("eIep"),s=i("Osig"),n=i("wBwE"),a=i("EQDH"),r=i("YRS1"),d=i("8PDw"),l=i("rRT/"),b=i("36iw"),f=i("fXoL"),u=i("1kSV"),h=i("ofXK"),g=i("9rfo"),p=i("3Pt+");const m=["confirmAddToShared"],x=["dialogTitle",$localize`:␟e6fcde529b2973744d0e371cdef78752ea20ea78␟2729218181119418320:Confirm Add to Shared Bucket`,"dialogBody",$localize`:␟01cbca1101c49882e5e58b68da44ad221b0cc02b␟1488010888079899285:Add to shared bucket named '${"\ufffd0\ufffd"}:INTERPOLATION:'?`],R=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var v,y,Q,C,L,T,k;function I(e,t){if(1&e&&(f.Rb(0,"span"),f.Vb(1,C),f.Qb()),2&e){const e=f.hc(3);f.xb(1),f.Zb(e.itemIds[0]),f.Wb(1)}}function S(e,t){if(1&e&&(f.Rb(0,"span"),f.Vb(1,L),f.Qb()),2&e){const e=f.hc(3);f.xb(1),f.Zb(e.itemIds.length),f.Wb(1)}}function M(e,t){if(1&e&&(f.Pb(0),f.Kc(1,I,2,1,"span",5),f.Kc(2,S,2,1,"span",5),f.Ob()),2&e){const e=f.hc(2);f.xb(1),f.oc("ngIf",1==e.itemIds.length),f.xb(1),f.oc("ngIf",e.itemIds.length>1)}}function w(e,t){if(1&e&&(f.Rb(0,"span"),f.Vb(1,T),f.Qb()),2&e){const e=f.hc(2);f.xb(1),f.Zb(e.fromBibQueue),f.Wb(1)}}v=$localize`:␟81ae728b9aecd901ede74a045b4792861276f51d␟4807055819504490039:Existing bucket`,y=$localize`:␟deabfb5e3d2deab449d9b7e8ddd0b50f4a644a62␟1662440769395208246:New bucket`,Q=$localize`:␟e5021eb27e1f8d105aac75f3f16c9f9e60ca1f74␟883729875913828129:Shared bucket`,C=$localize`:␟dbec0f8afbd0f18f3116e5cd455ededc3a9f7723␟4995033811487963876: Add Item #${"\ufffd0\ufffd"}:INTERPOLATION: to Bucket`,L=$localize`:␟b29a061df10a37a0bda3cb2bb9845d9385bd845e␟4582586161935089741: Add ${"\ufffd0\ufffd"}:INTERPOLATION: Items to Bucket`,T=$localize`:␟0cf3f5670eddf78f76b2e86cfed027a59fd863c5␟7768401651238929517:Add Records from queue #${"\ufffd0\ufffd"}:INTERPOLATION: to Bucket`,k=$localize`:␟fd758b1a4ce8d1391f61292464aba13bb1c30b53␟1645993559268540192:Name of existing bucket`;const F=["placeholder",$localize`:␟79c8c5cc2b8604dae85cc2d843fff1902ce70d61␟5229334771847716711:Existing Bucket...`];var $,O;function z(e,t){if(1&e){const e=f.Sb();f.Rb(0,"div",15),f.Rb(1,"div",16),f.Vb(2,k),f.Qb(),f.Rb(3,"div",17),f.Rb(4,"eg-combobox",18),f.Xb(5,F),f.fc("onChange",(function(t){return f.Bc(e),f.hc(2).bucketChanged(t)})),f.Qb(),f.Qb(),f.Rb(6,"div",19),f.Rb(7,"button",20),f.fc("click",(function(){return f.Bc(e),f.hc(2).addToSelected()})),f.Vb(8,$),f.Qb(),f.Qb(),f.Qb()}if(2&e){const e=f.hc(2);f.xb(4),f.oc("entries",e.formatBucketEntries()),f.xb(3),f.oc("disabled",!e.selectedBucket)}}$=$localize`:␟47e82f1e727d54d7ef59064a8d895c660ba9a0a6␟3796644035323974205: Add To Selected Bucket `,O=$localize`:␟ad7da724add53862b3f90c00eb104d19f87b6227␟6166916462838738417:Name of new bucket`;const B=["placeholder",$localize`:␟f07f4d30cc7f8880a01eaa9dc214a718df79dbf6␟6442754472529480962:New Bucket Name...`];var P,_;P=$localize`:␟dbeafacde011f7f17e87efe91c718d3e7bb2cc35␟4484179042703766379: Add To New Bucket `,_=$localize`:␟639f344e8fad6497890d8c3d7430963f7c8a700b␟8496165594806997416:New bucket description`;const N=["placeholder",$localize`:␟7b6f79f8db138e5b04312571d1a3ef98c93d2583␟8837351472407102920:Optional New Bucket Description...`];function X(e,t){if(1&e){const e=f.Sb();f.Rb(0,"div",15),f.Rb(1,"div",16),f.Vb(2,O),f.Qb(),f.Rb(3,"div",17),f.Rb(4,"input",21),f.Xb(5,B),f.fc("ngModelChange",(function(t){return f.Bc(e),f.hc(2).newBucketName=t})),f.Qb(),f.Qb(),f.Rb(6,"div",19),f.Rb(7,"button",20),f.fc("click",(function(){return f.Bc(e),f.hc(2).addToNew()})),f.Vb(8,P),f.Qb(),f.Qb(),f.Qb(),f.Rb(9,"div",15),f.Rb(10,"div",16),f.Vb(11,_),f.Qb(),f.Rb(12,"div",17),f.Rb(13,"textarea",22),f.Xb(14,N),f.fc("ngModelChange",(function(t){return f.Bc(e),f.hc(2).newBucketDesc=t})),f.Mc(15,"              "),f.Qb(),f.Qb(),f.Qb()}if(2&e){const e=f.hc(2);f.xb(4),f.oc("ngModel",e.newBucketName),f.xb(3),f.oc("disabled",!e.newBucketName),f.xb(6),f.oc("ngModel",e.newBucketDesc)}}var D,A;function V(e,t){if(1&e){const e=f.Sb();f.Rb(0,"div",15),f.Rb(1,"div",16),f.Vb(2,D),f.Qb(),f.Rb(3,"div",17),f.Rb(4,"input",23),f.fc("ngModelChange",(function(t){return f.Bc(e),f.hc(2).sharedBucketId=t})),f.Qb(),f.Qb(),f.Rb(5,"div",19),f.Rb(6,"button",20),f.fc("click",(function(){return f.Bc(e),f.hc(2).addToShared()})),f.Vb(7,A),f.Qb(),f.Qb(),f.Qb()}if(2&e){const e=f.hc(2);f.xb(4),f.oc("ngModel",e.sharedBucketId),f.xb(2),f.oc("disabled",!e.sharedBucketId)}}function E(e,t){if(1&e){const e=f.Sb();f.Rb(0,"div",3),f.Rb(1,"h4",4),f.Kc(2,M,3,2,"ng-container",5),f.Kc(3,w,2,1,"span",5),f.Qb(),f.Rb(4,"button",6),f.Xb(5,R),f.fc("click",(function(){return f.Bc(e),f.hc().close()})),f.Rb(6,"span",7),f.Mc(7,"\xd7"),f.Qb(),f.Qb(),f.Qb(),f.Rb(8,"div",8),f.Rb(9,"ul",9,10),f.Rb(11,"li",11),f.Rb(12,"a",12),f.Vb(13,v),f.Qb(),f.Kc(14,z,9,2,"ng-template",13),f.Qb(),f.Rb(15,"li",11),f.Rb(16,"a",12),f.Vb(17,y),f.Qb(),f.Kc(18,X,16,3,"ng-template",13),f.Qb(),f.Rb(19,"li",11),f.Rb(20,"a",12),f.Vb(21,Q),f.Qb(),f.Kc(22,V,8,2,"ng-template",13),f.Qb(),f.Qb(),f.Mb(23,"div",14),f.Qb()}if(2&e){const e=f.zc(10),t=f.hc();f.xb(2),f.oc("ngIf",t.itemIds.length>0),f.xb(1),f.oc("ngIf",t.fromBibQueue),f.xb(8),f.oc("ngbNavItem",1),f.xb(4),f.oc("ngbNavItem",2),f.xb(4),f.oc("ngbNavItem",3),f.xb(4),f.oc("ngbNavOutlet",e)}}D=$localize`:␟633f72d475b66b6c000619118fdfd80f982c8a5f␟2952112088789054008:ID of shared bucket`,A=$localize`:␟a6a4934e20c2979730ac0813fe9e1304c358cbcd␟6575385329965439486: Add To Shared Bucket `;let K=(()=>{class e extends l.a{constructor(e,t,i,c,o,s,n){super(e),this.modal=e,this.renderer=t,this.toast=i,this.idl=c,this.net=o,this.evt=s,this.auth=n,this.buckets=[],this.itemIds=[],this.fromBibQueue=null}ngOnInit(){this.onOpen$.subscribe(e=>{this.reset(),this.net.request("open-ils.actor","open-ils.actor.container.retrieve_by_class.authoritative",this.auth.token(),this.auth.user().id(),this.bucketClass,this.bucketType).subscribe(e=>this.buckets=e)})}reset(){switch(this.selectedBucket=null,this.sharedBucketId=null,this.sharedBucketName="",this.newBucketName="",this.newBucketDesc="",this.bucketClass||(this.bucketClass="biblio"),this.bucketClass){case"biblio":this.fromBibQueue&&(this.bucketType="vandelay_queue"),this.bucketFmClass="cbreb",this.targetField="target_biblio_record_entry";break;case"copy":this.bucketFmClass="ccb",this.targetField="target_copy";break;case"callnumber":this.bucketFmClass="ccnb",this.targetField="target_call_number";break;case"user":this.bucketFmClass="cub",this.targetField="target_user"}this.bucketType||(this.bucketType="staff_client")}addToSelected(){this.addToBucket(this.selectedBucket)}addToShared(){this.net.request("open-ils.actor","open-ils.actor.container.flesh",this.auth.token(),this.bucketClass,this.sharedBucketId).pipe(Object(o.a)(e=>{const t=this.evt.parse(e);return t?(this.toast.danger(t.toString()),Object(c.a)(t)):(this.sharedBucketName=e.name(),this.confirmAddToShared.open())})).subscribe(()=>{this.addToBucket(this.sharedBucketId)})}bucketChanged(e){this.selectedBucket=e?e.id:null}formatBucketEntries(){return this.buckets.map(e=>({id:e.id(),label:e.name()}))}addToNew(){const e=this.idl.create(this.bucketFmClass);e.owner(this.auth.user().id()),e.name(this.newBucketName),e.description(this.newBucketDesc),e.btype(this.bucketType),this.net.request("open-ils.actor","open-ils.actor.container.create",this.auth.token(),this.bucketClass,e).subscribe(t=>{const i=this.evt.parse(t);i?this.toast.danger(i.desc):(e.id(t),this.buckets.push(e),this.addToBucket(t))})}addToBucket(e){this.itemIds.length>0?this.addRecordToBucket(e):this.fromBibQueue&&this.addBibQueueToBucket(e)}addRecordToBucket(e){const t=[];this.itemIds.forEach(i=>{const c=this.idl.create(this.bucketFmClass+"i");c.bucket(e),c[this.targetField](i),t.push(c)}),this.net.request("open-ils.actor","open-ils.actor.container.item.create",this.auth.token(),this.bucketClass,t).subscribe(e=>{const t=this.evt.parse(e);t?this.toast.danger(t.toString()):this.close()})}addBibQueueToBucket(e){const t=this.buckets.filter(t=>t.id()===e)[0];t&&this.net.request("open-ils.vandelay","open-ils.vandelay.bib_queue.to_bucket",this.auth.token(),this.fromBibQueue,t.name()).toPromise().then(e=>{const t=this.evt.parse(e);t?this.toast.danger(t.toString()):this.close()})}}return e.\u0275fac=function(t){return new(t||e)(f.Lb(u.s),f.Lb(f.D),f.Lb(r.a),f.Lb(n.a),f.Lb(s.b),f.Lb(a.a),f.Lb(d.a))},e.\u0275cmp=f.Fb({type:e,selectors:[["eg-bucket-dialog"]],viewQuery:function(e,t){var i;1&e&&f.Ic(m,!0),2&e&&f.yc(i=f.gc())&&(t.confirmAddToShared=i.first)},inputs:{bucketClass:"bucketClass",bucketType:"bucketType",itemIds:"itemIds",fromBibQueue:"fromBibQueue"},features:[f.ub],decls:5,vars:1,consts:[["dialogContent",""],[6,"dialogTitle","dialogBody"],["confirmAddToShared",""],[1,"modal-header","bg-info"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],["ngbNav","",1,"nav-tabs"],["bucketDialogTabs","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"row","mt-3"],[1,"col-lg-3","font-weight-bold"],[1,"col-lg-5"],[3,"entries","onChange",6,"placeholder"],[1,"col-lg-4"],[1,"btn","btn-info",3,"disabled","click"],["type","text",1,"form-control",3,"ngModel","ngModelChange",6,"placeholder"],["size","3","type","text",1,"form-control",3,"ngModel","ngModelChange",6,"placeholder"],["type","number",1,"form-control",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(f.Kc(0,E,24,6,"ng-template",null,0,f.Lc),f.Rb(2,"eg-confirm-dialog",1,2),f.Xb(4,x),f.Qb()),2&e&&(f.xb(2),f.Zb(t.sharedBucketName),f.Wb(4))},directives:[b.a,h.v,u.u,u.w,u.x,u.v,u.y,g.a,p.c,p.t,p.w,p.z],encapsulation:2}),e})()},"2XLs":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var c=i("Osig"),o=i("8PDw"),s=i("fXoL");function n(e,t){}let a=(()=>{class e{constructor(e,t,i){this.elm=e,this.net=t,this.auth=i,this.initDone=!1}set recordId(e){this.recId=e,this.initDone&&this.collectData()}set recordType(e){this.recType=e}ngOnInit(){this.initDone=!0,this.collectData()}collectData(){if(!this.recId)return;let e="open-ils.search",t="open-ils.search.biblio.record.html";const i=[this.recId];switch(this.recType){case"authority":t="open-ils.search.authority.to_html";break;case"vandelay-authority":i.unshift(this.auth.token()),e="open-ils.vandelay",t="open-ils.vandelay.queued_authority_record.html";break;case"vandelay-bib":i.unshift(this.auth.token()),e="open-ils.vandelay",t="open-ils.vandelay.queued_bib_record.html"}this.net.requestWithParamList(e,t,i).toPromise().then(e=>this.injectHtml(e))}injectHtml(e){e=(e=(e=(e=e.replace(/<button onclick="window.print(.*?)<\/button>/,"")).replace(/<title>(.*?)<\/title>/,"")).replace(/<link(.*?)\/>/,"")).replace(/<script(.*?)<\/script>/,""),this.elm.nativeElement.innerHTML=e}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(s.l),s.Lb(c.b),s.Lb(o.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["eg-marc-html"]],inputs:{recordId:"recordId",recordType:"recordType"},decls:1,vars:0,template:function(e,t){1&e&&s.Kc(0,n,0,0,"ng-template")},encapsulation:2}),e})()},"3RDE":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return n}));var c=i("3Pt+"),o=(i("f0Wu"),i("fXoL"));function s(e){return t=>t.value&&t.value.isBefore(e)?{tooEarly:"This cannot be before "+e.format("LLL")}:null}let n=(()=>{class e{validate(e){return this.notBeforeMoment?s(this.notBeforeMoment)(e):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=o.Gb({type:e,selectors:[["","egNotBeforeMoment",""]],inputs:{notBeforeMoment:["egNotBeforeMoment","notBeforeMoment"]},features:[o.wb([{provide:c.q,useExisting:e,multi:!0}])]}),e})()},"6Unn":function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var c=i("wBwE"),o=i("iA0r"),s=i("YRS1"),n=i("OXuP"),a=i("rRT/"),r=i("tNQm"),d=i("fXoL"),l=i("1kSV"),b=i("9rfo");const f=["successMsg"],u=["errorMsg"],h=["text",$localize`:␟50a412112dcc6a4b3ed99e128540388ad6a2a684␟1844572890900568930:Successfully Attached/Modified Conjoined Item(s)`],g=["text",$localize`:␟753dd16e0d42a8fb7802278fe934e9fea471bea1␟3752350610904481783:Failed To Attach/Modify Conjoined Item(s)`];var p;p=$localize`:␟6852a1cda1045fe5b2151f871b9a2ae9ddfaae44␟7956068296385048461:Attach/Modify ${"\ufffd0\ufffd"}:INTERPOLATION: Conjoined Item(s)`;const m=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var x;x=$localize`:␟fec90806704237ed40043813357af07f248fef1a␟6395579217130597880:${"\ufffd#12\ufffd"}:START_TAG_LABEL:Peer Type:${"\ufffd/#12\ufffd"}:CLOSE_TAG_LABEL:`;const R=["placeholder",$localize`:␟430d961dad3f55459cdb12f63f2355047afa5b9c␟2844061459549698697:Peer Type...`];var v,y;function Q(e,t){if(1&e){const e=d.Sb();d.Rb(0,"div",4),d.Rb(1,"h4",5),d.Rb(2,"span"),d.Vb(3,p),d.Qb(),d.Qb(),d.Rb(4,"button",6),d.Xb(5,m),d.fc("click",(function(){return d.Bc(e),d.hc().close()})),d.Rb(6,"span",7),d.Mc(7,"\xd7"),d.Qb(),d.Qb(),d.Qb(),d.Rb(8,"div",8),d.Rb(9,"div",9),d.Rb(10,"div",10),d.bc(11,x),d.Mb(12,"label",11),d.Yb(),d.Qb(),d.Rb(13,"div",12),d.Rb(14,"eg-combobox",13),d.Xb(15,R),d.fc("onChange",(function(t){return d.Bc(e),d.hc().peerTypeChanged(t)})),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(16,"div",14),d.Pb(17),d.Rb(18,"button",15),d.fc("click",(function(){return d.Bc(e),d.hc().close()})),d.Vb(19,v),d.Qb(),d.Rb(20,"button",16),d.fc("click",(function(){return d.Bc(e),d.hc().linkCopies()})),d.Vb(21,y),d.Qb(),d.Ob(),d.Qb()}if(2&e){const e=d.hc();d.xb(3),d.Zb(e.copyIds.length),d.Wb(3),d.xb(11),d.oc("entries",e.peerTypes)("required",!0),d.xb(6),d.oc("disabled",!e.peerType)}}v=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,y=$localize`:␟bc67ec3a7e4f2a58e0ba62e254729d26698aa32b␟3131950574823774300: Attach/Modify `;let C=(()=>{class e extends a.a{constructor(e,t,i,c,o){super(e),this.modal=e,this.toast=t,this.idl=i,this.pcrud=c,this.localStore=o,this.peerTypes=[],this.copyIds=[]}ngOnInit(){this.onOpenSub=this.onOpen$.subscribe(()=>{this.modifyAll&&(this.copyIds=[]),this.numSucceeded=0,this.numFailed=0,this.peerRecord||(this.peerRecord=this.localStore.getLocalItem("eg.cat.marked_conjoined_record"),this.peerRecord||this.close(!1)),0===this.peerTypes.length&&this.getPeerTypes(),this.fetchExistingMaps()})}ngOnDestroy(){this.onOpenSub.unsubscribe()}fetchExistingMaps(){this.existingMaps={};const e={peer_record:this.peerRecord};this.modifyAll||(e.target_copy=this.copyIds),this.pcrud.search("bpbcm",e).subscribe(e=>{this.existingMaps[e.target_copy()]=e,this.modifyAll&&this.copyIds.push(e.target_copy())})}getPeerTypes(){return this.pcrud.retrieveAll("bpt",{},{atomic:!0}).toPromise().then(e=>this.peerTypes=e.map(e=>({id:e.id(),label:e.name()})))}peerTypeChanged(e){this.peerType=e?e.id:null}linkCopies(){const e=[];return this.copyIds.forEach(t=>{let i;this.existingMaps[t]?(i=this.existingMaps[t],i.ischanged(!0)):(i=this.idl.create("bpbcm"),i.isnew(!0)),i.peer_record(this.peerRecord),i.target_copy(t),i.peer_type(this.peerType),e.push(i)}),this.pcrud.autoApply(e).subscribe(e=>this.numSucceeded++,e=>{this.numFailed++,console.error(e),this.errorMsg.current().then(e=>this.toast.warning(e))},()=>{this.successMsg.current().then(e=>this.toast.success(e)),this.close(this.numSucceeded>0)})}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(l.s),d.Lb(s.a),d.Lb(c.a),d.Lb(o.a),d.Lb(n.a))},e.\u0275cmp=d.Fb({type:e,selectors:[["eg-conjoined-items-dialog"]],viewQuery:function(e,t){var i;1&e&&(d.Ic(f,!0),d.Ic(u,!0)),2&e&&(d.yc(i=d.gc())&&(t.successMsg=i.first),d.yc(i=d.gc())&&(t.errorMsg=i.first))},inputs:{copyIds:"copyIds",modifyAll:"modifyAll",peerRecord:"peerRecord"},features:[d.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row","form-validated"],[1,"col-lg-4"],["for","cbox-peer-types"],[1,"col-lg-8"],["id","cbox-peer-types",3,"entries","required","onChange",6,"placeholder"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"]],template:function(e,t){1&e&&(d.Rb(0,"eg-string",0,1),d.Xb(2,h),d.Qb(),d.Rb(3,"eg-string",0,2),d.Xb(5,g),d.Qb(),d.Kc(6,Q,22,4,"ng-template",null,3,d.Lc))},directives:[r.a,b.a],encapsulation:2}),e})()},"6tXh":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var c,o=i("Osig"),s=i("cm5s"),n=i("8PDw"),a=i("iA0r"),r=i("rRT/"),d=(i("DMNx"),i("fXoL")),l=i("1kSV");c=$localize`:␟5ea40047799ceafa9f107e4199d9757b1a7f1182␟1721727322854792098:MARC Editor`;const b=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];function f(e,t){if(1&e){const e=d.Sb();d.Rb(0,"div",1),d.Rb(1,"h4",2),d.Vb(2,c),d.Qb(),d.Rb(3,"button",3),d.Xb(4,b),d.fc("click",(function(){return d.Bc(e),d.hc().close()})),d.Rb(5,"span",4),d.Mc(6,"\xd7"),d.Qb(),d.Qb(),d.Qb(),d.Rb(7,"div",5),d.Rb(8,"eg-marc-editor",6,7),d.fc("recordSaved",(function(t){return d.Bc(e),d.hc().handleRecordSaved(t)})),d.Qb(),d.Qb()}if(2&e){const e=d.hc();d.xb(8),d.oc("recordType",e.recordType)("recordXml",e.recordXml)}}let u=(()=>{class e extends r.a{constructor(e,t,i,c,o){super(e),this.modal=e,this.auth=t,this.org=i,this.pcrud=c,this.net=o,this.recordType="biblio"}ngOnInit(){}handleRecordSaved(e){this.close(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Lb(l.s),d.Lb(n.a),d.Lb(s.a),d.Lb(a.a),d.Lb(o.b))},e.\u0275cmp=d.Fb({type:e,selectors:[["eg-marc-editor-dialog"]],inputs:{context:"context",recordXml:"recordXml",recordType:"recordType"},features:[d.ub],decls:2,vars:0,consts:[["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[3,"recordType","recordXml","recordSaved"],["marcEditor",""]],template:function(e,t){1&e&&d.Kc(0,f,10,2,"ng-template",null,0,d.Lc)},encapsulation:2}),e})()},"7DyM":function(e,t,i){"use strict";i.d(t,"a",(function(){return Q}));var c=i("wBwE"),o=i("Osig"),s=i("8PDw"),n=i("EQDH"),a=i("YRS1"),r=i("36iw"),d=i("/xpB"),l=i("tNQm"),b=i("fXoL");const f=["successMsg"],u=["errorMsg"],h=["noTargetMsg"],g=["confirmDialog"],p=["alertDialog"],m=["text",$localize`:␟833073c7be4d2407daea4f7e631fec2433a771d2␟6301982531655745147:Successfully Transferred Item(s)`],x=["text",$localize`:␟34112daab1103cca61439710cc0373e826b26cc9␟6339547280250871578:Failed To Transfer Item(s)`],R=["text",$localize`:␟a38806c3bcd0fa35267178e1a01bc2ee5686fa36␟4393492974110351892:No transfer target selected`],v=["dialogTitle",$localize`:␟296a0434301a9a6586329b2517dcb2ab5dcc2426␟1632392052962965770:One or more items could not be transferred. Override?`,"dialogBody",$localize`:␟8f4224bf1f19027516f0fcfd90bb76496eafc985␟3909575663223570641:Reason(s) include: ${"\ufffd0\ufffd"}:INTERPOLATION:`],y=["dialogTitle",$localize`:␟1421e272e9be4a8848af6b07f5e3cbff10b0a6cf␟5619266044227052818:One or more items could not be transferred`,"dialogBody",$localize`:␟8f4224bf1f19027516f0fcfd90bb76496eafc985␟3909575663223570641:Reason(s) include: ${"\ufffd0\ufffd"}:INTERPOLATION:`];let Q=(()=>{class e{constructor(e,t,i,c,o){this.toast=e,this.idl=t,this.net=i,this.auth=c,this.evt=o}ngOnInit(){}transferItems(e,t,i){this.eventDesc="";let c="open-ils.cat.transfer_copies_to_volume";return i&&(c+=".override"),this.net.request("open-ils.cat",c,this.auth.token(),t,e).toPromise().then(c=>{const o=this.evt.parse(c);return o?i?(this.toast.warning(this.errorMsg.text),!1):(this.eventDesc=o.desc,this.confirmDialog.open().toPromise().then(i=>!!i&&this.transferItems(e,t,!0))):(this.toast.success(this.successMsg.text),!0)})}autoTransferItems(e,t,i){this.eventDesc="";const c={},o={};return e.forEach(e=>{const s=e.call_number();s.owning_lib()===i&&s.record()===t||(s.owning_lib(i),s.record(t),c[s.id()]?o[s.id()].push(e.id()):(c[s.id()]=s,o[s.id()]=[e.id()]))}),this.transferCallNumbers(c,o)}transferCallNumbers(e,t){const i=Object.keys(e)[0],c=e[i];return delete e[i],this.net.request("open-ils.cat","open-ils.cat.call_number.find_or_create",this.auth.token(),c.label(),c.record(),c.owning_lib(),"object"==typeof c.prefix()?c.prefix().id():c.prefix(),"object"==typeof c.suffix()?c.suffix().id():c.suffix(),c.label_class()).toPromise().then(i=>{const o=this.evt.parse(i);return o?(this.toast.warning(this.errorMsg.text),this.eventDesc=o.desc,this.alertDialog.open().toPromise().then(e=>!1)):this.transferItems(t[c.id()],i.acn_id).then(i=>i&&Object.keys(e).length>0?this.transferCallNumbers(e,t):i)})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(a.a),b.Lb(c.a),b.Lb(o.b),b.Lb(s.a),b.Lb(n.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-transfer-items"]],viewQuery:function(e,t){var i;1&e&&(b.Sc(f,!0),b.Sc(u,!0),b.Sc(h,!0),b.Sc(g,!0),b.Sc(p,!0)),2&e&&(b.yc(i=b.gc())&&(t.successMsg=i.first),b.yc(i=b.gc())&&(t.errorMsg=i.first),b.yc(i=b.gc())&&(t.noTargetMsg=i.first),b.yc(i=b.gc())&&(t.confirmDialog=i.first),b.yc(i=b.gc())&&(t.alertDialog=i.first))},decls:15,vars:2,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["noTargetMsg",""],[6,"dialogTitle","dialogBody"],["confirmDialog",""],["alertDialog",""]],template:function(e,t){1&e&&(b.Rb(0,"eg-string",0,1),b.Xb(2,m),b.Qb(),b.Rb(3,"eg-string",0,2),b.Xb(5,x),b.Qb(),b.Rb(6,"eg-string",0,3),b.Xb(8,R),b.Qb(),b.Rb(9,"eg-confirm-dialog",4,5),b.Xb(11,v),b.Qb(),b.Rb(12,"eg-alert-dialog",4,6),b.Xb(14,y),b.Qb()),2&e&&(b.xb(9),b.Zb(t.eventDesc),b.Wb(11),b.xb(3),b.Zb(t.eventDesc),b.Wb(14))},directives:[l.a,r.a,d.a],encapsulation:2}),e})()},"7w9P":function(e,t,i){"use strict";i.d(t,"a",(function(){return U}));var c,o,s,n,a,r=i("cm5s"),d=i("+MQy"),l=i("XKii"),b=i("OsfI"),f=i("mW9/"),u=i("fXoL"),h=i("ofXK"),g=i("RXDw"),p=i("tyNb");function m(e,t){1&e&&(u.Pb(0),u.Rb(1,"span",19),u.Vb(2,a),u.Qb(),u.Ob())}function x(e,t){if(1&e&&(u.Pb(0),u.Rb(1,"span",21),u.Mb(2,"img",22),u.Rb(3,"span",23),u.Mc(4),u.Qb(),u.Qb(),u.Ob()),2&e){const e=t.$implicit,i=u.hc(3);u.xb(2),u.qc("src","/images/format_icons/icon_format/",e,".png",u.Ec),u.xb(2),u.Nc(i.iconFormatLabel(e))}}function R(e,t){if(1&e&&(u.Pb(0),u.Kc(1,x,5,2,"ng-container",20),u.Ob()),2&e){const e=u.hc(2);u.xb(1),u.oc("ngForOf",e.summary.attributes.icon_format)}}c=$localize`:␟8737210008395d7b014e5118d2ed198ae9745215␟2517309683610083249:Title:`,o=$localize`:␟89fc11a7cbfbefdaeb4ede0e70018995545c90d3␟4541882326862791479:Edition:`,s=$localize`:␟f455d4f5921c5b42964dca89db9de100339f56d9␟827908232148558337:TCN:`,n=$localize`:␟3c9246b53524feea8b89a2f97bc620a79c2f95bd␟7702074589615088207:Created By:`,a=$localize`:␟3d3c2661b7b68182d21dc842ad6f797f7ae3695a␟989472037369554228:(Deleted)`;const v=["title",$localize`:␟ca98710638193518e4fe1302f8977d2db4f2b842␟8279858216477066574:Show More`];function y(e,t){if(1&e){const e=u.Sb();u.Rb(0,"a",24),u.Xb(1,v),u.fc("click",(function(){return u.Bc(e),u.hc(2).expand=!0})),u.Rb(2,"span",25),u.Mc(3,"expand_more"),u.Qb(),u.Qb()}}const Q=["title",$localize`:␟ae9293cd31a822990eaf190bb08bd2852e3469ab␟7224064517561854142:Show Less`];function C(e,t){if(1&e){const e=u.Sb();u.Rb(0,"a",24),u.Xb(1,Q),u.fc("click",(function(){return u.Bc(e),u.hc(2).expand=!1})),u.Rb(2,"span",25),u.Mc(3,"expand_less"),u.Qb(),u.Qb()}}const L=["alt",$localize`:␟9ff67d5a9fb72a3956059b5d05dc63599b3408e0␟4199328076994282874:Jacket Image`];function T(e,t){if(1&e&&(u.Pb(0),u.Rb(1,"div",26),u.Rb(2,"a",27),u.Rb(3,"img",28),u.Xb(4,L),u.Qb(),u.Qb(),u.Qb(),u.Ob()),2&e){const e=u.hc(2);u.xb(2),u.qc("href","/opac/extras/ac/jacket/large/r/",e.summary.id,"",u.Ec),u.xb(1),u.qc("src","/opac/extras/ac/jacket/medium/r/",e.summary.id,"",u.Ec)}}function k(e,t){if(1&e&&(u.Rb(0,"div",5),u.Rb(1,"a",27),u.Mc(2),u.Qb(),u.Qb()),2&e){const e=u.hc(2);u.xb(1),u.qc("href","/eg/staff/circ/patron/",e.summary.record.creator().id(),"/checkout",u.Ec),u.xb(1),u.Oc(" ",e.summary.record.creator().usrname()," ")}}var I,S,M,w,F,$,O,z,B,P,_,N,X;function D(e,t){if(1&e&&(u.Rb(0,"div",5),u.Rb(1,"a",27),u.Mc(2),u.Qb(),u.Qb()),2&e){const e=u.hc(3);u.xb(1),u.qc("href","/eg/staff/circ/patron/",e.summary.record.editor().id(),"/checkout",u.Ec),u.xb(1),u.Oc(" ",e.summary.record.editor().usrname()," ")}}function A(e,t){if(1&e&&(u.Rb(0,"li",11),u.Rb(1,"div",12),u.Rb(2,"div",13),u.Vb(3,I),u.Qb(),u.Rb(4,"div",14),u.Mc(5),u.Qb(),u.Rb(6,"div",16),u.Vb(7,S),u.Qb(),u.Rb(8,"div",5),u.Mc(9),u.Qb(),u.Rb(10,"div",13),u.Vb(11,M),u.Qb(),u.Rb(12,"div",5),u.Mc(13),u.Qb(),u.Rb(14,"div",16),u.Vb(15,w),u.Qb(),u.Kc(16,D,3,2,"div",17),u.Qb(),u.Qb()),2&e){const e=u.hc(2);u.xb(5),u.Nc(e.summary.display.author),u.xb(4),u.Nc(e.summary.display.pubdate),u.xb(4),u.Nc(e.summary.id),u.xb(3),u.oc("ngIf",e.summary.record.editor().usrname)}}function V(e,t){if(1&e&&(u.Rb(0,"li",11),u.Rb(1,"div",12),u.Rb(2,"div",13),u.Vb(3,F),u.Qb(),u.Rb(4,"div",14),u.Mc(5),u.Qb(),u.Rb(6,"div",13),u.Vb(7,$),u.Qb(),u.Rb(8,"div",5),u.Mc(9),u.Qb(),u.Rb(10,"div",16),u.Vb(11,O),u.Qb(),u.Rb(12,"div",5),u.Mc(13),u.ic(14,"date"),u.Qb(),u.Rb(15,"div",16),u.Vb(16,z),u.Qb(),u.Rb(17,"div",5),u.Mc(18),u.ic(19,"date"),u.Qb(),u.Qb(),u.Qb()),2&e){const e=u.hc(2);u.xb(5),u.Nc(e.summary.bibCallNumber),u.xb(4),u.Nc(e.orgName(e.summary.record.owner())),u.xb(4),u.Nc(u.kc(14,4,e.summary.record.create_date(),"short")),u.xb(5),u.Nc(u.kc(19,7,e.summary.record.edit_date(),"short"))}}function E(e,t){if(1&e&&(u.Rb(0,"li",11),u.Rb(1,"div",12),u.Rb(2,"div",13),u.Vb(3,P),u.Qb(),u.Rb(4,"div",14),u.Rb(5,"a",30),u.Mc(6),u.Qb(),u.Qb(),u.Rb(7,"div",13),u.Vb(8,_),u.Qb(),u.Rb(9,"div",5),u.Mc(10),u.Qb(),u.Rb(11,"div",13),u.Vb(12,N),u.Qb(),u.Rb(13,"div",5),u.Mc(14),u.Qb(),u.Rb(15,"div",13),u.Vb(16,X),u.Qb(),u.Rb(17,"div",5),u.Mc(18),u.Qb(),u.Qb(),u.Qb()),2&e){const e=t.$implicit,i=u.hc(3);u.xb(5),u.qc("routerLink","/staff/admin/local/asset/course_list/",e.id(),""),u.xb(1),u.Oc(" ",e.name()," "),u.xb(4),u.Nc(e.course_number()),u.xb(4),u.Nc(e.section_number()),u.xb(4),u.Nc(i.org.get(e.owning_lib()).shortname())}}function K(e,t){if(1&e&&(u.Pb(0),u.Rb(1,"li",11),u.Rb(2,"div",12),u.Rb(3,"div",13),u.Vb(4,B),u.Qb(),u.Qb(),u.Qb(),u.Kc(5,E,19,5,"li",29),u.Ob()),2&e){const e=u.hc(2);u.xb(5),u.oc("ngForOf",e.courses)}}I=$localize`:␟61c58c7f484580d386b86c6099edc1d79986a745␟305142716106924307:Author:`,S=$localize`:␟ac22cb8198d056636635cfc7bf770e4d58b15e15␟1453493249242543082:Pubdate:`,M=$localize`:␟b41ad7743c601f123239b4f3e74d2bff4cd58735␟8754059927923500678:Database ID:`,w=$localize`:␟20a1b0b5d4029a0f34c2acb943d392fc61c9e9ff␟4041750009512590368:Last Edited By:`,F=$localize`:␟f40016001faaceb2bb0a0170a59a83dc96c24cb2␟1947477666647615977:Bib Call #:`,$=$localize`:␟0dbd84983108870b6f77ab490d0e19fb1af56816␟7958626758108281996:Record Owner:`,O=$localize`:␟bd159e662052a9a3c62d7caf15e9a0af1d9a08ad␟5244569412023600078:Created On:`,z=$localize`:␟45d815978d44c15a9ace637d1eb1c38861c2833f␟4259046742501053158:Last Edited On:`,B=$localize`:␟36d79bc80923662c57b045922495fcedfc743aaa␟6299159940913066746:Associated Courses`,P=$localize`:␟43e51f2a7832cf46b1329939a158adfd98c943f1␟4876085160989688354:Course Name:`,_=$localize`:␟64e52162002c57ffb4087e98478840f93a472743␟7550513275495722320:Course Number:`,N=$localize`:␟bab323b4469b46ddd9d5fe9d59b454ca3d6411ed␟4044914150608438571:Section Number:`,X=$localize`:␟143fa28797a5decd9321c014021c2c762849f81a␟8291217115871231801:Owning Library:`;const q=function(e,t){return{"col-lg-11 pl-0":e,"col-lg-12":t}};function j(e,t){if(1&e&&(u.Rb(0,"div",1),u.Rb(1,"div",2),u.Rb(2,"div",3),u.Mc(3," Record Summary "),u.Kc(4,m,3,0,"ng-container",4),u.Kc(5,R,2,1,"ng-container",4),u.Qb(),u.Mb(6,"div",5),u.Rb(7,"div"),u.Kc(8,y,4,0,"a",6),u.Kc(9,C,4,0,"a",6),u.Qb(),u.Qb(),u.Rb(10,"div",7),u.Kc(11,T,5,2,"ng-container",4),u.Rb(12,"div",8),u.Rb(13,"div",9),u.Rb(14,"ul",10),u.Rb(15,"li",11),u.Rb(16,"div",12),u.Rb(17,"div",13),u.Vb(18,c),u.Qb(),u.Rb(19,"div",14),u.Mb(20,"eg-bib-display-field",15),u.Qb(),u.Rb(21,"div",16),u.Vb(22,o),u.Qb(),u.Rb(23,"div",5),u.Mc(24),u.Qb(),u.Rb(25,"div",13),u.Vb(26,s),u.Qb(),u.Rb(27,"div",5),u.Mc(28),u.Qb(),u.Rb(29,"div",16),u.Vb(30,n),u.Qb(),u.Kc(31,k,3,2,"div",17),u.Qb(),u.Qb(),u.Kc(32,A,17,4,"li",18),u.Kc(33,V,20,10,"li",18),u.Kc(34,K,6,1,"ng-container",4),u.Qb(),u.Qb(),u.Qb(),u.Qb(),u.Qb()),2&e){const e=u.hc();u.xb(4),u.oc("ngIf","t"==e.summary.record.deleted()),u.xb(1),u.oc("ngIf",e.summary.attributes.icon_format&&e.summary.attributes.icon_format[0]),u.xb(3),u.oc("ngIf",!e.expand),u.xb(1),u.oc("ngIf",e.expand),u.xb(2),u.oc("ngIf",e.expand),u.xb(1),u.oc("ngClass",u.vc(13,q,e.expand,!e.expand)),u.xb(8),u.oc("summary",e.summary),u.xb(4),u.Nc(e.summary.display.edition),u.xb(4),u.Nc(e.summary.record.tcn_value()),u.xb(3),u.oc("ngIf",e.summary.record.creator().usrname),u.xb(1),u.oc("ngIf",e.expand),u.xb(1),u.oc("ngIf",e.expand),u.xb(1),u.oc("ngIf",e.expand&&e.hasCourse)}}let U=(()=>{class e{constructor(e,t,i,c,o){this.bib=e,this.org=t,this.store=i,this.cat=c,this.course=o,this.initDone=!1,this.hasCourse=!1}set expand(e){this._exp=e,this.initDone&&this.saveExpandState()}get expand(){return this._exp}set bibSummary(e){this.summary=e,this.initDone&&this.summary&&(this.summary.getBibCallNumber(),this.loadCourseInformation(this.summary.record.id()))}ngOnInit(){this.summary?(this.summary.getBibCallNumber(),this.loadCourseInformation(this.summary.record.id())):this.recordId&&this.loadSummary(),this.store.getItem("eg.cat.record.summary.collapse").then(e=>this.expand=!e).then(()=>this.initDone=!0)}saveExpandState(){this.store.setItem("eg.cat.record.summary.collapse",!this.expand)}loadSummary(){this.loadCourseInformation(this.recordId),this.bib.getBibSummary(this.recordId).toPromise().then(e=>{e.getBibCallNumber(),this.summary=e})}loadCourseInformation(e){this.org.settings("circ.course_materials_opt_in").then(t=>{t["circ.course_materials_opt_in"]&&this.course.fetchCoursesForRecord(e).then(e=>{e&&(this.courses=e,this.hasCourse=!0)})})}orgName(e){if(e)return this.org.get(e).shortname()}iconFormatLabel(e){return this.cat.iconFormatLabel(e)}}return e.\u0275fac=function(t){return new(t||e)(u.Lb(l.a),u.Lb(r.a),u.Lb(b.a),u.Lb(f.a),u.Lb(d.a))},e.\u0275cmp=u.Fb({type:e,selectors:[["eg-bib-summary"]],inputs:{recordId:"recordId",bibSummary:"bibSummary"},decls:1,vars:1,consts:[["class","eg-bib-summary card tight-card w-100",4,"ngIf"],[1,"eg-bib-summary","card","tight-card","w-100"],[1,"card-header","d-flex"],[1,"font-weight-bold"],[4,"ngIf"],[1,"flex-1"],["class","with-material-icon no-href text-primary",3,"click",4,"ngIf",6,"title"],[1,"row"],[3,"ngClass"],[1,"card-body"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"d-flex"],[1,"flex-1","font-weight-bold"],[1,"flex-3"],["field","title",3,"summary"],[1,"flex-1","font-weight-bold","pl-1"],["class","flex-1",4,"ngIf"],["class","list-group-item",4,"ngIf"],[1,"text-danger"],[4,"ngFor","ngForOf"],[1,"pr-1","pl-2"],[1,"pr-1",3,"src"],[1,"font-weight-normal"],[1,"with-material-icon","no-href","text-primary",3,"click",6,"title"],[1,"material-icons"],[1,"col-lg-1","pr-0"],[3,"href"],[1,"jacket","jacket-medium",3,"src",6,"alt"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"routerLink"]],template:function(e,t){1&e&&u.Kc(0,j,35,16,"div",0),2&e&&u.oc("ngIf",t.summary)},directives:[h.v,h.s,g.a,h.u,p.f],pipes:[h.f],styles:[".eg-bib-summary[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:.25rem .5rem}.jacket[_ngcontent-%COMP%]{padding:3px;width:100%}"]}),e})()},"9u+K":function(e,t,i){"use strict";i.d(t,"a",(function(){return ge}));var c=i("MZHd"),o=i("r2N+"),s=i("1kwX"),n=i("D6jH"),a=i("FO7Y"),r=i("/r9j"),d=i("FSVw"),l=i("r7vI"),b=i("E+BH"),f=i("GlPx"),u=i("6tXh"),h=i("sYwd"),g=i("fkVb"),p=i("fXoL"),m=i("ofXK"),x=i("tyNb"),R=i("1kSV"),v=i("3Pt+"),y=i("tNQm"),Q=i("TY/l"),C=i("rRT/"),L=i("/xpB"),T=i("36iw"),k=i("Vedm"),I=i("TxlL"),S=i("KBUj"),M=i("LZHW"),w=i("sieM"),F=i("9rfo"),$=i("ib0n"),O=i("LTyc"),z=i("wVJ/"),B=i("dpqa"),P=i("vG6Q"),_=i("G20A"),N=i("hWNP"),X=i("sGhd"),D=i("LyYn"),A=i("9Zsr"),V=i("t7hH"),E=i("eXX1"),K=i("gtj8"),q=i("QGNW"),j=i("2XLs"),U=i("RXDw"),H=i("ufrD"),W=i("xvdd"),Z=i("OxR8"),G=i("ayJW"),Y=i("e4JB"),J=i("1tmW"),ee=i("7w9P"),te=i("9emE"),ie=i("x6nW"),ce=i("o1RZ"),oe=i("3RDE"),se=i("Pf76"),ne=i("ItyU"),ae=i("+hKF"),re=i("VX9d"),de=i("Emlq"),le=i("Fbhp"),be=i("6Unn"),fe=i("7DyM"),ue=i("S3Is"),he=i("ZvpF");let ge=(()=>{class e{}return e.\u0275mod=p.Jb({type:e}),e.\u0275inj=p.Ib({factory:function(t){return new(t||e)},providers:[l.a],imports:[[c.a,o.a,g.a]]}),e})();p.Fc(u.a,[m.s,m.t,m.u,m.v,m.C,m.y,m.z,m.A,m.B,m.w,m.x,x.h,x.d,x.f,x.e,x.i,R.a,R.H,R.K,R.I,R.J,R.L,R.b,R.c,R.f,R.Q,R.P,R.e,R.S,R.g,R.i,R.j,R.r,R.k,R.l,R.m,R.p,R.o,R.n,R.z,R.v,R.u,R.w,R.x,R.y,R.A,R.B,R.C,R.D,R.E,R.F,R.G,R.M,R.O,R.R,R.X,R.Y,R.Z,R.ab,R.bb,R.q,R.W,R.T,R.U,R.V,v.J,v.y,v.I,v.c,v.z,v.C,v.a,v.F,v.G,v.B,v.t,v.u,v.E,v.o,v.n,v.A,v.b,v.d,v.w,v.x,v.v,y.a,v.h,v.k,v.i,v.l,v.f,Q.a,C.a,L.a,T.a,k.a,I.a,S.a,M.a,w.a,F.a,$.a,O.a,z.a,B.a,P.a,_.a,N.a,X.a,D.a,A.a,V.a,E.a,K.a,q.a,j.a,U.a,H.a,W.a,Z.a,G.a,Y.a,J.a,ee.a,te.a,ie.b,ce.a,oe.a,se.b,ne.a,ae.a,re.a,de.a,le.a,be.a,fe.a,ue.a,s.a,n.a,a.a,r.a,d.a,b.a,u.a,h.a,f.a],[m.b,m.J,m.r,m.m,m.G,m.g,m.E,m.H,m.d,m.f,m.k,m.l,m.n,he.b])},D6jH:function(e,t,i){"use strict";i.d(t,"a",(function(){return oe}));var c=i("pLZG"),o=i("wBwE"),s=i("Osig"),n=i("cm5s"),a=i("OsfI"),r=i("r7vI"),d=(i("DMNx"),i("GlPx")),l=i("sYwd"),b=i("fXoL"),f=i("ofXK"),u=i("TxlL"),h=i("E+BH"),g=i("/r9j"),p=i("3Pt+");const m=["authLinker"],x=["physCharDialog"];function R(e,t){1&e&&(b.Pb(0),b.Rb(1,"div",6),b.Rb(2,"div",7),b.Mb(3,"eg-progress-inline"),b.Qb(),b.Qb(),b.Ob())}const v=["fieldText",$localize`:␟91bbb166bdcc20c8d7eeb496d82f7854b536450d␟5744128525361483112:‡`],y=["ariaLabel",$localize`:␟41138b43267cd510d4b5ac1507cad04ec218d837␟6823827648744246189:Subfield Code`],Q=["ariaLabel",$localize`:␟b2734f0d3c3617777207c0e2e5d355e3902e61fd␟1333842008362847646:Subfield Value`];function C(e,t){if(1&e&&(b.Rb(0,"eg-marc-editable-content",8),b.Xb(1,v),b.Qb(),b.Rb(2,"eg-marc-editable-content",9),b.Xb(3,y),b.Qb(),b.Rb(4,"eg-marc-editable-content",10),b.Xb(5,Q),b.Qb()),2&e){const e=t.field,i=t.subfield,c=b.hc();b.xb(2),b.oc("context",c.context)("field",e)("subfield",i),b.xb(2),b.oc("context",c.context)("field",e)("subfield",i)}}const L=["title",$localize`:␟ac70bb23653a09d74c4caf25361eb4580626aa1b␟5004024729525105237:Create authority link`];function T(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",11),b.Xb(2,L),b.fc("click",(function(){b.Bc(e);const t=b.hc().field;return b.hc().openLinkerDialog(t)})),b.Rb(3,"span",12),b.Mc(4,"link"),b.Qb(),b.Qb(),b.Ob()}}const k=["title",$localize`:␟8db41801dc66039376b79473fe5a4a2e8724b643␟7716993534437171833:Authority Validation Succeeded`];function I(e,t){1&e&&(b.Rb(0,"span",16),b.Xb(1,k),b.Mc(2," check_circle_outline "),b.Qb())}const S=["title",$localize`:␟56f123885e44424ed43f3a1d406d321529a24480␟5166929054083210809:Authority Validation Failed`];function M(e,t){1&e&&(b.Rb(0,"span",17),b.Xb(1,S),b.Mc(2," error_outline "),b.Qb())}function w(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"span",13),b.Kc(2,I,3,0,"span",14),b.Kc(3,M,3,0,"span",15),b.Qb(),b.Ob()),2&e){const e=b.hc().field;b.xb(2),b.oc("ngIf",e.authValid),b.xb(1),b.oc("ngIf",!e.authValid)}}function F(e,t){if(1&e&&(b.Kc(0,T,5,0,"ng-container",0),b.Kc(1,w,4,2,"ng-container",0)),2&e){const e=t.field,i=b.hc();b.oc("ngIf","biblio"===i.context.recordType&&i.isControlledBibTag(e.tag)),b.xb(1),b.oc("ngIf",e.authChecked)}}var $;$=$localize`:␟85b79c9064aed1ead31ace985f31aa1363f6bdaf␟7911416166208830577:Help`;const O=["fieldText",$localize`:␟90e5e01a22344368573989899756bbe7c4f3dc8b␟4619055856043821945:LDR`],z=["ariaLabel",$localize`:␟314de06d6f64d39149e78e6d796585c0246fec0b␟1061297288634362831:Leader`];var B;function P(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",23),b.Rb(2,"button",22),b.fc("click",(function(){return b.Bc(e),b.hc(2).validate()})),b.Vb(3,B),b.Qb(),b.Qb(),b.Ob()}}function _(e,t){1&e&&(b.Rb(0,"div",37),b.Rb(1,"div",38),b.Rb(2,"ul"),b.Rb(3,"li"),b.Mc(4,"Undo: CTRL-z"),b.Qb(),b.Rb(5,"li"),b.Mc(6,"Redo: CTRL-y"),b.Qb(),b.Rb(7,"li"),b.Mc(8,"Add Row: CTRL+Enter"),b.Qb(),b.Rb(9,"li"),b.Mc(10,"Insert Row: CTRL+Shift+Enter"),b.Qb(),b.Qb(),b.Qb(),b.Rb(11,"div",38),b.Rb(12,"ul"),b.Rb(13,"li"),b.Mc(14,"Copy Current Row Above: CTRL+Up"),b.Qb(),b.Rb(15,"li"),b.Mc(16,"Copy Current Row Below: CTRL+Down"),b.Qb(),b.Rb(17,"li"),b.Mc(18,"Add Subfield: CTRL+D or CTRL+I"),b.Qb(),b.Rb(19,"li"),b.Mc(20,"Remove Row: CTRL+Del"),b.Qb(),b.Qb(),b.Qb(),b.Rb(21,"div",38),b.Rb(22,"ul"),b.Rb(23,"li"),b.Mc(24,"Remove Subfield: Shift+Del"),b.Qb(),b.Rb(25,"li"),b.Mc(26,"Create/Replace 006: Shift+F6"),b.Qb(),b.Rb(27,"li"),b.Mc(28,"Create/Replace 007: Shift+F7"),b.Qb(),b.Rb(29,"li"),b.Mc(30,"Create/Replace 008: Shift+F8"),b.Qb(),b.Qb(),b.Qb(),b.Qb())}B=$localize`:␟88cdc92c39ffe81c9102cf3582e5d9c9bb0c1911␟6057281094654962766:Validate`;const N=["ariaLabel",$localize`:␟fade6dfa87d06d7d358b74f8bf390255d41952a5␟5602962787483626268:Control Field Tag`],X=["ariaLabel",$localize`:␟dac6aaa1e160f3814388105080e624e46064e792␟9060332685197372803:Control Field Content`],D=["title",$localize`:␟1b812f258f094bd8d79f3efe202515b28d6dad98␟8360473245692254164:Open physical characteristics wizard`];function A(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"button",11),b.Xb(2,D),b.fc("click",(function(){b.Bc(e);const t=b.hc().$implicit;return b.hc(2).openPhysCharDialog(t)})),b.Rb(3,"span",12),b.Mc(4,"launch"),b.Qb(),b.Qb(),b.Ob()}}function V(e,t){if(1&e&&(b.Rb(0,"div",32),b.Rb(1,"eg-marc-editable-content",39),b.Xb(2,N),b.Qb(),b.Rb(3,"eg-marc-editable-content",40),b.Xb(4,X),b.Qb(),b.Kc(5,A,5,0,"ng-container",0),b.Qb()),2&e){const e=t.$implicit,i=b.hc(2);b.xb(1),b.oc("context",i.context)("field",e),b.xb(2),b.oc("context",i.context)("field",e),b.xb(2),b.oc("ngIf","007"===e.tag)}}const E=["ariaLabel",$localize`:␟d93822b6a4e74f3d45ccac7863272955e16f2631␟1678841244148166636:Data Field Tag`],K=["ariaLabel",$localize`:␟f5d5dce4debb2e1251fe2142509bf23d52610088␟6037445710772211166:Data Field Indicator 1`],q=["ariaLabel",$localize`:␟4701d7cbf67e0a445cf311f319c4572a7bace807␟5781296299162472251:Data Field Indicator 2`];function j(e,t){1&e&&b.Nb(0)}function U(e,t){1&e&&b.Nb(0)}const H=function(e){return{field:e}};function W(e,t){if(1&e&&(b.Pb(0),b.Kc(1,U,1,0,"ng-container",43),b.Ob()),2&e){const e=b.hc(3).$implicit;b.hc(2);const t=b.zc(8);b.xb(1),b.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",b.uc(2,H,e))}}const Z=function(e,t){return{field:e,subfield:t}};function G(e,t){if(1&e&&(b.Pb(0),b.Kc(1,j,1,0,"ng-container",43),b.Kc(2,W,2,4,"ng-container",0),b.Ob()),2&e){const e=t.$implicit,i=t.last,c=b.hc(2).$implicit;b.hc(2);const o=b.zc(6);b.xb(1),b.oc("ngTemplateOutlet",o)("ngTemplateOutletContext",b.vc(3,Z,c,e)),b.xb(1),b.oc("ngIf",i)}}function Y(e,t){if(1&e&&(b.Pb(0),b.Kc(1,G,3,6,"ng-container",36),b.Ob()),2&e){const e=b.hc().$implicit;b.xb(1),b.oc("ngForOf",e.subfields)}}function J(e,t){1&e&&b.Nb(0)}function ee(e,t){if(1&e&&(b.Rb(0,"div",45),b.Mb(1,"eg-marc-editable-content",46),b.Kc(2,J,1,0,"ng-container",43),b.Qb()),2&e){const e=t.$implicit,i=b.hc(2).$implicit;b.hc(2);const c=b.zc(6);b.xb(2),b.oc("ngTemplateOutlet",c)("ngTemplateOutletContext",b.vc(2,Z,i,e))}}function te(e,t){if(1&e&&(b.Pb(0),b.Kc(1,ee,3,5,"div",44),b.Ob()),2&e){const e=b.hc().$implicit;b.xb(1),b.oc("ngForOf",e.subfields)}}function ie(e,t){if(1&e&&(b.Pb(0),b.Rb(1,"div",32),b.Rb(2,"eg-marc-editable-content",39),b.Xb(3,E),b.Qb(),b.Rb(4,"eg-marc-editable-content",41),b.Xb(5,K),b.Qb(),b.Rb(6,"eg-marc-editable-content",42),b.Xb(7,q),b.Qb(),b.Kc(8,Y,2,1,"ng-container",0),b.Qb(),b.Kc(9,te,2,1,"ng-container",0),b.Ob()),2&e){const e=t.$implicit,i=b.hc(2);b.xb(2),b.oc("context",i.context)("field",e),b.xb(2),b.oc("context",i.context)("field",e),b.xb(2),b.oc("context",i.context)("field",e),b.xb(2),b.oc("ngIf",!i.stackSubfields),b.xb(1),b.oc("ngIf",i.stackSubfields)}}function ce(e,t){if(1&e){const e=b.Sb();b.Pb(0),b.Rb(1,"div",18),b.fc("contextmenu",(function(t){return b.Bc(e),t.preventDefault()})),b.Rb(2,"div",19),b.Rb(3,"div",20),b.Mb(4,"eg-fixed-fields-editor",1),b.Qb(),b.Rb(5,"div",21),b.Rb(6,"div"),b.Rb(7,"button",22),b.fc("click",(function(){b.Bc(e);const t=b.hc();return t.showHelp=!t.showHelp})),b.Vb(8,$),b.Qb(),b.Qb(),b.Kc(9,P,4,0,"ng-container",0),b.Rb(10,"div",23),b.Rb(11,"button",24),b.fc("click",(function(){return b.Bc(e),b.hc().undo()})),b.Mc(12," Undo "),b.Rb(13,"span",25),b.Mc(14),b.Qb(),b.Qb(),b.Rb(15,"button",26),b.fc("click",(function(){return b.Bc(e),b.hc().redo()})),b.Mc(16," Redo "),b.Rb(17,"span",25),b.Mc(18),b.Qb(),b.Qb(),b.Qb(),b.Rb(19,"div",23),b.Rb(20,"div",27),b.Rb(21,"input",28),b.fc("change",(function(){return b.Bc(e),b.hc().stackSubfieldsChange()}))("ngModelChange",(function(t){return b.Bc(e),b.hc().stackSubfields=t})),b.Qb(),b.Rb(22,"label",29),b.Mc(23," Stack Subfields "),b.Qb(),b.Qb(),b.Qb(),b.Qb(),b.Mb(24,"div",30),b.Qb(),b.Kc(25,_,31,0,"div",31),b.Rb(26,"div",32),b.Rb(27,"eg-marc-editable-content",33),b.Xb(28,O),b.Qb(),b.Rb(29,"eg-marc-editable-content",34),b.Xb(30,z),b.Qb(),b.Qb(),b.Kc(31,V,6,5,"div",35),b.Kc(32,ie,10,8,"ng-container",36),b.Qb(),b.Ob()}if(2&e){const e=b.hc();b.xb(4),b.oc("context",e.context),b.xb(5),b.oc("ngIf","biblio"===e.context.recordType),b.xb(2),b.oc("disabled",e.undoCount()<1),b.xb(3),b.Nc(e.undoCount()),b.xb(1),b.oc("disabled",e.redoCount()<1),b.xb(3),b.Nc(e.redoCount()),b.xb(3),b.qc("id","stack-subfields-",e.randId,""),b.oc("ngModel",e.stackSubfields),b.xb(1),b.qc("for","stack-subfields-",e.randId,""),b.xb(3),b.oc("ngIf",e.showHelp),b.xb(2),b.oc("context",e.context),b.xb(2),b.oc("context",e.context),b.xb(2),b.oc("ngForOf",e.controlFields()),b.xb(1),b.oc("ngForOf",e.dataFields())}}let oe=(()=>{class e{constructor(e,t,i,c,o){this.idl=e,this.net=t,this.org=i,this.store=c,this.tagTable=o,this.randId=Math.floor(1e5*Math.random()),this.controlledBibTags=[]}get record(){return this.context.record}ngOnInit(){this.store.getItem("cat.marcedit.stack_subfields").then(e=>this.stackSubfields=e),this.init().then(e=>this.context.recordChange.subscribe(e=>this.init())),this.record.fixedFieldChange.pipe(Object(c.a)(e=>"Type"===e)).subscribe(e=>this.init())}init(){return this.dataLoaded=!1,this.record?Promise.all([this.tagTable.loadTags({marcRecordType:this.context.recordType,ffType:this.record.recordType()}).then(e=>this.context.tagTable=e),this.tagTable.getControlledBibTags().then(e=>this.controlledBibTags=e),this.fetchSettings()]).then(e=>setTimeout(()=>this.dataLoaded=!0)):Promise.resolve()}fetchSettings(){return this.org.settings(["cat.marc_control_number_identifier"])}stackSubfieldsChange(){this.stackSubfields?this.store.setItem("cat.marcedit.stack_subfields",!0):this.store.removeItem("cat.marcedit.stack_subfields")}undoCount(){return this.context.undoCount()}redoCount(){return this.context.redoCount()}undo(){this.context.requestUndo()}redo(){this.context.requestRedo()}controlFields(){return this.record.fields.filter(e=>e.isCtrlField)}dataFields(){return this.record.fields.filter(e=>!e.isCtrlField)}validate(){const e=[];this.record.fields.filter(e=>this.isControlledBibTag(e.tag)).forEach(t=>{t.authValid=!1,e.push({id:t.fieldId,tag:t.tag,ind1:t.ind1,ind2:t.ind2,subfields:t.subfields.map(e=>[e[0],e[1]])})}),this.net.request("open-ils.cat","open-ils.cat.authority.validate.bib_field",e).subscribe(e=>{const t=this.record.fields.filter(t=>t.fieldId===+e.id)[0];t.authChecked=!0,t.authValid=e.valid})}isControlledBibTag(e){return this.controlledBibTags&&this.controlledBibTags.includes(e)}openLinkerDialog(e){this.authLinker.bibField=e,this.authLinker.open({size:"xl"}).subscribe(t=>{if(!t)return;const i=this.record.newField(t);this.context.insertField(e,i),this.context.deleteField(e),this.context.setUndoGroupSize(2)})}openPhysCharDialog(e){this.physCharDialog.fieldData=e.data,this.physCharDialog.open({size:"lg"}).subscribe(t=>{t&&this.context.requestFieldFocus({fieldId:e.fieldId,target:"cfld",newText:t})})}}return e.\u0275fac=function(t){return new(t||e)(b.Lb(o.a),b.Lb(s.b),b.Lb(n.a),b.Lb(a.a),b.Lb(r.a))},e.\u0275cmp=b.Fb({type:e,selectors:[["eg-marc-rich-editor"]],viewQuery:function(e,t){var i;1&e&&(b.Sc(m,!0),b.Sc(x,!0)),2&e&&(b.yc(i=b.gc())&&(t.authLinker=i.first),b.yc(i=b.gc())&&(t.physCharDialog=i.first))},inputs:{context:"context"},decls:10,vars:3,consts:[[4,"ngIf"],[3,"context"],["authLinker",""],["physCharDialog",""],["subfieldChunk",""],["postSubfieldsChunk",""],[1,"row","mt-5"],[1,"offset-lg-3","col-lg-6"],["moreClasses","sf-delimiter border-right-0 bg-transparent p-1 pr-0",6,"fieldText"],["fieldType","sfc","moreClasses","sf-code border-left-0 p-1 pl-0",3,"context","field","subfield",6,"ariaLabel"],["fieldType","sfv","moreClasses","p-1 pt-2",3,"context","field","subfield",6,"ariaLabel"],[1,"btn","btn-sm","btn-outline-info","link-button",3,"click",6,"title"],[1,"material-icons"],[1,"pl-2","pt-2"],["class","material-icons label-with-material-icon text-success",4,"ngIf",6,"title"],["class","material-icons label-with-material-icon text-danger",4,"ngIf",6,"title"],[1,"material-icons","label-with-material-icon","text-success",6,"title"],[1,"material-icons","label-with-material-icon","text-danger",6,"title"],[1,"mt-3","text-monospace",3,"contextmenu"],[1,"row","pb-2","mb-2","border-bottom","border-muted"],[1,"col-lg-9","fixed-fields-container"],[1,"col-lg-3"],[1,"btn","btn-outline-dark",3,"click"],[1,"mt-2"],["type","button",1,"btn","btn-outline-info",3,"disabled","click"],[1,"badge","badge-info"],["type","button",1,"btn","btn-outline-info","ml-2",3,"disabled","click"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"ngModel","id","change","ngModelChange"],[1,"form-check-label",3,"for"],[1,"col-lg-1"],["class","row m-2",4,"ngIf"],[1,"row","pt-0","pb-0","pl-3"],["moreClasses","p-1",3,"context",6,"fieldText"],["fieldType","ldr","moreClasses","p-1 pr-2",3,"context",6,"ariaLabel"],["class","row pt-0 pb-0 pl-3",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"row","m-2"],[1,"col-lg-4"],["fieldType","tag","moreClasses","p-1",3,"context","field",6,"ariaLabel"],["fieldType","cfld","moreClasses","p-1",3,"context","field",6,"ariaLabel"],["fieldType","ind1","moreClasses","p-1",3,"context","field",6,"ariaLabel"],["fieldType","ind2","moreClasses","p-1",3,"context","field",6,"ariaLabel"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","form-inline",4,"ngFor","ngForOf"],[1,"form-inline"],["fieldText","   ","moreClasses","p-1 invisible"]],template:function(e,t){1&e&&(b.Kc(0,R,4,0,"ng-container",0),b.Mb(1,"eg-authority-linking-dialog",1,2),b.Mb(3,"eg-phys-char-dialog",null,3),b.Kc(5,C,6,6,"ng-template",null,4,b.Lc),b.Kc(7,F,2,2,"ng-template",null,5,b.Lc),b.Kc(9,ce,33,14,"ng-container",0)),2&e&&(b.oc("ngIf",!t.dataLoaded),b.xb(1),b.oc("context",t.context),b.xb(8),b.oc("ngIf",t.dataLoaded))},directives:[f.v,d.a,l.a,u.a,h.a,g.a,p.a,p.t,p.w,f.u,f.C],styles:[".link-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:17px;display:inline-flex;vertical-align:middle;align-items:center}"]}),e})()},DMNx:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));var c=i("fXoL");class o{}class s extends o{}class n extends o{}class a{constructor(){this.recordType="biblio",this.lastFocused=null,this.undoStack=[],this.redoStack=[],this.recordChange=new c.n,this.fieldFocusRequest=new c.n,this.textUndoRedoRequest=new c.n}set record(e){e!==this._record&&(this._record=e,this._record.stampFieldIds(),this.recordChange.emit(e))}get record(){return this._record}requestFieldFocus(e){e&&setTimeout(()=>this.fieldFocusRequest.emit(e))}resetUndos(){this.undoStack=[],this.redoStack=[]}requestUndo(){let e=null;do{const t=this.undoStack.shift();if(!t)return;null===e&&(e=t.groupSize||1),e--,t.isRedo=!1,this.distributeUndoRedo(t)}while(e>0)}requestRedo(){let e=null;do{const t=this.redoStack.shift();if(!t)return;null===e&&(e=t.groupSize||1),e--,t.isRedo=!0,this.distributeUndoRedo(t)}while(e>0)}stackCount(e){let t=0,i=0;return e.forEach(e=>{if(e.groupSize>1){if(i)return;i=1}else i=0;t++}),t}undoCount(){return this.stackCount(this.undoStack)}redoCount(){return this.stackCount(this.redoStack)}setUndoGroupSize(e){for(let t=0;t<e;t++)this.undoStack[t]&&(this.undoStack[t].groupSize=e)}distributeUndoRedo(e){e instanceof s?this.textUndoRedoRequest.emit(e):this.handleStructuralUndoRedo(e)}addToUndoStack(e){this.changesPending=!0,this.undoStack.unshift(e)}handleStructuralUndoRedo(e){if(e.wasAddition){if(e.subfield){const t=e.subfield[2]-1;e.field.deleteExactSubfields(e.subfield),this.focusSubfield(e.field,t)}else this.record.deleteFields(e.field);this.requestFieldFocus(e.prevFocus)}else{if(e.subfield)this.insertSubfield(e.field,e.subfield,!0),this.focusSubfield(e.field,e.subfield[2]);else{const t=e.position.fieldId,i=this.record.getField(e.prevPosition.fieldId);this.record.insertFieldsAfter(i,e.field),e.field.fieldId=t,this.requestFieldFocus(e.position)}e.prevFocus=this.lastFocused}e.wasAddition=!e.wasAddition,(e.isRedo?this.undoStack:this.redoStack).unshift(e)}trackStructuralUndo(e,t,i){this.redoStack=[];const c={fieldId:e.fieldId,target:"tag"};let o=null;if(i)c.target="sfc",c.sfOffset=i[2];else{const t=this.record.getPreviousField(e.fieldId);t&&(o={fieldId:t.fieldId,target:"tag"})}const s=new n;s.field=e,s.subfield=i,s.wasAddition=t,s.position=c,s.prevPosition=o,s.prevFocus=this.lastFocused,this.addToUndoStack(s)}deleteField(e){this.trackStructuralUndo(e,!1),this.focusNextTag(e)||this.focusPreviousTag(e),this.record.deleteFields(e)}add00X(e){const t=this.record.newField({tag:e,data:"                                        "});this.record.insertOrderedFields(t),this.trackStructuralUndo(t,!0),this.focusTag(t)}insertReplace008(){[].concat(this.record.field("008",!0)).forEach(e=>{this.trackStructuralUndo(e,!1),this.record.deleteFields(e)});const e=this.record.newField({tag:"008",data:this.record.generate008()});this.record.insertOrderedFields(e),this.trackStructuralUndo(e,!0),this.focusTag(e)}insertStubField(e,t){const i=this.record.newField({tag:"999",subfields:[[" ","",0]]});this.insertField(e,i,t)}insertField(e,t,i){i?(this.record.insertFieldsBefore(e,t),this.focusPreviousTag(e)):(this.record.insertFieldsAfter(e,t),this.focusNextTag(e)),this.trackStructuralUndo(t,!0)}insertSubfield(e,t,i){const c=t[2];e.subfields.forEach(e=>{e[2]>=c&&e[2]++}),e.subfields.splice(c,0,t),i||(this.focusSubfield(e,c),this.trackStructuralUndo(e,!0,t))}insertStubSubfield(e,t){this.insertSubfield(e,[" ","",t])}focusSubfield(e,t){const i={fieldId:e.fieldId,target:"tag"};t>=0&&(i.target="sfc",i.sfOffset=t),this.requestFieldFocus(i)}deleteSubfield(e,t){const i=t[2]-1;this.trackStructuralUndo(e,!1,t),e.deleteExactSubfields(t),this.focusSubfield(e,i)}focusTag(e){this.requestFieldFocus({fieldId:e.fieldId,target:"tag"})}focusNextTag(e){const t=this.record.getNextField(e.fieldId);return!!t&&(this.focusTag(t),!0)}focusPreviousTag(e){const t=this.record.getPreviousField(e.fieldId);return!!t&&(this.focusTag(t),!0)}}},"E+BH":function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var c=i("pLZG"),o=i("DMNx"),s=i("tNQm"),n=i("fXoL"),a=i("ofXK"),r=i("G20A"),d=i("3Pt+");const l=["add006"],b=["add007"],f=["add008"],u=["insertBefore"],h=["insertAfter"],g=["deleteField"],p=["text",$localize`:␟4a5c847954af1607d08410abd749d4f1eef66e68␟6491210522911115323:Add 006`],m=["text",$localize`:␟694b5579f2a0892d5e1868e05337dd461e08934e␟6827224313706518299:Add 007`],x=["text",$localize`:␟438f1c11f010aaf97d656ea25843cab1a95941f4␟793384322947647550:Add/Replace 008`],R=["text",$localize`:␟96488867e4fe2d5b534a0259088908d65682d0d6␟2713159344643324913:Insert Field Before`],v=["text",$localize`:␟b14adbe6a771c451c969d8fb0600431ef56d0257␟3429281710145350758:Insert Field After`],y=["text",$localize`:␟aac8c1d980fd28011705f845572dc6c1914af439␟5220752601423905433:Delete Field`],Q=function(e){return{"auth-invalid":e}};function C(e,t){if(1&e){const e=n.Sb();n.Pb(0),n.Rb(1,"div",8),n.fc("menuItemSelected",(function(t){return n.Bc(e),n.hc().contextMenuChange(t.value)}))("keydown",(function(t){return n.Bc(e),n.hc().inputKeyDown(t)}))("focus",(function(){return n.Bc(e),n.hc().selectText()}))("blur",(function(){return n.Bc(e),n.hc().inputBlurred()}))("input",(function(){return n.Bc(e),n.hc().bigTextValueChange()})),n.Qb(),n.Ob()}if(2&e){const e=n.hc();n.xb(1),n.Bb("d-inline-block text-dark text-break ",e.moreClasses,""),n.pc("id",e.randId),n.oc("ngClass",n.uc(8,Q,e.isAuthInvalid()))("egContextMenu",e.contextMenuEntries()),n.yb("tabindex",e.fieldText?-1:"0")("aria-label",e.ariaLabel)}}function L(e,t){if(1&e){const e=n.Sb();n.Pb(0),n.Rb(1,"input",9),n.fc("menuItemSelected",(function(t){return n.Bc(e),n.hc().contextMenuChange(t.value)}))("keydown",(function(t){return n.Bc(e),n.hc().inputKeyDown(t)}))("focus",(function(){return n.Bc(e),n.hc().selectText()}))("blur",(function(){return n.Bc(e),n.hc().inputBlurred()}))("ngModelChange",(function(t){return n.Bc(e),n.hc().setContent(t)})),n.Qb(),n.Ob()}if(2&e){const e=n.hc();n.xb(1),n.Bb("text-dark rounded-0 form-control ",e.moreClasses,""),n.pc("id",e.randId),n.oc("ngClass",n.uc(12,Q,e.isAuthInvalid()))("size",e.inputSize())("maxlength",e.maxLength||"")("disabled",e.fieldText)("egContextMenu",e.contextMenuEntries())("ngModel",e.getContent()),n.yb("tabindex",e.fieldText?-1:"0")("aria-label",e.ariaLabel)}}let T=(()=>{class e{constructor(e){this.renderer=e,this.fieldType=null,this.fieldText=null,this.bigText=!1,this.randId=Math.floor(1e5*Math.random()),this.maxLength=null,this.ffValues=[],this.tagMenuEntries=[]}get record(){return this.context.record}tt(){return this.context.tagTable}ngOnInit(){this.setupFieldType()}ngOnDestroy(){this.focusSub&&this.focusSub.unsubscribe(),this.undoRedoSub&&this.undoRedoSub.unsubscribe()}watchForFocusRequests(){this.focusSub=this.context.fieldFocusRequest.pipe(Object(c.a)(e=>this.focusRequestIsMe(e))).subscribe(e=>this.selectText(e))}watchForUndoRedoRequests(){this.undoRedoSub=this.context.textUndoRedoRequest.pipe(Object(c.a)(e=>this.focusRequestIsMe(e.position))).subscribe(e=>this.processUndoRedo(e))}focusRequestIsMe(e){if(e.target!==this.fieldType)return!1;if(this.field){if(e.fieldId!==this.field.fieldId)return!1}else{if("ldr"===e.target)return this.isLeader;if("ffld"===e.target&&e.ffCode!==this.fixedFieldCode)return!1}return void 0===e.sfOffset||e.sfOffset===this.subfield[2]}selectText(e){this.bigText?this.focusBigText():this.editInput.select(),e?e.newText&&this.setContent(e.newText):e={fieldId:this.field?this.field.fieldId:-1,target:this.fieldType,sfOffset:this.subfield?this.subfield[2]:void 0,ffCode:this.fixedFieldCode},this.context.lastFocused=e}setupFieldType(){const e=this.getContent();switch(this.undoBackToText=e,this.fieldType){case"ldr":this.isLeader=!0,e&&(this.maxLength=e.length),this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;case"tag":this.maxLength=3,this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;case"cfld":this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;case"ffld":this.applyFFOptions(),this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;case"ind1":case"ind2":case"sfc":this.maxLength=1,this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;case"sfv":this.bigText=!0,this.watchForFocusRequests(),this.watchForUndoRedoRequests();break;default:this.fieldText&&(this.maxLength=this.fieldText.length)}}applyFFOptions(){return this.tt().getFfFieldMeta(this.fixedFieldCode).then(e=>{e&&(this.maxLength=e.length||1)})}contextMenuEntries(){if(!this.isLeader){switch(this.fieldType){case"tag":return this.tagContextMenuEntries();case"sfc":return this.tt().getSubfieldCodes(this.field.tag);case"sfv":return this.tt().getSubfieldValues(this.field.tag,this.subfield[0]);case"ind1":case"ind2":return this.tt().getIndicatorValues(this.field.tag,this.fieldType);case"ffld":return this.tt().getFfValues(this.fixedFieldCode)}return null}}tagContextMenuEntries(){return this.tagMenuEntries.length>0||!this.add006Str||(this.tagMenuEntries.push({label:this.add006Str.text,value:"_add006"},{label:this.add007Str.text,value:"_add007"},{label:this.add008Str.text,value:"_add008"}),this.field.isCtrlField||this.tagMenuEntries.push({label:this.insertAfterStr.text,value:"_insertAfter"},{label:this.insertBeforeStr.text,value:"_insertBefore"}),this.tagMenuEntries.push({label:this.deleteFieldStr.text,value:"_deleteField"},{divider:!0}),this.tt().getFieldTags().forEach(e=>this.tagMenuEntries.push(e))),this.tagMenuEntries}getContent(){if(this.fieldText)return this.fieldText;switch(this.fieldType){case"ldr":return this.record.leader;case"cfld":return this.field.data;case"tag":return this.field.tag;case"sfc":return this.subfield[0];case"sfv":return this.subfield[1];case"ind1":return this.field.ind1;case"ind2":return this.field.ind2;case"ffld":return void 0!==this.ffValue&&this.context.lastFocused&&this.focusRequestIsMe(this.context.lastFocused)||(this.ffValue=this.record.extractFixedField(this.fixedFieldCode)),this.ffValue}return"X"}setContent(e,t,i){if(!this.fieldText){switch(this.fieldType){case"ldr":this.record.leader=e;break;case"cfld":this.field.data=e;break;case"tag":this.field.tag=e;break;case"sfc":this.subfield[0]=e;break;case"sfv":this.subfield[1]=e;break;case"ind1":this.field.ind1=e;break;case"ind2":this.field.ind2=e;break;case"ffld":this.ffValue=e,this.record.setFixedField(this.fixedFieldCode,e)}t&&this.bigText&&(this.editInput.innerText=e),i||this.trackTextChangeForUndo(e)}}trackTextChangeForUndo(e){this.context.redoStack=[];const t=this.context.undoStack[0];if(t&&t instanceof o.b&&t.textContent===this.undoBackToText&&this.focusRequestIsMe(t.position))return;const i=new o.b;i.position=this.context.lastFocused,i.textContent=this.undoBackToText,this.context.addToUndoStack(i)}processUndoRedo(e){const t=this.getContent();this.setContent(e.textContent,!0,!0),e.textContent=t,(e.isRedo?this.context.undoStack:this.context.redoStack).unshift(e)}inputBlurred(){this.undoBackToText=this.getContent()}bigTextValueChange(){this.setContent(this.editInput.innerText)}ngAfterViewInit(){this.editInput=this.renderer.selectRootElement(`[id='${this.randId}']`),this.editInput.innerText=this.getContent()}inputSize(){return this.maxLength?this.maxLength+1:1.1*Math.max(2,(this.getContent()||"").length)}focusBigText(){const e=this.editInput.firstChild;if(!e)return;const t=document.createRange();t.setStart(e,0),t.setEnd(e,e.length);const i=window.getSelection();i.removeAllRanges(),i.addRange(t)}inputKeyDown(e){switch(e.key){case"y":return void(e.ctrlKey&&(this.context.requestRedo(),e.preventDefault()));case"z":return void(e.ctrlKey&&(this.context.requestUndo(),e.preventDefault()));case"F6":return void(e.shiftKey&&(this.context.add00X("006"),e.preventDefault(),e.stopPropagation()));case"F7":return void(e.shiftKey&&(this.context.add00X("007"),e.preventDefault(),e.stopPropagation()));case"F8":return void(e.shiftKey&&(this.context.insertReplace008(),e.preventDefault(),e.stopPropagation()))}if("ldr"!==this.fieldType&&"ffld"!==this.fieldType)switch(e.key){case"Enter":e.ctrlKey&&this.context.insertStubField(this.field,e.shiftKey),e.preventDefault();break;case"Delete":e.ctrlKey?(this.context.deleteField(this.field),e.preventDefault()):e.shiftKey&&(this.subfield&&this.context.deleteSubfield(this.field,this.subfield),e.preventDefault());break;case"ArrowDown":e.ctrlKey?this.context.insertField(this.field,this.record.cloneField(this.field)):this.context.focusNextTag(this.field),e.preventDefault();break;case"ArrowUp":e.ctrlKey?this.context.insertField(this.field,this.record.cloneField(this.field),!0):this.context.focusPreviousTag(this.field),e.preventDefault();break;case"d":case"i":e.ctrlKey&&(this.context.insertStubSubfield(this.field,this.subfield?this.subfield[2]+1:0),e.preventDefault())}}insertField(e){const t=this.record.newField({tag:"999",subfields:[[" ","",0]]});e?this.record.insertFieldsBefore(this.field,t):this.record.insertFieldsAfter(this.field,t),this.context.requestFieldFocus({fieldId:t.fieldId,target:"tag"})}deleteField(){this.context.focusNextTag(this.field)||this.context.focusPreviousTag(this.field),this.record.deleteFields(this.field)}deleteSubfield(){const e=this.subfield[2]-1;this.field.deleteExactSubfields(this.subfield);const t={fieldId:this.field.fieldId,target:"tag"};e>=0&&(t.target="sfv",t.sfOffset=e),this.context.requestFieldFocus(t)}contextMenuChange(e){switch(e){case"_add006":return this.context.add00X("006");case"_add007":return this.context.add00X("007");case"_add008":return this.context.insertReplace008();case"_insertBefore":return this.context.insertStubField(this.field,!0);case"_insertAfter":return this.context.insertStubField(this.field);case"_deleteField":return this.context.deleteField(this.field)}this.setContent(e,!0),this.context.requestFieldFocus(this.context.lastFocused)}isAuthInvalid(){return"sfv"===this.fieldType&&this.field.authChecked&&!this.field.authValid}isAuthValid(){return"sfv"===this.fieldType&&this.field.authChecked&&this.field.authValid}isLastSubfieldValue(){if("sfv"===this.fieldType){const e=this.subfield[2];for(let t=0;t<this.field.subfields.length;t++)if(t>e)return!1;return!0}return!1}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(n.D))},e.\u0275cmp=n.Fb({type:e,selectors:[["eg-marc-editable-content"]],viewQuery:function(e,t){var i;1&e&&(n.Sc(l,!0),n.Sc(b,!0),n.Sc(f,!0),n.Sc(u,!0),n.Sc(h,!0),n.Sc(g,!0)),2&e&&(n.yc(i=n.gc())&&(t.add006Str=i.first),n.yc(i=n.gc())&&(t.add007Str=i.first),n.yc(i=n.gc())&&(t.add008Str=i.first),n.yc(i=n.gc())&&(t.insertBeforeStr=i.first),n.yc(i=n.gc())&&(t.insertAfterStr=i.first),n.yc(i=n.gc())&&(t.deleteFieldStr=i.first))},inputs:{context:"context",field:"field",fieldType:"fieldType",fieldText:"fieldText",subfield:"subfield",fixedFieldCode:"fixedFieldCode",moreClasses:"moreClasses",ariaLabel:"ariaLabel"},decls:20,vars:2,consts:[[6,"text"],["add006",""],["add007",""],["add008",""],["insertBefore",""],["insertAfter",""],["deleteField",""],[4,"ngIf"],["contenteditable","","spellcheck","false",3,"id","ngClass","egContextMenu","menuItemSelected","keydown","focus","blur","input"],["spellcheck","false",3,"id","ngClass","size","maxlength","disabled","egContextMenu","ngModel","menuItemSelected","keydown","focus","blur","ngModelChange"]],template:function(e,t){1&e&&(n.Rb(0,"eg-string",0,1),n.Xb(2,p),n.Qb(),n.Rb(3,"eg-string",0,2),n.Xb(5,m),n.Qb(),n.Rb(6,"eg-string",0,3),n.Xb(8,x),n.Qb(),n.Rb(9,"eg-string",0,4),n.Xb(11,R),n.Qb(),n.Rb(12,"eg-string",0,5),n.Xb(14,v),n.Qb(),n.Rb(15,"eg-string",0,6),n.Xb(17,y),n.Qb(),n.Kc(18,C,2,10,"ng-container",7),n.Kc(19,L,2,14,"ng-container",7)),2&e&&(n.xb(18),n.oc("ngIf",t.bigText),n.xb(1),n.oc("ngIf",!t.bigText))},directives:[s.a,a.v,a.s,r.a,d.c,d.n,d.t,d.w],styles:["div[contenteditable][_ngcontent-%COMP%]{min-width:2em;border:1px solid #ced4da;min-height:calc(1.5em + .75rem + 2px)}.sf-delimiter[_ngcontent-%COMP%]{margin-right:-.5rem}.sf-code[_ngcontent-%COMP%], .sf-delimiter[_ngcontent-%COMP%]{color:#00f!important}.auth-invalid[_ngcontent-%COMP%]{color:red!important}"]}),e})()},Emlq:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var c=i("eIep"),o=i("vkgz"),s=i("lJxs"),n=i("iA0r"),a=i("YRS1"),r=i("rRT/"),d=i("tNQm"),l=i("fXoL"),b=i("1kSV"),f=i("3Pt+"),u=i("ofXK"),h=function(e,t,i,c){return new(i||(i=Promise))((function(o,s){function n(e){try{r(c.next(e))}catch(t){s(t)}}function a(e){try{r(c.throw(e))}catch(t){s(t)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}r((c=c.apply(e,t||[])).next())}))};const g=["successMsg"],p=["errorMsg"],m=["text",$localize`:␟b3c11c3d7789347b548c71d5fe9bfe1f9f4f7f4b␟668956494726759030:Successfully Replaced Barcode`],x=["text",$localize`:␟a49fddb9d9271970c762d3a9a94a22ae46108a10␟5643255618102971275:Failed To Replace Barcode`];var R;R=$localize`:␟5d064d7a5fc0063f499794c5ce5e348e76cd771d␟1878144846246059865:Replace Item Barcode`;const v=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var y,Q,C,L,T;function k(e,t){if(1&e&&(l.Rb(0,"div",20),l.Rb(1,"div",21),l.bc(2,T),l.Mb(3,"span",22),l.Yb(),l.Qb(),l.Qb()),2&e){const e=l.hc(2);l.xb(3),l.Zb(e.newBarcode),l.Wb(2)}}function I(e,t){if(1&e){const e=l.Sb();l.Rb(0,"div",4),l.Rb(1,"h4",5),l.Rb(2,"span"),l.Vb(3,R),l.Qb(),l.Qb(),l.Rb(4,"button",6),l.Xb(5,v),l.fc("click",(function(){return l.Bc(e),l.hc().close()})),l.Rb(6,"span",7),l.Mc(7,"\xd7"),l.Qb(),l.Qb(),l.Qb(),l.Rb(8,"div",8),l.Rb(9,"div",9),l.Rb(10,"div",10),l.Vb(11,y),l.Qb(),l.Rb(12,"div",11),l.Mc(13),l.Qb(),l.Qb(),l.Rb(14,"div",12),l.Rb(15,"div",10),l.bc(16,Q),l.Mb(17,"label",13),l.Yb(),l.Qb(),l.Rb(18,"div",14),l.Rb(19,"input",15),l.fc("ngModelChange",(function(t){return l.Bc(e),l.hc().newBarcode=t}))("keyup",(function(){return l.Bc(e),l.hc().barcodeExists=!1})),l.Qb(),l.Qb(),l.Qb(),l.Kc(20,k,4,1,"div",16),l.Qb(),l.Rb(21,"div",17),l.Pb(22),l.Rb(23,"button",18),l.fc("click",(function(){return l.Bc(e),l.hc().close()})),l.Vb(24,C),l.Qb(),l.Rb(25,"button",19),l.fc("click",(function(){return l.Bc(e),l.hc().replaceOneBarcode()})),l.Vb(26,L),l.Qb(),l.Ob(),l.Qb()}if(2&e){const e=l.hc();l.xb(13),l.Nc(e.copy.barcode()),l.xb(6),l.oc("required",!0)("ngModel",e.newBarcode),l.xb(1),l.oc("ngIf",e.barcodeExists),l.xb(5),l.oc("disabled",!e.newBarcode)}}y=$localize`:␟b9576c74fe0d87183edc10ff79185fbc65975156␟3975362787622028221:Replacing barcode`,Q=$localize`:␟da730962868808ce6e8d440d3d58d378ae444f29␟2098672066866212040:${"\ufffd#17\ufffd"}:START_TAG_LABEL:New Barcode:${"\ufffd/#17\ufffd"}:CLOSE_TAG_LABEL:`,C=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,L=$localize`:␟4518ce77109ada868298836a1b90b0f0d3850371␟1053194947439463984: Replace Barcode `,T=$localize`:␟f6880b32b73d0ece09bfad0c13d009e37e76c5ec␟6422012140246080538: Barcode ${"\ufffd#3\ufffd"}:START_TAG_SPAN:${"\ufffd0\ufffd"}:INTERPOLATION:${"\ufffd/#3\ufffd"}:CLOSE_TAG_SPAN: is already in use. `;let S=(()=>{class e extends r.a{constructor(e,t,i,c){super(e),this.modal=e,this.toast=t,this.pcrud=i,this.renderer=c}ngOnInit(){}open(e){return this.ids=[].concat(this.copyIds),this.numSucceeded=0,this.numFailed=0,this.getNextCopy().pipe(Object(c.a)(()=>super.open(e)),Object(o.a)(()=>this.renderer.selectRootElement("#new-barcode-input").focus()))}getNextCopy(){0===this.ids.length&&this.close(this.numSucceeded>0),this.newBarcode="";const e=this.ids.pop();return this.pcrud.retrieve("acp",e).pipe(Object(s.a)(e=>this.copy=e))}replaceOneBarcode(){return h(this,void 0,void 0,(function*(){return this.barcodeExists=!1,this.pcrud.search("acp",{deleted:"f",barcode:this.newBarcode}).toPromise().then(e=>h(this,void 0,void 0,(function*(){e?this.barcodeExists=!0:(this.copy.barcode(this.newBarcode),this.pcrud.update(this.copy).toPromise().then(e=>h(this,void 0,void 0,(function*(){return this.numSucceeded++,this.toast.success(yield this.successMsg.current()),this.getNextCopy().toPromise()})),e=>h(this,void 0,void 0,(function*(){this.numFailed++,console.error("Replace barcode failed: ",e),this.toast.warning(yield this.errorMsg.current())}))))})))}))}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(b.s),l.Lb(a.a),l.Lb(n.a),l.Lb(l.D))},e.\u0275cmp=l.Fb({type:e,selectors:[["eg-replace-barcode-dialog"]],viewQuery:function(e,t){var i;1&e&&(l.Ic(g,!0),l.Ic(p,!0)),2&e&&(l.yc(i=l.gc())&&(t.successMsg=i.first),l.yc(i=l.gc())&&(t.errorMsg=i.first))},inputs:{copyIds:"copyIds"},features:[l.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-lg-4"],[1,"col-lg-8","font-weight-bold"],[1,"row","pt-2","form-validated"],["for","new-barcode-intput"],[1,"col-log-8"],["type","text","id","new-barcode-input",1,"form-control",3,"required","ngModel","ngModelChange","keyup"],["class","row d-flex pt-2 justify-content-center",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"row","d-flex","pt-2","justify-content-center"],[1,"alert","alert-danger"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(l.Rb(0,"eg-string",0,1),l.Xb(2,m),l.Qb(),l.Rb(3,"eg-string",0,2),l.Xb(5,x),l.Qb(),l.Kc(6,I,27,5,"ng-template",null,3,l.Lc))},directives:[d.a,f.c,f.E,f.t,f.w,u.v],encapsulation:2}),e})()},FO7Y:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var c=i("wBwE"),o=i("cm5s"),s=i("OsfI"),n=(i("DMNx"),i("fXoL")),a=i("ofXK"),r=i("3Pt+");function d(e,t){if(1&e){const e=n.Sb();n.Rb(0,"div"),n.Rb(1,"textarea",1),n.fc("change",(function(){return n.Bc(e),n.hc().textChanged()}))("blur",(function(){return n.Bc(e),n.hc().record.absorbBreakerChanges()}))("ngModelChange",(function(t){return n.Bc(e),n.hc().record.breakerText=t})),n.Mc(2,"  "),n.Qb(),n.Qb()}if(2&e){const e=n.hc();n.xb(1),n.pc("rows",e.rowCount()),n.oc("ngModel",e.record.breakerText)}}let l=(()=>{class e{constructor(e,t,i){this.idl=e,this.org=t,this.store=i}get record(){return this.context.record}ngOnInit(){this.record.breakerText=this.record.toBreaker()}rowCount(){return this.record&&this.record.breakerText?this.record.breakerText.split(/\n/).length+2:40}textChanged(){this.context.changesPending=!0}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(c.a),n.Lb(o.a),n.Lb(s.a))},e.\u0275cmp=n.Fb({type:e,selectors:[["eg-marc-flat-editor"]],inputs:{context:"context"},decls:1,vars:1,consts:[[4,"ngIf"],["spellcheck","false",1,"form-control","flat-editor-content",3,"ngModel","rows","change","blur","ngModelChange"]],template:function(e,t){1&e&&n.Kc(0,d,3,2,"div",0),2&e&&n.oc("ngIf",t.record)},directives:[a.v,r.c,r.t,r.w],styles:[".flat-editor-content[_ngcontent-%COMP%]{font-family:Lucida Console,Monaco,monospace;display:inline-block;padding:0}"]}),e})()},FSVw:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i("DMNx");var c=i("fXoL"),o=i("ofXK"),s=i("E+BH");function n(e,t){if(1&e&&(c.Pb(0),c.Rb(1,"div",1),c.Rb(2,"div",2),c.Rb(3,"span",3),c.Mc(4),c.Qb(),c.Qb(),c.Rb(5,"div",4),c.Mb(6,"eg-marc-editable-content",5),c.Qb(),c.Qb(),c.Ob()),2&e){const e=c.hc();c.xb(3),c.qc("id","label-",e.randId,""),c.xb(1),c.Oc(" ",e.fieldLabel," "),c.xb(2),c.oc("context",e.context)("ariaLabel",e.fieldLabel)("fixedFieldCode",e.fieldCode)}}let a=(()=>{class e{constructor(){this.randId=Math.floor(1e7*Math.random())}get record(){return this.context.record}ngOnInit(){this.init().then(e=>this.context.recordChange.subscribe(e=>this.init()))}init(){return this.record?this.context.tagTable.getFfFieldMeta(this.fieldCode).then(e=>this.fieldMeta=e):Promise.resolve()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Fb({type:e,selectors:[["eg-fixed-field"]],inputs:{fieldCode:"fieldCode",fieldLabel:"fieldLabel",context:"context"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"d-flex"],[1,"flex-4"],[1,"text-left","font-weight-bold",3,"id"],[1,"flex-5"],["fieldType","ffld","moreClasses","p-1",3,"context","ariaLabel","fixedFieldCode"]],template:function(e,t){1&e&&c.Kc(0,n,7,5,"ng-container",0),2&e&&c.oc("ngIf",t.fieldMeta)},directives:[o.v,s.a],styles:["[_nghost-%COMP%] .popover{font-family:Lucida Console,Monaco,monospace;max-width:550px}[_nghost-%COMP%] .popover-body{max-height:400px;overflow-y:auto;overflow-x:auto}[_nghost-%COMP%] .popover-body .menu-entry{white-space:nowrap}[_nghost-%COMP%] .popover-body .menu-entry:hover{background-color:#f8f9fa}"]}),e})()},Fbhp:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var c=i("z6cu"),o=i("Osig"),s=i("EQDH"),n=i("iA0r"),a=i("YRS1"),r=i("8PDw"),d=i("rRT/"),l=i("tNQm"),b=i("36iw"),f=i("fXoL"),u=i("1kSV");const h=["successMsg"],g=["errorMsg"],p=["confirmOverride"],m=["text",$localize`:␟ec97e2d72d7c72bc1d5a004bd09144ea38e3bd0a␟5761189843029272570:Successfully Holdings`],x=["text",$localize`:␟9c32566b754dcec03052d48a890dcc987d132a9b␟2422310499398384890:Failed To Delete Holdings`],R=["dialogTitle",$localize`:␟3a4eb1b19e4345afbea5d41a557e2c5a785ce8f6␟556111530844708159:One or more items could not be deleted. Override?`,"dialogBody",$localize`:␟ffff9a64352ab15a690cc5779ec33c7451826745␟2765099046800702094:Reason(s) include: ${"\ufffd0\ufffd"}:INTERPOLATION:`];var v;v=$localize`:␟2a618956bc2b3c7375075ee8fd12f0b90bac8d74␟8315868811027667205:Delete Holdings`;const y=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var Q,C,L;function T(e,t){if(1&e){const e=f.Sb();f.Rb(0,"div",6),f.Rb(1,"h4",7),f.Rb(2,"span"),f.Vb(3,v),f.Qb(),f.Qb(),f.Rb(4,"button",8),f.Xb(5,y),f.fc("click",(function(){return f.Bc(e),f.hc().close()})),f.Rb(6,"span",9),f.Mc(7,"\xd7"),f.Qb(),f.Qb(),f.Qb(),f.Rb(8,"div",10),f.Rb(9,"p"),f.Vb(10,Q),f.Qb(),f.Qb(),f.Rb(11,"div",11),f.Pb(12),f.Rb(13,"button",12),f.fc("click",(function(){return f.Bc(e),f.hc().close()})),f.Vb(14,C),f.Qb(),f.Rb(15,"button",13),f.fc("click",(function(){return f.Bc(e),f.hc().deleteHoldings()})),f.Vb(16,L),f.Qb(),f.Ob(),f.Qb()}if(2&e){const e=f.hc();f.xb(10),f.Zb(e.numCallNums)(e.numCopies),f.Wb(10)}}Q=$localize`:␟d1e9c6f58f905370b726ecdbed607cf232449226␟6069754159662805451:Delete ${"\ufffd0\ufffd"}:INTERPOLATION: call numbers and ${"\ufffd1\ufffd"}:INTERPOLATION_1: copies?`,C=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,L=$localize`:␟355cf46daf1ef6cccc637e648f2a49643b91f69b␟4593063443333769948: Delete Holdings `;let k=(()=>{class e extends d.a{constructor(e,t,i,c,o,s,n){super(e),this.modal=e,this.toast=t,this.net=i,this.pcrud=c,this.evt=o,this.renderer=s,this.auth=n}ngOnInit(){}open(e){return this.numCallNums=0,this.numCopies=0,this.numSucceeded=0,this.numFailed=0,this.callNums.forEach(e=>{e.isdeleted()&&this.numCallNums++,Array.isArray(e.copies())&&e.copies().forEach(e=>{(e.isdeleted()||this.forceDeleteCopies)&&(e.isdeleted(!0),this.numCopies++)})}),0===this.numCallNums&&0===this.numCopies?(console.debug("Holdings delete called with no usable data"),Object(c.a)(!1)):super.open(e)}deleteHoldings(e){this.deleteEventDesc="";const t={force_delete_copies:this.forceDeleteCopies};let i="open-ils.cat.asset.volume.fleshed.batch.update";e&&(i+=".override",t.events=["TITLE_LAST_COPY","COPY_DELETE_WARNING"]),this.net.request("open-ils.cat",i,this.auth.token(),this.callNums,1,t).toPromise().then(t=>{const i=this.evt.parse(t);i?this.handleDeleteEvent(i,e):(this.numSucceeded++,this.close(this.numSucceeded>0))},e=>{console.warn(e),this.errorMsg.current().then(e=>this.toast.warning(e)),this.numFailed++})}handleDeleteEvent(e,t){return t?(console.warn(e),this.numFailed++,this.errorMsg.current().then(e=>this.toast.warning(e))):(this.deleteEventDesc=e.desc,this.confirmOverride.open().toPromise().then(e=>{if(e)return this.deleteHoldings(!0);this.numFailed++,this.errorMsg.current().then(e=>this.toast.warning(e)),this.close(this.numSucceeded>0)}))}}return e.\u0275fac=function(t){return new(t||e)(f.Lb(u.s),f.Lb(a.a),f.Lb(o.b),f.Lb(n.a),f.Lb(s.a),f.Lb(f.D),f.Lb(r.a))},e.\u0275cmp=f.Fb({type:e,selectors:[["eg-delete-holding-dialog"]],viewQuery:function(e,t){var i;1&e&&(f.Ic(h,!0),f.Ic(g,!0),f.Sc(p,!0)),2&e&&(f.yc(i=f.gc())&&(t.successMsg=i.first),f.yc(i=f.gc())&&(t.errorMsg=i.first),f.yc(i=f.gc())&&(t.confirmOverride=i.first))},inputs:{callNums:"callNums",forceDeleteCopies:"forceDeleteCopies"},features:[f.ub],decls:11,vars:1,consts:[[6,"text"],["successMsg",""],["errorMsg",""],[6,"dialogTitle","dialogBody"],["confirmOverride",""],["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(e,t){1&e&&(f.Rb(0,"eg-string",0,1),f.Xb(2,m),f.Qb(),f.Rb(3,"eg-string",0,2),f.Xb(5,x),f.Qb(),f.Rb(6,"eg-confirm-dialog",3,4),f.Xb(8,R),f.Qb(),f.Kc(9,T,17,2,"ng-template",null,5,f.Lc)),2&e&&(f.xb(6),f.Zb(t.deleteEventDesc),f.Wb(8))},directives:[l.a,b.a],encapsulation:2}),e})()},GlPx:function(e,t,i){"use strict";i.d(t,"a",(function(){return ee}));var c=i("Osig"),o=i("cm5s"),s=i("8PDw"),n=i("iA0r"),a=i("rRT/"),r=(i("DMNx"),i("Q4dc")),d=i("6tXh"),l=i("fXoL"),b=i("1kSV"),f=i("ofXK"),u=i("3Pt+"),h=i("tyNb");const g=["marcEditDialog"];var p,m,x,R,v;function y(e,t){if(1&e&&(l.Rb(0,"span"),l.Rb(1,"span",6),l.Vb(2,p),l.Qb(),l.Mc(3),l.Qb()),2&e){const e=t.$implicit;l.xb(3),l.Pc("",e[0]," ",e[1]," ")}}function Q(e,t){if(1&e&&(l.Rb(0,"span"),l.Mc(1),l.Qb(),l.Kc(2,y,4,2,"span",5)),2&e){const e=t.field;l.xb(1),l.Qc("",e.tag," ",e.ind1," ",e.ind2,""),l.xb(1),l.oc("ngForOf",e.subfields)}}function C(e,t){if(1&e&&(l.Rb(0,"span"),l.Vb(1,x),l.Qb()),2&e){const e=l.hc(2).field;l.xb(1),l.Zb(e.heading),l.Wb(1)}}function L(e,t){if(1&e&&(l.Rb(0,"span"),l.Vb(1,R),l.Qb()),2&e){const e=l.hc(2).field;l.xb(1),l.Zb(e.heading),l.Wb(1)}}function T(e,t){if(1&e&&(l.Rb(0,"span"),l.Vb(1,v),l.Qb()),2&e){const e=l.hc(2).field;l.xb(1),l.Zb(e.heading),l.Wb(1)}}function k(e,t){if(1&e&&(l.Pb(0),l.Kc(1,C,2,1,"span",8),l.Kc(2,L,2,1,"span",8),l.Kc(3,T,2,1,"span",8),l.Ob()),2&e){const e=l.hc(),t=e.from,i=e.also;l.xb(1),l.oc("ngIf",t),l.xb(1),l.oc("ngIf",i),l.xb(1),l.oc("ngIf",!t&&!i)}}function I(e,t){1&e&&l.Nb(0)}p=$localize`:␟91bbb166bdcc20c8d7eeb496d82f7854b536450d␟5744128525361483112:‡`,m=$localize`:␟c2d0ac9f528bbd5f53fd34269fde8b59e029621b␟4391289919356861627:Apply`,x=$localize`:␟307835496ef479f2a0da7ddc80e9c65aed3de57f␟821668427035385433:See From: ${"\ufffd0\ufffd"}:INTERPOLATION:`,R=$localize`:␟8b0b3fb796c43af0e9fcd152fbb15c25eedcd87f␟2378132941261036132:See Also: ${"\ufffd0\ufffd"}:INTERPOLATION:`,v=$localize`:␟2cbf4f61eeee95ef98f0ffb667698ecf02005c46␟6160671683827571372:${"\ufffd0\ufffd"}:INTERPOLATION:`;const S=function(e){return{field:e}};function M(e,t){if(1&e&&(l.Pb(0),l.Kc(1,I,1,0,"ng-container",9),l.Ob()),2&e){const e=l.hc().field;l.hc();const t=l.zc(1);l.xb(1),l.oc("ngTemplateOutlet",t)("ngTemplateOutletContext",l.uc(2,S,e))}}const w=function(e,t){return{"btn-outline-primary":e,"btn-outline-info":t}};function F(e,t){if(1&e){const e=l.Sb();l.Rb(0,"button",7),l.fc("click",(function(){l.Bc(e);const i=t.field,c=t.authId;return l.hc().applyHeading(i,c)})),l.Vb(1,m),l.Qb(),l.Kc(2,k,4,3,"ng-container",8),l.Kc(3,M,2,4,"ng-container",8)}if(2&e){const e=t.from,i=t.also,c=l.hc();l.oc("ngClass",l.vc(3,w,!(e||i),e||i)),l.xb(2),l.oc("ngIf","heading"==c.showAs),l.xb(1),l.oc("ngIf","marc"==c.showAs)}}var $;$=$localize`:␟94eb76ed52fe95c785350b7b86f69d21ecc5a8de␟7617687891879269540:Manage Authority Links`;const O=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var z,B,P,_,N,X,D,A;function V(e,t){if(1&e){const e=l.Sb();l.Rb(0,"div"),l.Rb(1,"div",25),l.Rb(2,"input",30),l.fc("ngModelChange",(function(i){l.Bc(e);const c=t.$implicit;return l.hc(2).selectedSubfields[c[0]]=i}))("change",(function(){l.Bc(e);const t=l.hc(2);return t.getPage(t.pager.offset)})),l.Qb(),l.Rb(3,"span",6),l.Vb(4,D),l.Qb(),l.Rb(5,"label",31),l.Vb(6,A),l.Qb(),l.Qb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.hc(2);l.xb(2),l.qc("id","search-subfield-",e[0],""),l.oc("disabled",!i.isControlledBibSf(e[0]))("ngModel",i.selectedSubfields[e[0]]),l.xb(3),l.qc("for","search-subfield-",e[0],""),l.xb(1),l.Zb(e[0])(e[1]),l.Wb(6)}}z=$localize`:␟4f9c9a1ad172062311581c4266e7f17f2f034aca␟4449034732621535015:Create new authority from this field`,B=$localize`:␟8434d4a28744d7df82cd39ef8da4266fcbc40064␟5162686434580248853:Start`,P=$localize`:␟680d5c75b7fd8d37961083608b9fcdc4167b4c43␟4452427314943113135:Previous`,_=$localize`:␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`,N=$localize`:␟bef9d046befde0ce5da6427d25ebd7344505f2e9␟8669444628795782045:Show As Heading`,X=$localize`:␟8914576c070c546a13b5a2ac874430c3eaca0a03␟1641941749997343157:Show As MARC`,D=$localize`:␟91bbb166bdcc20c8d7eeb496d82f7854b536450d␟5744128525361483112:‡`,A=$localize`:␟a53b06755e3a5c0ae2e405c689dfd5ec52c0be25␟3125817251615927004: ${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd1\ufffd"}:INTERPOLATION_1: `;const E=["title",$localize`:␟ae54b1243c147704fd471610bcbbacb2cd01f613␟7024299215733258044:Authority Record ID ${"\ufffd0\ufffd"}:INTERPOLATION:`];function K(e,t){1&e&&l.Nb(0)}function q(e,t){1&e&&l.Nb(0)}const j=function(e){return{field:e,from:!0}};function U(e,t){if(1&e&&(l.Rb(0,"ul"),l.Rb(1,"li",35),l.Kc(2,q,1,0,"ng-container",9),l.Qb(),l.Qb()),2&e){const e=t.$implicit;l.hc(3);const i=l.zc(5);l.xb(2),l.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",l.uc(2,j,e))}}function H(e,t){1&e&&l.Nb(0)}const W=function(e){return{field:e,also:!0}};function Z(e,t){if(1&e&&(l.Rb(0,"ul"),l.Rb(1,"li",35),l.Kc(2,H,1,0,"ng-container",9),l.Qb(),l.Qb()),2&e){const e=t.$implicit;l.hc(3);const i=l.zc(5);l.xb(2),l.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",l.uc(2,W,e))}}const G=function(e,t){return{field:e,authId:t}};function Y(e,t){if(1&e&&(l.Rb(0,"ul"),l.Rb(1,"li",32),l.Rb(2,"div",21),l.Kc(3,K,1,0,"ng-container",9),l.Qb(),l.Rb(4,"div",33),l.Rb(5,"a",34),l.Xb(6,E),l.Mc(7),l.Qb(),l.Qb(),l.Qb(),l.Kc(8,U,3,4,"ul",5),l.Kc(9,Z,3,4,"ul",5),l.Qb()),2&e){const e=t.$implicit;l.hc(2);const i=l.zc(5);l.xb(3),l.oc("ngTemplateOutlet",i)("ngTemplateOutletContext",l.vc(7,G,e.main_heading,e.authority_id)),l.xb(2),l.Zb(e.authority_id),l.Wb(6),l.qc("routerLink","/staff/cat/authority/edit/",e.authority_id,""),l.xb(2),l.Oc(" #",e.authority_id," "),l.xb(1),l.oc("ngForOf",e.see_froms),l.xb(1),l.oc("ngForOf",e.see_alsos)}}function J(e,t){if(1&e){const e=l.Sb();l.Rb(0,"div",10),l.Rb(1,"h4",11),l.Vb(2,$),l.Qb(),l.Rb(3,"button",12),l.Xb(4,O),l.fc("click",(function(){return l.Bc(e),l.hc().close()})),l.Rb(5,"span",13),l.Mc(6,"\xd7"),l.Qb(),l.Qb(),l.Qb(),l.Rb(7,"div",14),l.Rb(8,"div",15),l.Rb(9,"div",16),l.Rb(10,"div"),l.Mc(11),l.Qb(),l.Kc(12,V,7,6,"div",5),l.Qb(),l.Rb(13,"div",17),l.Rb(14,"div",18),l.Vb(15,z),l.Qb(),l.Rb(16,"div"),l.Rb(17,"button",19),l.fc("click",(function(){return l.Bc(e),l.hc().createNewAuthority()})),l.Mc(18,"Immediately"),l.Qb(),l.Rb(19,"button",20),l.fc("click",(function(){return l.Bc(e),l.hc().createNewAuthority(!0)})),l.Mc(20,"Create and Edit"),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Rb(21,"div",15),l.Rb(22,"div",21),l.Rb(23,"button",22),l.fc("click",(function(){return l.Bc(e),l.hc().getPage(0)})),l.Vb(24,B),l.Qb(),l.Rb(25,"button",23),l.fc("click",(function(){return l.Bc(e),l.hc().getPage(-1)})),l.Vb(26,P),l.Qb(),l.Rb(27,"button",23),l.fc("click",(function(){return l.Bc(e),l.hc().getPage(1)})),l.Vb(28,_),l.Qb(),l.Qb(),l.Rb(29,"div",24),l.Rb(30,"div",25),l.Rb(31,"input",26),l.fc("ngModelChange",(function(t){return l.Bc(e),l.hc().showAs=t})),l.Qb(),l.Rb(32,"label",27),l.Vb(33,N),l.Qb(),l.Qb(),l.Rb(34,"div",25),l.Rb(35,"input",28),l.fc("ngModelChange",(function(t){return l.Bc(e),l.hc().showAs=t})),l.Qb(),l.Rb(36,"label",29),l.Vb(37,X),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Kc(38,Y,10,10,"ul",5),l.Qb()}if(2&e){const e=l.hc();l.xb(11),l.Qc("",e.bibField.tag," ",e.bibField.ind1," ",e.bibField.ind2,""),l.xb(1),l.oc("ngForOf",e.bibField.subfields),l.xb(11),l.oc("disabled",0==e.pager.offset),l.xb(8),l.oc("ngModel",e.showAs),l.xb(4),l.oc("ngModel",e.showAs),l.xb(3),l.oc("ngForOf",e.browseData)}}let ee=(()=>{class e extends a.a{constructor(e,t,i,c,o){super(e),this.modal=e,this.auth=t,this.org=i,this.pcrud=c,this.net=o,this.thesauri=null,this.controlSet=null,this.browseData=[],this.showAs="heading",this.selectedSubfields=[]}ngOnInit(){this.pager||(this.pager=new r.a,this.pager.limit=5),this.onOpen$.subscribe(e=>this.initData())}fieldHash(e){return e||(e=this.bibField),{tag:e.tag,ind1:e.ind1,ind2:e.ind2,subfields:e.subfields.map(e=>[e[0],e[1]])}}initData(){this.pager.offset=0,this.org.settings(["cat.marc_control_number_identifier"]).then(e=>{this.cni=e["cat.marc_control_number_identifier"]||"Set cat.marc_control_number_identifier in Library Settings"}),this.pcrud.search("acsbf",{tag:this.bibField.tag},{flesh:1,flesh_fields:{acsbf:["authority_field"]}},{atomic:!0,anonymous:!0}).subscribe(e=>{if(0===e.length)return;let t;t=this.controlSet?e.filter(e=>this.controlSet===+e.authority_field().control_set()):e[0],t&&(this.authMeta=t.authority_field(),this.bibField.subfields.forEach(e=>this.selectedSubfields[e[0]]=this.isControlledBibSf(e[0]))),this.getPage(0)})}getPage(e){this.browseData=[],e>0?this.pager.offset++:e<0?this.pager.offset--:this.pager.offset=0;const t=this.fieldHash();t.subfields=t.subfields.filter(e=>this.selectedSubfields[e[0]]),0!==t.subfields.length&&this.net.request("open-ils.cat","open-ils.cat.authority.bib_field.linking_browse",t,this.pager.limit,this.pager.offset,this.thesauri).subscribe(e=>this.browseData.push(e))}applyHeading(e,t){this.net.request("open-ils.cat","open-ils.cat.authority.bib_field.overlay_authority",this.fieldHash(),this.fieldHash(e),this.controlSet).subscribe(e=>{t&&this.setSubfieldZero(t,e),this.close(e)})}isControlledBibSf(e){return!!this.authMeta&&this.authMeta.sf_list().includes(e)}setSubfieldZero(e,t){t||(t=this.bibField);const i=t.subfields.filter(e=>"0"===e[0])[0];i&&this.context.deleteSubfield(t,i),this.context.insertSubfield(t,["0",`(${this.cni})${e}`,t.subfields.length]),t.authChecked=null,t.authValid=null}createNewAuthority(e){this.net.request("open-ils.cat",e?"open-ils.cat.authority.record.create_from_bib.readonly":"open-ils.cat.authority.record.create_from_bib",this.fieldHash(),this.cni,this.auth.token()).subscribe(t=>{e?(this.marcEditDialog.recordXml=t,this.marcEditDialog.open({size:"xl"}).subscribe(e=>{e&&e.recordId&&this.setSubfieldZero(e.recordId),this.close()})):(this.setSubfieldZero(t.id()),this.close())})}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(b.s),l.Lb(s.a),l.Lb(o.a),l.Lb(n.a),l.Lb(c.b))},e.\u0275cmp=l.Fb({type:e,selectors:[["eg-authority-linking-dialog"]],viewQuery:function(e,t){var i;1&e&&l.Sc(g,!0),2&e&&l.yc(i=l.gc())&&(t.marcEditDialog=i.first)},inputs:{bibField:"bibField",thesauri:"thesauri",controlSet:"controlSet",pager:"pager",context:"context"},features:[l.ub],decls:8,vars:0,consts:[["fieldAsMarc",""],["recordType","authority"],["marcEditDialog",""],["headingField",""],["dialogContent",""],[4,"ngFor","ngForOf"],[1,"text-danger"],[1,"btn","btn-sm","p-1","mr-1",3,"ngClass","click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"row","border-bottom","border-secondary","p-2","d-flex"],[1,"flex-1","font-weight-bold","p-1","pl-2","pt-2","ml-2"],[1,"ml-2","p-1"],[1,"mb-1"],[1,"btn","btn-outline-info",3,"click"],[1,"btn","btn-outline-info","ml-2",3,"click"],[1,"flex-1"],[1,"btn","btn-outline-dark",3,"disabled","click"],[1,"btn","btn-outline-dark","ml-2",3,"click"],[1,"pt-2","mb-2"],[1,"form-check","form-check-inline"],["type","radio","value","heading","name","show-as-heading","id","show-as-heading",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-as-heading",1,"form-check-label"],["type","radio","value","marc","name","show-as-heading","id","show-as-marc",1,"form-check-input",3,"ngModel","ngModelChange"],["for","show-as-marc",1,"form-check-label"],["type","checkbox",1,"form-check-input",3,"id","disabled","ngModel","ngModelChange","change"],[1,"form-check-label",3,"for"],[1,"d-flex","mt-1"],[1,"font-italic"],["target","_blank",3,"routerLink",6,"title"],[1,"mt-1"]],template:function(e,t){1&e&&(l.Kc(0,Q,3,4,"ng-template",null,0,l.Lc),l.Mb(2,"eg-marc-editor-dialog",1,2),l.Kc(4,F,4,6,"ng-template",null,3,l.Lc),l.Kc(6,J,39,8,"ng-template",null,4,l.Lc))},directives:[d.a,f.u,f.s,f.v,f.C,u.B,u.c,u.t,u.w,u.a,h.f],encapsulation:2}),e})()},"NF/O":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var c=i("fXoL");class o{constructor(e){this.record=new MARC21.Record({marcxml:e,delimiter:"$"}),this.breakerText=this.record.toBreaker(),this.fixedFieldChange=new c.n}get leader(){return this.record.leader}set leader(e){this.record.leader=e}get fields(){return this.record.fields}set fields(e){this.record.fields=e}toXml(){return this.record.toXmlString()}toBreaker(){return this.record.toBreaker()}recordType(){return this.record.recordType()}absorbBreakerChanges(){this.record=new MARC21.Record({marcbreaker:this.breakerText,delimiter:"$"})}extractFixedField(e){return this.record.extractFixedField(e)}setFixedField(e,t){const i=this.record.setFixedField(e,t);return this.fixedFieldChange.emit(e),i}stampFieldIds(){this.fields.forEach(e=>this.stampFieldId(e))}stampFieldId(e){e.fieldId||(e.fieldId=Math.floor(1e7*Math.random())),void 0===e.isCtrlField&&(e.isCtrlField=e.isControlfield())}field(e,t){return this.record.field(e,t)}appendFields(...e){this.record.appendFields.apply(this.record,e),this.stampFieldIds()}insertFieldsBefore(e,...t){this.record.insertFieldsBefore.apply(this.record,[e].concat(t)),this.stampFieldIds()}insertFieldsAfter(e,...t){this.record.insertFieldsAfter.apply(this.record,[e].concat(t)),this.stampFieldIds()}insertOrderedFields(...e){this.record.insertOrderedFields.apply(this.record,e),this.stampFieldIds()}generate008(){return this.record.generate008()}deleteFields(...e){this.record.deleteFields.apply(this.record,e)}getField(e){return this.fields.filter(t=>t.fieldId===e)[0]}getPreviousField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].fieldId===e)return this.fields[t-1]}getNextField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].fieldId===e)return this.fields[t+1]}newField(e){const t=new MARC21.Field(e);return this.stampFieldId(t),t}cloneField(e){const t={tag:e.tag};return e.isControlfield()?t.data=e.data:(t.ind1=e.ind1,t.ind2=e.ind2,t.subfields=this.cloneSubfields(e.subfields)),this.newField(t)}cloneSubfields(e){const t=[];return e.forEach(e=>t.push([].concat(e))),t}subfield(e,t){return this.record.subfield(e,t)}}},Pf76:function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return u}));var c=i("fXoL"),o=i("3Pt+"),s=i("Osig"),n=i("8PDw"),a=i("LRne"),r=i("sVev"),d=i("cx9U"),l=i("eIep"),b=i("JIr8");let f=(()=>{class e{constructor(e,t){this.auth=e,this.net=t,this.validate=e=>this.parseActorCall(this.net.request("open-ils.actor","open-ils.actor.get_barcodes",this.auth.token(),this.auth.user().ws_ou(),"actor",e.value.trim())),this.parseActorCall=e=>e.pipe(Object(d.a)(),Object(l.a)(()=>Object(a.a)(null)),Object(b.a)(e=>e instanceof r.a?Object(a.a)({patronBarcode:"No patron found with that barcode"}):"Sequence contains more than one element"===e?Object(a.a)({patronBarcode:"Barcode matches more than one patron"}):void 0))}}return e.\u0275fac=function(t){return new(t||e)(c.cc(n.a),c.cc(s.b))},e.\u0275prov=c.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),u=(()=>{class e{constructor(e){this.pbv=e,this.validate=e=>{this.pbv.validate(e)}}}return e.\u0275fac=function(t){return new(t||e)(c.Lb(f))},e.\u0275dir=c.Gb({type:e,selectors:[["","egValidPatronBarcode",""]],features:[c.wb([{provide:o.p,useExisting:Object(c.S)(()=>f),multi:!0}])]}),e})()},RXDw:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i("XKii");var c=i("fXoL"),o=i("ofXK");function s(e,t){if(1&e&&(c.Pb(0),c.Mc(1),c.Ob()),2&e){const e=c.hc(2);c.xb(1),c.Oc("",e.joiner," ")}}function n(e,t){if(1&e&&(c.Pb(0),c.Kc(1,s,2,1,"ng-container",1),c.Mb(2,"span",2),c.Ob()),2&e){const e=t.$implicit,i=t.first,o=c.hc();c.xb(1),c.oc("ngIf",o.joiner&&!i),c.xb(1),c.oc("innerHTML",e,c.Cc)}}let a=(()=>{class e{constructor(){}ngOnInit(){}getDisplayStrings(){const e=this.usePlaceholder?"\u2007":"";return this.summary?(t=this.summary.displayHighlights[this.field]||this.summary.display[this.field],Array.isArray(t)?t:[t||e]):[e];var t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Fb({type:e,selectors:[["eg-bib-display-field"]],inputs:{summary:"summary",field:"field",joiner:"joiner",usePlaceholder:"usePlaceholder"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"innerHTML"]],template:function(e,t){1&e&&c.Kc(0,n,3,2,"ng-container",0),2&e&&c.oc("ngForOf",t.getDisplayStrings())},directives:[o.u,o.v],styles:[".oils_SH{font-weight:bolder;background-color:#9f9}.oils_SH.identifier{font-weight:bolder;background-color:#42b0f4}"],encapsulation:2}),e})()},S3Is:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var c=i("Osig"),o=i("8PDw"),s=i("EQDH"),n=i("YRS1"),a=i("/xpB"),r=i("tNQm"),d=i("KBUj"),l=i("fXoL");const b=["successMsg"],f=["noTargetMsg"],u=["alertDialog"],h=["progressDialog"],g=["text",$localize`:␟833073c7be4d2407daea4f7e631fec2433a771d2␟6301982531655745147:Successfully Transferred Item(s)`],p=["text",$localize`:␟34112daab1103cca61439710cc0373e826b26cc9␟6339547280250871578:Failed To Transfer Item(s)`],m=["text",$localize`:␟a38806c3bcd0fa35267178e1a01bc2ee5686fa36␟4393492974110351892:No transfer target selected`],x=["dialogTitle",$localize`:␟1421e272e9be4a8848af6b07f5e3cbff10b0a6cf␟5619266044227052818:One or more items could not be transferred`,"dialogBody",$localize`:␟8f4224bf1f19027516f0fcfd90bb76496eafc985␟3909575663223570641:Reason(s) include: ${"\ufffd0\ufffd"}:INTERPOLATION:`];let R=(()=>{class e{constructor(e,t,i,c){this.toast=e,this.net=t,this.auth=i,this.evt=c}ngOnInit(){}transferHoldings(){if(!this.callNums||0===this.callNums.length)return Promise.resolve(!1);if(!this.targetRecId)return this.toast.warning(this.noTargetMsg.text),Promise.resolve(!1);this.eventDesc="";const e={};return this.targetOrgId?e[+this.targetOrgId]=this.callNums.map(e=>e.id()):this.callNums.forEach(t=>{const i=Number(t.owning_lib());e[i]||(e[i]=[]),e[i].push(t.id())}),this.progressDialog.update({value:0,max:Object.keys(e).length}),this.progressDialog.open(),this.performTransfers(e).then(e=>(this.progressDialog.close(),e))}performTransfers(e){const t=Object.keys(e)[0],i=e[t];return delete e[t],this.net.request("open-ils.cat","open-ils.cat.asset.volume.batch.transfer.override",this.auth.token(),{docid:this.targetRecId,lib:t,volumes:i}).toPromise().then(t=>{const i=this.evt.parse(t);return i||1!==Number(t)?(console.warn(t),this.eventDesc=i?i.desc:"",this.alertDialog.open().toPromise().then(e=>(this.eventDesc="",!1))):(this.progressDialog.increment(),!(Object.keys(e).length>0)||this.performTransfers(e))})}}return e.\u0275fac=function(t){return new(t||e)(l.Lb(n.a),l.Lb(c.b),l.Lb(o.a),l.Lb(s.a))},e.\u0275cmp=l.Fb({type:e,selectors:[["eg-transfer-holdings"]],viewQuery:function(e,t){var i;1&e&&(l.Sc(b,!0),l.Sc(f,!0),l.Sc(u,!0),l.Sc(h,!0)),2&e&&(l.yc(i=l.gc())&&(t.successMsg=i.first),l.yc(i=l.gc())&&(t.noTargetMsg=i.first),l.yc(i=l.gc())&&(t.alertDialog=i.first),l.yc(i=l.gc())&&(t.progressDialog=i.first))},inputs:{callNums:"callNums",targetRecId:"targetRecId",targetOrgId:"targetOrgId"},decls:14,vars:1,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["noTargetMsg",""],[6,"dialogTitle","dialogBody"],["alertDialog",""],["progressDialog",""]],template:function(e,t){1&e&&(l.Rb(0,"eg-string",0,1),l.Xb(2,g),l.Qb(),l.Rb(3,"eg-string",0,2),l.Xb(5,p),l.Qb(),l.Rb(6,"eg-string",0,3),l.Xb(8,m),l.Qb(),l.Rb(9,"eg-alert-dialog",4,5),l.Xb(11,x),l.Qb(),l.Mb(12,"eg-progress-dialog",null,6)),2&e&&(l.xb(9),l.Zb(t.eventDesc),l.Wb(11))},directives:[r.a,a.a,d.a],encapsulation:2}),e})()},VX9d:function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var c=i("z6cu"),o=i("Cfvw"),s=i("eIep"),n=i("Osig"),a=i("wBwE"),r=i("YRS1"),d=i("8PDw"),l=i("iA0r"),b=i("cm5s"),f=i("tNQm"),u=i("rRT/"),h=i("fXoL"),g=i("1kSV"),p=i("ofXK"),m=i("9rfo"),x=i("3Pt+");const R=["successMsg"],v=["errorMsg"],y=["text",$localize`:␟8caf7951a798d58fe820731dee675ecdce22b3e2␟5911747893814642436:Successfully Modified Item Alerts`],Q=["text",$localize`:␟c8cd23b602604d4476c8f9adfa3f80767e8c4954␟8429712111226814119:Failed To Modify Item Alerts`],C=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`],L=["placeholder",$localize`:␟55b01b2dfbc2e2745354a3c649a8517246898194␟8365635996288570248:New Alert Type...`],T=["placeholder",$localize`:␟bfab4612ecfd4c8bc5a3b8d710e75c3f39a8248a␟5756499307787052724:New Alert Note...`];var k,I,S,M,w;function F(e,t){if(1&e&&(h.Pb(0),h.Rb(1,"span"),h.Vb(2,M),h.Qb(),h.Ob()),2&e){const e=h.hc(2);h.xb(2),h.Zb(e.copies.length),h.Wb(2)}}function $(e,t){if(1&e&&(h.Pb(0),h.Rb(1,"span"),h.Vb(2,w),h.Qb(),h.Ob()),2&e){const e=h.hc(2);h.xb(2),h.Zb(e.copies[0].barcode()),h.Wb(2)}}k=$localize`:␟eabf11caddd75a44fdbb291b2e06b32046b1d028␟5540266862339624566: Temporary? `,I=$localize`:␟93fada3a19a5cfb387e9e19e84c96d0d5055bf55␟277154512686744141: Add New `,S=$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`,M=$localize`:␟1b03ebda4accdb2953fa62fbdb3ef7ddf33467d4␟9073900791275238266:Adding alerts for ${"\ufffd0\ufffd"}:INTERPOLATION: item(s).`,w=$localize`:␟2440076629d730ab31cc18c3087e34a60f67a85a␟2021682084626370873:Managing alerts for item ${"\ufffd0\ufffd"}:INTERPOLATION:`;const O=["placeholder",$localize`:␟ac2c1e8ba491ba507301baf7b51e2f6ed5f0442d␟8413325796584453014:Alert Type...`];var z;z=$localize`:␟c48767ae6f2bd617f29b353094828b4e32f82dc4␟6894135794153723810: Added: ${"\ufffd0\ufffd"}:INTERPOLATION: `;const B=["placeholder",$localize`:␟ec1d64c7a9d0a80b2c8118ad697eafb22bb89386␟128445830418836754:Alert Note...`];var P,_,N;function X(e,t){if(1&e){const e=h.Sb();h.Rb(0,"div",25),h.Rb(1,"div",26),h.Mb(2,"hr"),h.Qb(),h.Rb(3,"div",11),h.Rb(4,"eg-combobox",27),h.Xb(5,O),h.fc("onChange",(function(i){h.Bc(e);const c=t.$implicit;return c.alert_type(i?i.id:null),c.ischanged(!0)})),h.Qb(),h.Rb(6,"div",28),h.Vb(7,z),h.ic(8,"date"),h.Qb(),h.Qb(),h.Rb(9,"div",13),h.Rb(10,"textarea",14),h.Xb(11,B),h.fc("ngModelChange",(function(i){h.Bc(e);const c=t.$implicit;return c.note(i),c.ischanged(!0)})),h.Mc(12,"          "),h.Qb(),h.Qb(),h.Rb(13,"div",15),h.Rb(14,"div",16),h.Rb(15,"div",17),h.Rb(16,"input",29),h.fc("ngModelChange",(function(i){h.Bc(e);const c=t.$implicit;return c.temp(i?"t":"f"),c.ischanged(!0)})),h.Qb(),h.Rb(17,"label",30),h.Vb(18,P),h.Qb(),h.Qb(),h.Rb(19,"div",31),h.Rb(20,"input",29),h.fc("ngModelChange",(function(i){h.Bc(e);const c=t.$implicit;return c.ack_time(i?"now":null),c.ischanged(!0)})),h.Qb(),h.Rb(21,"label",30),h.Vb(22,_),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb()}if(2&e){const e=t.$implicit,i=h.hc(3);h.xb(4),h.oc("entries",i.alertTypes)("startId",e.alert_type())("required",!0),h.xb(4),h.Zb(h.kc(8,11,e.create_time(),"shortDate")),h.Wb(7),h.xb(2),h.oc("ngModel",e.note()),h.xb(6),h.qc("id","alert-temporary-",e.id(),""),h.oc("ngModel","t"==e.temp()),h.xb(1),h.qc("for","alert-temporary-",e.id(),""),h.xb(3),h.qc("id","alert-temporary-",e.id(),""),h.oc("ngModel",null!=e.ack_time()),h.xb(1),h.qc("for","alert-temporary-",e.id(),"")}}function D(e,t){if(1&e&&(h.Pb(0),h.Kc(1,X,23,14,"div",24),h.Ob()),2&e){const e=h.hc(2);h.xb(1),h.oc("ngForOf",e.copy.copy_alerts())}}function A(e,t){if(1&e){const e=h.Sb();h.Pb(0),h.Rb(1,"button",32),h.fc("click",(function(){return h.Bc(e),h.hc(2).applyChanges()})),h.Vb(2,N),h.Qb(),h.Ob()}}function V(e,t){if(1&e){const e=h.Sb();h.Rb(0,"div",4),h.Rb(1,"h4",5),h.Kc(2,F,3,1,"ng-container",6),h.Kc(3,$,3,1,"ng-container",6),h.Mb(4,"span"),h.Qb(),h.Rb(5,"button",7),h.Xb(6,C),h.fc("click",(function(){return h.Bc(e),h.hc().close()})),h.Rb(7,"span",8),h.Mc(8,"\xd7"),h.Qb(),h.Qb(),h.Qb(),h.Rb(9,"div",9),h.Rb(10,"div",10),h.Rb(11,"div",11),h.Rb(12,"eg-combobox",12),h.Xb(13,L),h.fc("onChange",(function(t){return h.Bc(e),h.hc().newAlert.alert_type(t?t.id:null)})),h.Qb(),h.Qb(),h.Rb(14,"div",13),h.Rb(15,"textarea",14),h.Xb(16,T),h.fc("ngModelChange",(function(t){return h.Bc(e),h.hc().newAlert.note(t)})),h.Mc(17,"        "),h.Qb(),h.Qb(),h.Rb(18,"div",15),h.Rb(19,"div",16),h.Rb(20,"div",17),h.Rb(21,"input",18),h.fc("ngModelChange",(function(t){return h.Bc(e),h.hc().newAlert.temp(t?"t":"f")})),h.Qb(),h.Rb(22,"label",19),h.Vb(23,k),h.Qb(),h.Qb(),h.Rb(24,"div",20),h.Rb(25,"button",21),h.fc("click",(function(){return h.Bc(e),h.hc().addNew()})),h.Vb(26,I),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Qb(),h.Kc(27,D,2,1,"ng-container",6),h.Qb(),h.Rb(28,"div",22),h.Rb(29,"button",23),h.fc("click",(function(){return h.Bc(e),h.hc().close()})),h.Vb(30,S),h.Qb(),h.Kc(31,A,3,0,"ng-container",6),h.Qb()}if(2&e){const e=h.hc();h.xb(2),h.oc("ngIf","create"==e.mode),h.xb(1),h.oc("ngIf","manage"==e.mode),h.xb(9),h.oc("entries",e.alertTypes)("required",!0),h.xb(3),h.oc("ngModel",e.newAlert.note()),h.xb(6),h.oc("ngModel","t"==e.newAlert.temp()),h.xb(6),h.oc("ngIf","manage"==e.mode),h.xb(4),h.oc("ngIf","manage"==e.mode)}}P=$localize`:␟4540cf91e759cf3f59e5195f24b04d2a1d9d0905␟1254639824387752829: Temporary? `,_=$localize`:␟17e0885d88828e360cfbc935961f7e88e03728f2␟6406844619904591523: Clear? `,N=$localize`:␟a39ffda0eec82e17fff876f0b18bdcbbb4725739␟3780215803787328104:Apply Changes`;let E=(()=>{class e extends u.a{constructor(e,t,i,c,o,s,n){super(e),this.modal=e,this.toast=t,this.net=i,this.idl=c,this.pcrud=o,this.org=s,this.auth=n,this.copyIds=[],this.copies=[]}set copyIds(e){this._copyIds=[].concat(e)}get copyIds(){return this._copyIds}set mode(e){this._mode=e}get mode(){return this._mode}ngOnInit(){}open(e){return this.copy=null,this.copies=[],this.newAlert=this.idl.create("aca"),this.newAlert.create_staff(this.auth.user().id()),0===this.copyIds.length?Object(c.a)("copy ID required"):("manage"===this.mode&&this.copyIds.length>1&&(console.warn("Attempt to manage alerts for multiple copies."),this.copyIds=[this.copyIds[0]]),Object(o.a)(this.getAlertTypes().then(e=>this.getCopies()).then(e=>"manage"===this.mode?this.getCopyAlerts():null)).pipe(Object(s.a)(t=>super.open(e))))}getAlertTypes(){return this.alertTypes?Promise.resolve():this.pcrud.retrieveAll("ccat",{active:!0,scope_org:this.org.ancestors(this.auth.user().ws_ou(),!0)},{atomic:!0}).toPromise().then(e=>{this.alertTypes=e.map(e=>({id:e.id(),label:e.name()}))})}getCopies(){return this.pcrud.search("acp",{id:this.copyIds},{},{atomic:!0}).toPromise().then(e=>{this.copies=e,e.forEach(e=>e.copy_alerts([])),"manage"===this.mode&&(this.copy=e[0])})}getCopyAlerts(){const e=this.copies.map(e=>e.id()),t=this.alertTypes.map(e=>e.id);return this.pcrud.search("aca",{copy:e,ack_time:null,alert_type:t},{},{atomic:!0}).toPromise().then(e=>{e.forEach(e=>{this.copies.filter(t=>t.id()===e.copy())[0].copy_alerts().push(e)})})}addNew(){if(!this.newAlert.alert_type())return;const e=[];this.copies.forEach(t=>{const i=this.idl.clone(this.newAlert);i.copy(t.id()),e.push(i)}),this.pcrud.create(e).toPromise().then(e=>{this.successMsg.current().then(e=>this.toast.success(e)),this.changesMade=!0,"create"===this.mode?this.close(this.changesMade):this.copy.copy_alerts().push(e)},e=>{this.errorMsg.current().then(e=>this.toast.danger(e))})}applyChanges(){const e=this.copy.copy_alerts().filter(e=>e.ischanged());0!==e.length&&this.pcrud.update(e).toPromise().then(e=>this.successMsg.current().then(e=>this.toast.success(e)),e=>this.errorMsg.current().then(e=>this.toast.danger(e)))}}return e.\u0275fac=function(t){return new(t||e)(h.Lb(g.s),h.Lb(r.a),h.Lb(n.b),h.Lb(a.a),h.Lb(l.a),h.Lb(b.a),h.Lb(d.a))},e.\u0275cmp=h.Fb({type:e,selectors:[["eg-copy-alerts-dialog"]],viewQuery:function(e,t){var i;1&e&&(h.Ic(R,!0),h.Ic(v,!0)),2&e&&(h.yc(i=h.gc())&&(t.successMsg=i.first),h.yc(i=h.gc())&&(t.errorMsg=i.first))},inputs:{copyIds:"copyIds",mode:"mode"},features:[h.ub],decls:8,vars:0,consts:[[6,"text"],["successMsg",""],["errorMsg",""],["dialogContent",""],[1,"modal-header"],[1,"modal-title"],[4,"ngIf"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body","p-4","form-validated"],[1,"row","mt-2","p-2","rounded","border","border-success"],[1,"col-lg-4"],[3,"entries","required","onChange",6,"placeholder"],[1,"col-lg-5"],["rows","2",1,"form-control",3,"ngModel","ngModelChange",6,"placeholder"],[1,"col-lg-3"],[1,"d-flex","flex-column"],[1,"form-check"],["type","checkbox","id","new-alert-temporary",1,"form-check-input",3,"ngModel","ngModelChange"],["for","new-alert-temporary",1,"form-check-label"],[1,"pt-2"],[1,"btn","btn-success",3,"click"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["class","row mt-2",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-lg-12","pb-2"],[3,"entries","startId","required","onChange",6,"placeholder"],[1,"pl-2","pt-2"],["type","checkbox",1,"form-check-input",3,"ngModel","id","ngModelChange"],[1,"form-check-label",3,"for"],[1,"form-check","pt-2"],[1,"btn","btn-success","mr-2",3,"click"]],template:function(e,t){1&e&&(h.Rb(0,"eg-string",0,1),h.Xb(2,y),h.Qb(),h.Rb(3,"eg-string",0,2),h.Xb(5,Q),h.Qb(),h.Kc(6,V,32,8,"ng-template",null,3,h.Lc))},directives:[f.a,p.v,m.a,x.c,x.t,x.w,x.a,p.u],pipes:[p.f],encapsulation:2}),e})()},cx9U:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var c=i("7o/Q"),o=i("sVev");function s(e){return t=>t.lift(new n(e,t))}class n{constructor(e,t){this.predicate=e,this.source=t}call(e,t){return t.subscribe(new a(e,this.predicate,this.source))}}class a extends c.a{constructor(e,t,i){super(e),this.predicate=t,this.source=i,this.seenValue=!1,this.index=0}applySingleValue(e){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=e)}_next(e){const t=this.index++;this.predicate?this.tryNext(e,t):this.applySingleValue(e)}tryNext(e,t){try{this.predicate(e,t,this.source)&&this.applySingleValue(e)}catch(i){this.destination.error(i)}}_complete(){const e=this.destination;this.index>0?(e.next(this.seenValue?this.singleValue:void 0),e.complete()):e.error(new o.a)}}},o1RZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var c,o,s=i("fXoL"),n=i("lJxs"),a=i("OXuP"),r=i("iA0r"),d=i("9rfo"),l=i("ofXK");function b(e,t){if(1&e){const e=s.Sb();s.Rb(0,"div",0),s.Rb(1,"div",4),s.Mc(2),s.Qb(),s.Rb(3,"button",5),s.fc("click",(function(){s.Bc(e);const i=t.$implicit;return s.hc().removeValue(i)})),s.Vb(4,o),s.Qb(),s.Qb()}if(2&e){const e=t.$implicit;s.xb(2),s.Nc(e.label)}}c=$localize`:␟f6755cff4957d5c3c89bafce5651f1b6fa2b1fd9␟3249513483374643425:Add`,o=$localize`:␟019d4bd6a5690f0cfa0ecf346a4e6bf7f0d8debb␟4814285799071780083:Remove`;let f=(()=>{class e{constructor(e,t){this.store=e,this.pcrud=t,this.entrylist=[],this.onChange=new s.n}valueSelected(e){this.selected=e||null}addSelectedValue(){this.entrylist.push(this.selected),this.onChange.emit(this.compileCurrentValue())}removeValue(e){this.entrylist=this.entrylist.filter(t=>t.id!==e.id),this.onChange.emit(this.compileCurrentValue())}compileCurrentValue(){return"{"+this.entrylist.map(e=>e.id).join(",")+"}"}ngOnInit(){if(this.startValue&&"{}"!==this.startValue){let e=this.startValue;e=e.replace(/^{/,""),e=e.replace(/}$/,"");const t=e.split(","),i={};if(this.linkedLibraryLabel){const e={};e[this.idlClass]=[this.linkedLibraryLabel],i.flesh=1,i.flesh_fields=e,this.pcrud.search(this.idlClass,{id:t},i).pipe(Object(n.a)(e=>{this.entrylist.push({id:e.id(),label:e.name()+" ("+e[this.linkedLibraryLabel]().shortname()+")"})})).toPromise()}else this.pcrud.search(this.idlClass,{id:t},i).pipe(Object(n.a)(e=>{this.entrylist.push({id:e.id(),label:e.name()})})).toPromise()}}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(a.a),s.Lb(r.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["eg-multi-select"]],inputs:{idlClass:"idlClass",linkedLibraryLabel:"linkedLibraryLabel",startValue:"startValue"},outputs:{onChange:"onChange"},decls:6,vars:5,consts:[[1,"row"],[3,"idlClass","idlIncludeLibraryInLabel","asyncSupportsEmptyTermClick","onChange"],[1,"btn","btn-outline-dark",3,"disabled","click"],["class","row",4,"ngFor","ngForOf"],[1,"col-lg-4"],[1,"btn","btn-sm","btn-warning",3,"click"]],template:function(e,t){1&e&&(s.Rb(0,"div"),s.Rb(1,"div",0),s.Rb(2,"eg-combobox",1),s.fc("onChange",(function(e){return t.valueSelected(e)})),s.Qb(),s.Rb(3,"button",2),s.fc("click",(function(){return t.addSelectedValue()})),s.Vb(4,c),s.Qb(),s.Qb(),s.Kc(5,b,5,1,"div",3),s.Qb()),2&e&&(s.xb(2),s.oc("idlClass",t.idlClass)("idlIncludeLibraryInLabel",t.linkedLibraryLabel)("asyncSupportsEmptyTermClick",!0),s.xb(1),s.oc("disabled",!t.selected),s.xb(2),s.oc("ngForOf",t.entrylist))},directives:[d.a,l.u],styles:[".icons[_ngcontent-%COMP%] {margin-left:-18px}\n    .material-icons[_ngcontent-%COMP%] {font-size: 16px;font-weight:bold}"]}),e})()},r7vI:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var c=i("vkgz"),o=i("lJxs"),s=i("zx2A");class n{constructor(e,t){this.keySelector=e,this.flushes=t}call(e,t){return t.subscribe(new a(e,this.keySelector,this.flushes))}}class a extends s.b{constructor(e,t,i){super(e),this.keySelector=t,this.values=new Set,i&&this.add(Object(s.c)(i,new s.a(this)))}notifyNext(){this.values.clear()}notifyError(e){this._error(e)}_next(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)}_useKeySelector(e){let t;const{destination:i}=this;try{t=this.keySelector(e)}catch(c){return void i.error(c)}this._finalizeNext(t,e)}_finalizeNext(e,t){const{values:i}=this;i.has(e)||(i.add(e),this.destination.next(t))}}var r=i("OXuP"),d=i("8PDw"),l=i("Osig"),b=i("iA0r"),f=i("fXoL");class u{constructor(e,t,i,c,o){this.cache={indicators:{},sfcodes:{},sfvalues:{},ffvalues:{}},this.store=e,this.auth=t,this.net=i,this.pcrud=c,this.selector=o}load(){return Promise.all([this.loadTagTable(),this.getFfPosTable(),this.getFfValueTable()])}fromCache(e,t,i){const c=this.cache[e][t];return i?c?c[i]:void 0:c}toCache(e,t,i,c){const o=this.cache[e];return i?(o[t]||(o[t]={}),o[t][i]=c):o[t]=c,c}getFfPosTable(){const e="FFPosTable_"+this.selector.ffType;return this.ffPosTable?Promise.resolve(this.ffPosTable):(this.ffPosTable=this.store.getLocalItem(e),this.ffPosTable?Promise.resolve(this.ffPosTable):this.net.request("open-ils.fielder","open-ils.fielder.cmfpm.atomic",{query:{tag:{"!=":"006"},rec_type:this.selector.ffType}}).toPromise().then(t=>(this.store.setLocalItem(e,t),this.ffPosTable=t)))}getFfValueTable(){const e="FFValueTable_"+this.selector.ffType;return this.ffValueTable?Promise.resolve(this.ffValueTable):(this.ffValueTable=this.store.getLocalItem(e),this.ffValueTable?Promise.resolve(this.ffValueTable):this.net.request("open-ils.cat","open-ils.cat.biblio.fixed_field_values.by_rec_type",this.selector.ffType).toPromise().then(t=>(this.store.setLocalItem(e,t),this.ffValueTable=t)))}loadTagTable(){const e=this.selector,t=`current_tag_table_${e.marcFormat}_${e.marcRecordType}`;return this.tagMap=this.store.getLocalItem(t),this.tagMap?Promise.resolve(this.tagMap):this.fetchTagTable().then(e=>(this.store.setLocalItem(t,this.tagMap),this.tagMap))}fetchTagTable(){return this.tagMap=[],this.net.request("open-ils.cat","open-ils.cat.tag_table.all.retrieve.local",this.auth.token(),this.selector.marcFormat,this.selector.marcRecordType).pipe(Object(c.a)(e=>{this.tagMap[e.tag]=e})).toPromise()}getSubfieldCodes(e){if(!e||!this.tagMap[e])return null;this.fromCache("sfcodes",e);const t=this.tagMap[e].subfields.map(e=>({value:e.code,label:`${e.code}: ${e.description}`})).sort((e,t)=>e.label<t.label?-1:1);return this.toCache("sfcodes",e,null,t)}getSubfieldLabel(e,t){if(!e||!this.tagMap[e])return null;const i=this.tagMap[e].subfields.filter(e=>e.code===t);return i.length?i[0].description:null}getFieldTags(){return this.fieldTags||(this.fieldTags=Object.keys(this.tagMap).filter(e=>Boolean(this.tagMap[e])).map(e=>({value:e,label:`${e}: ${this.tagMap[e].name}`})).sort((e,t)=>e.label<t.label?-1:1)),this.fieldTags}getSubfieldValues(e,t){if(!e||!this.tagMap[e])return[];const i=this.fromCache("sfvalues",e,t);if(i)return i;const c=[];return this.tagMap[e].subfields.filter(e=>e.code===t&&e.hasOwnProperty("value_list")).forEach(e=>{e.value_list.forEach(e=>{let t=e.description||e.code;const i=e.code||t;i!==t&&(t=`${i}: ${t}`),c.push({value:i,label:t})})}),this.toCache("sfvalues",e,t,c)}getIndicatorValues(e,t){if(!e||!this.tagMap[e])return;const i=this.fromCache("indicators",e,t);if(i)return i;let c=this.tagMap[e][t];return c?(c=c.map(e=>({value:e.code,label:`${e.code}: ${e.description}`})).sort((e,t)=>e.label<t.label?-1:1),this.toCache("indicators",e,t,c)):void 0}getFfFieldMeta(e){return this.getFfPosTable().then(t=>t.filter(t=>t.fixed_field===e&&t.rec_type===this.selector.ffType)[0])}getFfValues(e){const t=this.fromCache("ffvalues",e);if(t)return t;let i=this.ffValueTable;return i&&i[e]?(i=i[e].filter(e=>e[0].length<=e[2]).map(e=>({value:e[0],label:`${e[0]}: ${e[1]}`})).sort((e,t)=>e.label<t.label?-1:1),this.toCache("ffvalues",e,null,i)):null}}let h=(()=>{class e{constructor(e,t,i,c){this.store=e,this.auth=t,this.net=i,this.pcrud=c,this.tagTables={}}loadTags(e){if(e.marcFormat||(e.marcFormat="marc21"),this.tagTables[e.marcRecordType])return Promise.resolve(this.tagTables[e.marcRecordType]);const t=new u(this.store,this.auth,this.net,this.pcrud,e);return this.tagTables[e.marcRecordType]=t,t.load().then(e=>t)}getControlledBibTags(){return this.controlledBibTags?Promise.resolve(this.controlledBibTags):(this.controlledBibTags=[],this.pcrud.retrieveAll("acsbf",{select:["tag"]}).pipe(Object(o.a)(e=>e.tag()),e=>e.lift(new n(void 0,void 0)),Object(o.a)(e=>this.controlledBibTags.push(e))).toPromise().then(e=>this.controlledBibTags))}}return e.\u0275fac=function(t){return new(t||e)(f.cc(r.a),f.cc(d.a),f.cc(l.b),f.cc(b.a))},e.\u0275prov=f.Hb({token:e,factory:e.\u0275fac}),e})()},sYwd:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var c,o=i("wBwE"),s=i("iA0r"),n=i("rRT/"),a=(i("9rfo"),i("fXoL")),r=i("1kSV"),d=i("ofXK"),l=i("3Pt+");c=$localize`:␟becb27c6e70a648a20af0a2e509af8fa3949e88f␟2115271583357778705:Physical Characteristics Wizard`;const b=["aria-label",$localize`:␟f4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8␟7819314041543176992:Close`];var f,u,h,g,p,m,x,R,v,y;function Q(e,t){1&e&&(a.Pb(0),a.Vb(1,v),a.Ob())}function C(e,t){if(1&e&&(a.Pb(0),a.Mc(1),a.Ob()),2&e){const e=a.hc(2);a.xb(1),a.Nc(e.selectorLabel)}}function L(e,t){if(1&e&&(a.Rb(0,"option",24),a.Vb(1,y),a.Qb()),2&e){const e=t.$implicit;a.oc("ngValue",e.id),a.xb(1),a.Zb(e.id)(e.label),a.Wb(1)}}function T(e,t){if(1&e){const e=a.Sb();a.Rb(0,"div",1),a.Rb(1,"h4",2),a.Vb(2,c),a.Qb(),a.Rb(3,"button",3),a.Xb(4,b),a.fc("click",(function(){return a.Bc(e),a.hc().close()})),a.Rb(5,"span",4),a.Mc(6,"\xd7"),a.Qb(),a.Qb(),a.Qb(),a.Rb(7,"div",5),a.Rb(8,"div",6),a.Rb(9,"label",7),a.Vb(10,f),a.Qb(),a.Rb(11,"div",8),a.Rb(12,"div",9),a.Rb(13,"pre",10),a.Mc(14),a.Rb(15,"span",11),a.Mc(16),a.Qb(),a.Mc(17),a.Qb(),a.Qb(),a.Qb(),a.Rb(18,"div",12),a.Rb(19,"button",13),a.fc("click",(function(){return a.Bc(e),a.hc().reset()})),a.Vb(20,u),a.Qb(),a.Rb(21,"button",13),a.fc("click",(function(){return a.Bc(e),a.hc().reset(!0)})),a.Vb(22,h),a.Qb(),a.Qb(),a.Qb(),a.Rb(23,"div",6),a.Rb(24,"label",14),a.Kc(25,Q,2,0,"ng-container",15),a.Kc(26,C,2,1,"ng-container",15),a.Qb(),a.Rb(27,"div",16),a.Rb(28,"select",17),a.fc("ngModelChange",(function(t){return a.Bc(e),a.hc().selectorValue=t}))("change",(function(){return a.Bc(e),a.hc().selectorChanged()})),a.Rb(29,"option",18),a.Vb(30,g),a.Qb(),a.Kc(31,L,2,3,"option",19),a.Qb(),a.Qb(),a.Rb(32,"div",12),a.Rb(33,"button",20),a.fc("click",(function(){return a.Bc(e),a.hc().prev()})),a.Vb(34,p),a.Qb(),a.Rb(35,"button",20),a.fc("click",(function(){return a.Bc(e),a.hc().next()})),a.Vb(36,m),a.Qb(),a.Qb(),a.Qb(),a.Qb(),a.Rb(37,"div",21),a.Rb(38,"button",22),a.fc("click",(function(){a.Bc(e);const t=a.hc();return t.close(t.fieldData)})),a.Vb(39,x),a.Qb(),a.Rb(40,"button",23),a.fc("click",(function(){return a.Bc(e),a.hc().close()})),a.Vb(41,R),a.Qb(),a.Qb()}if(2&e){const e=a.hc();a.xb(14),a.Nc(e.splitFieldData()[0]),a.xb(2),a.Nc(e.splitFieldData()[1]),a.xb(1),a.Nc(e.splitFieldData()[2]),a.xb(8),a.oc("ngIf",!e.selectorLabel),a.xb(1),a.oc("ngIf",e.selectorLabel),a.xb(2),a.oc("ngModel",e.selectorValue),a.xb(3),a.oc("ngForOf",e.selectorOptions),a.xb(2),a.oc("disabled",0===e.step),a.xb(2),a.oc("disabled",e.isLastStep())}}f=$localize`:␟4c8a85f9def0c9d1a9c656b0ca0990e3f6abc781␟3710224524048896631:007 Value`,u=$localize`:␟06c663bf1474713f57551123a46b34318543b67d␟7808756054397155068:Reset`,h=$localize`:␟99ee4faa69cd2ea8e3678c1f557c0ff1f05aae46␟8700121026680200191:Clear`,g=$localize`:␟b72b88cee1f6ac7f859b7f326dff5da0f70eb7d0␟6135366680030950269:<Unset>`,p=$localize`:␟680d5c75b7fd8d37961083608b9fcdc4167b4c43␟4452427314943113135:Previous`,m=$localize`:␟f732c304c7433e5a83ffcd862c3dce709a0f4982␟3885497195825665706:Next`,x=$localize`:␟c2d0ac9f528bbd5f53fd34269fde8b59e029621b␟4391289919356861627:Apply`,R=$localize`:␟d7b35c384aecd25a516200d6921836374613dfe7␟2159130950882492111:Cancel`,v=$localize`:␟8671d612d2c9aa8ffc6cdfcd8f566fd42ecd7ba4␟2499713841893974782:Category of Material`,y=$localize`:␟ae3d27c61404272b0126f6d4d4ef8aa71d4c3d55␟2947886859813623889:${"\ufffd0\ufffd"}:INTERPOLATION:: ${"\ufffd1\ufffd"}:INTERPOLATION_1:`;let k=(()=>{class e extends n.a{constructor(e,t,i){super(e),this.modal=e,this.idl=t,this.pcrud=i,this.fieldData="",this.selectorLabel=null,this.selectorOptions=[],this.typeMap=[],this.sfMap={},this.valueMap={},this.step=0,this.slotOffset=0,this.slotSize=1}ngOnInit(){this.onOpen$.subscribe(e=>{this.initialValue=this.fieldData,this.reset()})}splitFieldData(){const e=this.fieldData;return[e.substring(0,this.slotOffset),e.substring(this.slotOffset,this.slotOffset+this.slotSize),e.substring(this.slotOffset+this.slotSize)]}setValuesForStep(){let e;return e=0===this.step?this.getPhysCharTypeMap():this.currentSubfield().then(e=>this.getPhysCharValueMap(e.id())),e.then(e=>{this.selectorOptions=e,this.setSelectedOptionFromField(),this.setLabelForStep()})}setLabelForStep(){0===this.step?this.selectorLabel=null:this.currentSubfield().then(e=>this.selectorLabel=e.label())}getStepSlot(){return 0===this.step?Promise.resolve([0,1]):this.currentSubfield().then(e=>[e.start_pos(),e.length()])}setSelectedOptionFromField(){this.getStepSlot().then(e=>{this.slotOffset=e[0],this.slotSize=e[1],this.selectorValue=String.prototype.substr.apply(this.fieldData,e)||" "})}isLastStep(){return this.currentPtype&&this.sfMap[this.currentPtype]&&this.sfMap[this.currentPtype].length===this.step}selectorChanged(){0===this.step?(this.currentPtype=this.selectorValue,this.fieldData=this.selectorValue):this.getStepSlot().then(e=>{let t=this.fieldData;const i=e[0],c=e[1];for(;t.length<i+c;)t+=" ";const o=t.substr(0,i);this.fieldData=o+this.selectorValue.padEnd(c," "),this.slotOffset=i,this.slotSize=c})}next(){this.step++,this.setValuesForStep()}prev(){this.step--,this.setValuesForStep()}currentSubfield(){return this.getPhysCharSubfieldMap(this.currentPtype).then(e=>e[this.step-1])}reset(e){this.step=0,this.slotOffset=0,this.slotSize=1,this.fieldData=e?" ":this.initialValue,this.currentPtype=this.fieldData.substr(0,1),this.setValuesForStep()}getPhysCharTypeMap(){return this.typeMap.length?Promise.resolve(this.typeMap):this.pcrud.retrieveAll("cmpctm",{order_by:{cmpctm:"label"}},{atomic:!0}).toPromise().then(e=>this.typeMap=e.map(e=>({id:e.ptype_key(),label:e.label()})))}getPhysCharSubfieldMap(e){return this.sfMap[e]?Promise.resolve(this.sfMap[e]):this.pcrud.search("cmpcsm",{ptype_key:e},{order_by:{cmpcsm:["start_pos"]}},{atomic:!0}).toPromise().then(t=>this.sfMap[e]=t)}getPhysCharValueMap(e){return this.valueMap[e]?Promise.resolve(this.valueMap[e]):this.pcrud.search("cmpcvm",{ptype_subfield:e},{order_by:{cmpcsm:["value"]}},{atomic:!0}).toPromise().then(t=>this.valueMap[e]=t.map(e=>({id:e.value(),label:e.label()})))}}return e.\u0275fac=function(t){return new(t||e)(a.Lb(r.s),a.Lb(o.a),a.Lb(s.a))},e.\u0275cmp=a.Fb({type:e,selectors:[["eg-phys-char-dialog"]],inputs:{fieldData:"fieldData"},features:[a.ub],decls:2,vars:0,consts:[["dialogContent",""],[1,"modal-header","bg-info"],[1,"modal-title"],["type","button",1,"close",3,"click",6,"aria-label"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row"],["for","007-value",1,"col-lg-4","col-form-label"],[1,"col-lg-5","well-table"],[1,"well-value"],[1,"pb-0","mb-0","pt-1"],[1,"text-danger"],[1,"col-lg-3","d-flex"],[1,"btn","btn-outline-dark","m-1","p-1","flex-1",3,"click"],["for","value-selector",1,"col-lg-4","col-form-label"],[4,"ngIf"],[1,"col-lg-5"],["id","value-selector",1,"form-control",3,"ngModel","ngModelChange","change"],["value"," "],[3,"ngValue",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-dark","flex-1","m-1","p-1",3,"disabled","click"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],[3,"ngValue"]],template:function(e,t){1&e&&a.Kc(0,T,42,9,"ng-template",null,0,a.Lc)},directives:[d.v,l.F,l.t,l.w,l.y,l.I,d.u],encapsulation:2}),e})()}}]);